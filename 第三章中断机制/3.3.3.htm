<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:st1="urn:schemas-microsoft-com:office:smarttags"
xmlns="http://www.w3.org/TR/REC-html40">


<!-- Mirrored from www.kerneltravel.net/kernel-book/ç¬¬ä¸‰ç« ä¸­æ–­æœºåˆ¶/3.3.3.htm by HTTrack Website Copier/3.x [XR&CO'2008], Sat, 29 Dec 2012 03:00:06 GMT -->
<head>
<meta http-equiv=Content-Type content="text/html; charset=gb2312">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 11">
<meta name=Originator content="Microsoft Word 11">
<link rel=File-List href="3.3.3.files/filelist.xml">
<link rel=Edit-Time-Data href="3.3.3.files/editdata.html">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<title>ÖĞ¶ÏÇëÇó¶ÓÁĞµÄÊı¾İ½á¹¹</title>
<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="chsdate" downloadurl=""/>
<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="chmetcnv" downloadurl=""/>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>CLJ</o:Author>
  <o:Template>Normal</o:Template>
  <o:LastAuthor>CLJ</o:LastAuthor>
  <o:Revision>2</o:Revision>
  <o:TotalTime>0</o:TotalTime>
  <o:Created>2007-08-14T09:35:00Z</o:Created>
  <o:LastSaved>2007-08-14T09:35:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>1484</o:Words>
  <o:Characters>8465</o:Characters>
  <o:Lines>70</o:Lines>
  <o:Paragraphs>19</o:Paragraphs>
  <o:CharactersWithSpaces>9930</o:CharactersWithSpaces>
  <o:Version>11.5606</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:GrammarState>Clean</w:GrammarState>
  <w:PunctuationKerning/>
  <w:DrawingGridVerticalSpacing>7.8 °õ</w:DrawingGridVerticalSpacing>
  <w:DisplayHorizontalDrawingGridEvery>0</w:DisplayHorizontalDrawingGridEvery>
  <w:DisplayVerticalDrawingGridEvery>2</w:DisplayVerticalDrawingGridEvery>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:Compatibility>
   <w:SpaceForUL/>
   <w:BalanceSingleByteDoubleByteWidth/>
   <w:DoNotLeaveBackslashAlone/>
   <w:ULTrailSpace/>
   <w:DoNotExpandShiftReturn/>
   <w:AdjustLineHeightInTable/>
   <w:BreakWrappedTables/>
   <w:SnapToGridInCell/>
   <w:WrapTextWithPunct/>
   <w:UseAsianBreakRules/>
   <w:DontGrowAutofit/>
   <w:UseFELayout/>
  </w:Compatibility>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" LatentStyleCount="156">
 </w:LatentStyles>
</xml><![endif]--><!--[if !mso]><object
 classid="clsid:38481807-CA0E-42D2-BF39-B33AF135CC4D" id=ieooui></object>
<style>
st1\:*{behavior:url(#ieooui) }
</style>
<![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:ËÎÌå;
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-alt:SimSun;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 135135232 16 0 262145 0;}
@font-face
	{font-family:"\@ËÎÌå";
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 135135232 16 0 262145 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	mso-pagination:none;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:ËÎÌå;
	mso-font-kerning:5.0pt;}
p.MsoPlainText, li.MsoPlainText, div.MsoPlainText
	{margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	mso-pagination:none;
	font-size:10.5pt;
	mso-bidi-font-size:10.0pt;
	font-family:ËÎÌå;
	mso-hansi-font-family:"Courier New";
	mso-bidi-font-family:"Times New Roman";
	color:black;
	mso-font-kerning:1.0pt;}
span.GramE
	{mso-style-name:"";
	mso-gram-e:yes;}
 /* Page Definitions */
 @page
	{mso-page-border-surround-header:no;
	mso-page-border-surround-footer:no;}
@page Section1
	{size:595.3pt 841.9pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;
	mso-header-margin:42.55pt;
	mso-footer-margin:49.6pt;
	mso-paper-source:0;
	layout-grid:15.6pt;}
div.Section1
	{page:Section1;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:ÆÕÍ¨±í¸ñ;
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
	mso-para-margin:0cm;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-ansi-language:#0400;
	mso-fareast-language:#0400;
	mso-bidi-language:#0400;}
</style>
<![endif]--><!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="2050"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body lang=ZH-CN style='tab-interval:21.0pt;text-justify-trim:punctuation'>

<div class=Section1 style='layout-grid:15.6pt'>

<p class=MsoNormal style='mso-outline-level:1'><st1:chsdate Year="1899"
Month="12" Day="30" IsLunarDate="False" IsROCDate="False" w:st="on"><span
 lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>3.3.3</span></st1:chsdate><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>ÖĞ¶ÏÇëÇó¶ÓÁĞµÄÊı¾İ½á¹¹</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.25pt'><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;</span></span><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>ÈçÇ°ËùÊö£¬ÔÚ</span><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>256</span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>¸öÖĞ¶ÏÏòÁ¿ÖĞ£¬³ıÁË</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>32</span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>¸ö·ÖÅä¸øÒì³£Íâ£¬»¹ÓĞ</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>224</span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>¸ö×÷ÎªÖĞ¶ÏÏòÁ¿¡£¶ÔÓÚÃ¿¸ö</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>IRQ</span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>£¬</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>Linux</span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>¶¼ÓÃÒ»¸ö</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>irq_desc_t</span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>Êı¾İ½á¹¹À´ÃèÊö£¬ÎÒÃÇ°ÑËü½Ğ×ö</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>IRQ</span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>ÃèÊö·û£¬</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>224</span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>¸ö</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>IRQ</span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>ĞÎ³ÉÒ»¸öÊı×é</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>irq_desc[]</span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>£¬Æä¶¨ÒåÔÚ</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>/include/linux/irq.h</span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>ÖĞ£º</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:
10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-left:21.25pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:10.0pt'><span style='mso-spacerun:yes'>&nbsp;</span>/*<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.25pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:10.0pt'><span style='mso-spacerun:yes'>&nbsp; </span>* This
is the &quot;IRQ descriptor&quot;, which contains <span class=GramE>various
information</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.25pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:10.0pt'><span style='mso-spacerun:yes'>&nbsp; </span>* <span
class=GramE>about</span> the irq, including what kind of hardware handling it
has,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.25pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:10.0pt'><span style='mso-spacerun:yes'>&nbsp; </span>* <span
class=GramE>whether</span> it is disabled etc etc.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.25pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:10.0pt'><span style='mso-spacerun:yes'>&nbsp; </span>*<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.25pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:10.0pt'><span style='mso-spacerun:yes'>&nbsp; </span>* Pad
this out to 32 bytes for cache and indexing reasons.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.25pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:10.0pt'><span style='mso-spacerun:yes'>&nbsp; </span>*/<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.25pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span class=GramE><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>typedef</span></span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'> struct {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.25pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=GramE>unsigned</span> int status;<span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='mso-spacerun:yes'>&nbsp;&nbsp;</span>/* IRQ status */<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.25pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>hw_irq_controller *handler;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.25pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=GramE>struct</span> irqaction *action;<span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='mso-spacerun:yes'>&nbsp;</span>/* IRQ action list */<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.25pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=GramE>unsigned</span> int depth;<span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>/* nested irq disables */<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.25pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=GramE>spinlock_t</span> lock;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.25pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:10.0pt'>} ____cacheline_aligned irq_desc_t;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.25pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-left:21.25pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=PT-BR style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;mso-ansi-language:PT-BR'>extern irq_desc_t irq_desc
[NR_IRQS];<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.25pt'><span lang=PT-BR
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;mso-ansi-language:PT-BR'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:21.25pt'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>±àÂë×÷Õß¶ÔÕâ¸öÊı¾İ½á¹¹¸ø³öÁËÒ»¶¨µÄ½âÊÍ£¬¡°</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>____cacheline_aligned</span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>¡±±íÊ¾Õâ¸öÊı¾İ½á¹¹µÄ´æ·Å°´</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>32</span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>×Ö½Ú£¨¸ßËÙ»º´æĞĞµÄ´óĞ¡£©½øĞĞ¶ÔÆë£¬ÒÔ±ãÓÚ½«À´´æ·ÅÔÚ¸ßËÙ»º´æ²¢ÈİÒ×´æÈ¡¡£ÏÂÃæ¶ÔÕâ¸öÊı¾İ½á¹¹µÄ¸÷¸ö<span
class=GramE>Óò¸øÓè</span>ÃèÊö£º</span><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.25pt'><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span class=GramE><span lang=EN-US>status</span></span></p>

<p class=MsoPlainText style='text-indent:21.25pt'>ÃèÊö<span lang=EN-US>IRQ</span>ÖĞ¶ÏÏß×´Ì¬µÄÒ»×é±êÖ¾£¨ÔÚ<span
lang=EN-US>irq.h</span>ÖĞ¶¨Òå£©<span lang=EN-US>,</span>Æä¾ßÌåº¬Òå¼°Ó¦ÓÃ½«ÔÚ<span lang=EN-US>do_IRQ()</span>º¯ÊıÖĞ½éÉÜ£º</p>

<p class=MsoPlainText><span class=GramE><span lang=EN-US>handler</span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span></span>Ö¸Ïò<span
lang=EN-US>hw_interrupt_type</span>ÃèÊö·û£¬Õâ¸öÃèÊö·ûÊÇ¶ÔÖĞ¶Ï¿ØÖÆÆ÷µÄÃèÊö£¬ÏÂÃæ»á¸ø³ö¾ßÌå½âÊÍ¡£</p>

<p class=MsoPlainText><span class=GramE><span lang=EN-US>action</span></span></p>

<p class=MsoPlainText style='margin-left:21.0pt'>Ö¸ÏòÒ»¸öµ¥ÏòÁ´±íµÄÖ¸Õë£¬Õâ¸öÁ´±í¾ÍÊÇ¶ÔÖĞ¶Ï·şÎñÀı³Ì½øĞĞÃèÊöµÄ<span
lang=EN-US>irqaction</span>½á¹¹£¬ºóÃæ½«¸øÓè¾ßÌåÃèÊö¡£</p>

<p class=MsoPlainText><span class=GramE><span lang=EN-US>depth</span></span></p>

<p class=MsoPlainText style='margin-left:21.0pt'>Èç¹ûÆôÓÃÕâÌõ<span lang=EN-US>IRQ</span>ÖĞ¶ÏÏß£¬<span
lang=EN-US>depth</span>ÔòÎª<span lang=EN-US>0</span>£¬Èç¹û½ûÓÃÕâÌõ<span lang=EN-US>IRQ</span>ÖĞ¶ÏÏß²»Ö¹Ò»´Î£¬ÔòÎªÒ»¸öÕıÊı¡£Ã¿µ±µ÷ÓÃÒ»´Î<span
lang=EN-US>disable_irq(<span style='mso-spacerun:yes'>&nbsp; </span>)</span>£¬¸Ãº¯Êı¾Í¶ÔÕâ¸öÓòµÄÖµ¼Ó<span
lang=EN-US>1</span>£»Èç¹û<span lang=EN-US>depth</span>µÈÓÚ<span lang=EN-US>0</span>£¬¸Ãº¯Êı¾Í½ûÓÃÕâÌõ<span
lang=EN-US>IRQ</span>ÖĞ¶ÏÏß¡£Ïà·´£¬Ã¿µ±µ÷ÓÃ<span lang=EN-US>enable_irq(<span
style='mso-spacerun:yes'>&nbsp; </span>)</span>º¯ÊıÊ±£¬¸Ãº¯Êı¾Í¶ÔÕâ¸ö<span class=GramE>ÓòµÄÖµ¼õ</span><span
lang=EN-US>1</span>£»Èç¹û<span lang=EN-US>depth</span>±äÎª<span lang=EN-US>0</span>£¬¸Ãº¯Êı¾ÍÆôÓÃÕâÌõ<span
lang=EN-US>IRQ</span>ÖĞ¶ÏÏß¡£</p>

<p class=MsoPlainText style='margin-left:21.0pt'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText style='mso-outline-level:1'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US>1</span>£®<span lang=EN-US>IRQ</span>ÃèÊö·ûµÄ³õÊ¼»¯<span
lang=EN-US><o:p></o:p></span></b></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span></span>ÔÚÏµÍ³³õÊ¼»¯ÆÚ¼ä£¬<span
lang=EN-US>init_ISA_irqs()</span>º¯Êı¶Ô<span lang=EN-US>IRQ</span>Êı¾İ½á¹¹£¨»ò½ĞÃèÊö·û£©µÄÓò½øĞĞ³õÊ¼»¯<span
lang=EN-US>(</span>²Î¼û<span lang=EN-US>i8258.c)</span>£º</p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText style='text-indent:21.6pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US><span style='mso-tab-count:
1'>&nbsp;&nbsp;&nbsp; </span><span class=GramE>for</span> (i = 0; i &lt;
NR_IRQS; i++) {</span></p>

<p class=MsoPlainText style='text-indent:21.6pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>irq_desc[i].status = IRQ_DISABLED;</span></p>

<p class=MsoPlainText style='text-indent:21.6pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>irq_desc[i].action = 0;</span></p>

<p class=MsoPlainText style='text-indent:21.6pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>irq_desc[i].depth = 1;</span></p>

<p class=MsoPlainText style='text-indent:21.6pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText style='text-indent:21.6pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=GramE>if</span> (i &lt; 16) {</span></p>

<p class=MsoPlainText style='text-indent:21.6pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>/*</span></p>

<p class=MsoPlainText style='text-indent:21.6pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>* 16 old-style INTA-cycle interrupts:</span></p>

<p class=MsoPlainText style='text-indent:21.6pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>*/</span></p>

<p class=MsoPlainText style='text-indent:21.6pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>irq_desc[i].handler = &amp;i<st1:chmetcnv UnitName="a" SourceValue="8259"
HasSpace="False" Negative="False" NumberType="1" TCSC="0" w:st="on">8259A</st1:chmetcnv>_irq_type;</span></p>

<p class=MsoPlainText style='text-indent:21.6pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>} else {</span></p>

<p class=MsoPlainText style='text-indent:21.6pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>/*</span></p>

<p class=MsoPlainText style='text-indent:21.6pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>*
'high' PCI IRQs filled in on demand</span></p>

<p class=MsoPlainText style='text-indent:21.6pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>*/</span></p>

<p class=MsoPlainText style='text-indent:21.6pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>irq_desc[i].handler = &amp;no_irq_type;</span></p>

<p class=MsoPlainText style='text-indent:21.6pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>}</span></p>

<p class=MsoPlainText style='text-indent:21.6pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>

<p class=MsoPlainText style='text-indent:21.6pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;</span></span></p>

<p class=MsoPlainText style='text-indent:21.6pt'>´ÓÕâ¶Î³ÌĞò¿ÉÒÔ¿´³ö£¬³õÊ¼»¯Ê±£¬ÈÃËùÓĞµÄÖĞ¶ÏÏß¶¼´¦ÓÚ½ûÓÃ×´Ì¬£»Ã¿ÌõÖĞ¶ÏÏßÉÏ»¹Ã»ÓĞÈÎºÎÖĞ¶Ï·şÎñÀı³Ì<span
lang=EN-US>(action</span>Îª<span lang=EN-US>0</span>£©£»ÒòÎªÖĞ¶ÏÏß±»½ûÓÃ£¬Òò´Ë<span
lang=EN-US>depth</span>Îª<span lang=EN-US>1</span>£»¶ÔÖĞ¶Ï¿ØÖÆÆ÷µÄÃèÊö·ÖÎªÁ½ÖÖÇé¿ö£¬Ò»ÖÖ¾ÍÊÇÍ¨³£ËùËµµÄ<st1:chmetcnv
UnitName="a" SourceValue="8259" HasSpace="False" Negative="False" NumberType="1"
TCSC="0" w:st="on"><span lang=EN-US>8259A</span></st1:chmetcnv>£¬ÁíÒ»ÖÖÊÇÆäËü¿ØÖÆÆ÷¡£</p>

<p class=MsoPlainText style='text-indent:21.6pt'>È»ºó£¬¸üĞÂÖĞ¶ÏÃèÊö·û±í<span lang=EN-US>IDT</span>£¬Èç<st1:chsdate
Year="1899" Month="12" Day="30" IsLunarDate="False" IsROCDate="False" w:st="on"><span
 lang=EN-US>3.2.3</span></st1:chsdate>½ÚËùÊö£¬ÓÃ×îÖÕµÄÖĞ¶ÏÃÅÀ´´úÌæÁÙÊ±Ê¹ÓÃµÄÖĞ¶ÏÃÅ¡£</p>

<p class=MsoPlainText style='text-indent:21.6pt'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText style='mso-outline-level:1'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US>2</span>£®ÖĞ¶Ï¿ØÖÆÆ÷ÃèÊö·û<span lang=EN-US>hw_interrupt_type<span
style='mso-tab-count:1'>&nbsp;&nbsp; </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText style='text-indent:21.25pt'>Õâ¸öÃèÊö·û°üº¬Ò»×éÖ¸Õë£¬Ö¸ÏòÓëÌØ¶¨ÖĞ¶Ï¿ØÖÆÆ÷µçÂ·£¨<span
lang=EN-US>PIC</span>£©´ò½»µÀµÄµÍ¼¶<span lang=EN-US>I/O</span>Àı³Ì£¬¶¨ÒåÈçÏÂ£º</p>

<p class=MsoPlainText style='text-indent:21.25pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US>/*</span></p>

<p class=MsoPlainText style='text-indent:21.25pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US>* Interrupt controller
descriptor. This is all we need</span></p>

<p class=MsoPlainText style='text-indent:21.25pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US>* <span class=GramE>to</span>
describe about the low-level hardware. </span></p>

<p class=MsoPlainText style='text-indent:21.25pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US>*/</span></p>

<p class=MsoPlainText style='text-indent:21.25pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span class=GramE><span lang=EN-US>struct</span></span><span
lang=EN-US> hw_interrupt_type {</span></p>

<p class=MsoPlainText style='text-indent:21.25pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>const</span> char * typename;</span></p>

<p class=MsoPlainText style='text-indent:21.25pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>unsigned</span> int (*startup)(unsigned int irq);</span></p>

<p class=MsoPlainText style='text-indent:21.25pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>void</span> (*shutdown)(unsigned int irq);</span></p>

<p class=MsoPlainText style='text-indent:21.25pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>void</span> (*enable)(unsigned int irq);</span></p>

<p class=MsoPlainText style='text-indent:21.25pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>void</span> (*disable)(unsigned int irq);</span></p>

<p class=MsoPlainText style='text-indent:21.25pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>void</span> (*ack)(unsigned int irq);</span></p>

<p class=MsoPlainText style='text-indent:21.25pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>void</span> (*end)(unsigned int irq);</span></p>

<p class=MsoPlainText style='text-indent:21.25pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>void</span> (*set_affinity)(unsigned int irq, unsigned long mask);</span></p>

<p class=MsoPlainText style='text-indent:21.25pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US>};</span></p>

<p class=MsoPlainText style='text-indent:21.25pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText style='text-indent:21.25pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span class=GramE><span lang=EN-US>typedef</span></span><span
lang=EN-US> struct hw_interrupt_type<span style='mso-spacerun:yes'>&nbsp;
</span>hw_irq_controller;</span></p>

<p class=MsoPlainText style='text-indent:21.25pt'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText style='text-indent:21.25pt'><span lang=EN-US>Linux</span>³ıÁËÖ§³Ö±¾ÕÂÇ°ÃæÒÑÌáµ½µÄ<st1:chmetcnv
UnitName="a" SourceValue="8259" HasSpace="False" Negative="False" NumberType="1"
TCSC="0" w:st="on"><span lang=EN-US>8259A</span></st1:chmetcnv>Ğ¾Æ¬Íâ£¬Ò²Ö§³ÖÆäËûµÄ<span
lang=EN-US>PIC</span>µçÂ·£¬Èç<span lang=EN-US>SMP IO-APIC</span>¡¢<span lang=EN-US>PIIX4</span>µÄÄÚ²¿<span
lang=EN-US> 8259 PIC</span>¼°<span lang=EN-US> SGI</span>µÄ<span lang=EN-US>Visual
Workstation Cobalt (IO-)APIC</span>¡£µ«ÊÇ£¬ÎªÁË¼òµ¥Æğ¼û£¬ÎÒÃÇÔÚ±¾ÕÂ¼Ù¶¨£¬ÎÒÃÇµÄ¼ÆËã»úÊÇÓĞÁ½Æ¬<st1:chmetcnv
UnitName="a" SourceValue="8259" HasSpace="False" Negative="False" NumberType="1"
TCSC="0" w:st="on"><span lang=EN-US>8259A</span></st1:chmetcnv><span
lang=EN-US> PIC</span>µÄµ¥´¦Àí»ú£¬ËüÌá¹©<span lang=EN-US>16</span>¸ö±ê×¼µÄ<span lang=EN-US>IRQ</span>¡£ÔÚÕâÖÖÇé¿öÏÂ£¬ÓĞ<span
lang=EN-US>16</span>¸ö<span lang=EN-US>irq_desc_t</span>ÃèÊö·û£¬ÆäÖĞÃ¿¸öÃèÊö·ûµÄ<span
lang=EN-US>handler</span>ÓòÖ¸Ïò<st1:chmetcnv UnitName="a" SourceValue="8259"
HasSpace="False" Negative="False" NumberType="1" TCSC="0" w:st="on"><span
 lang=EN-US>8259A</span></st1:chmetcnv><span lang=EN-US>_irq _type</span>±äÁ¿¡£¶ÔÆä½øĞĞÈçÏÂµÄ³õÊ¼»¯£º</p>

<p class=MsoPlainText style='text-indent:21.25pt'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText style='text-indent:21.25pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span class=GramE><span lang=EN-US>struct</span></span><span
lang=EN-US> hw_interrupt_type i<st1:chmetcnv UnitName="a" SourceValue="8259"
HasSpace="False" Negative="False" NumberType="1" TCSC="0" w:st="on">8259A</st1:chmetcnv>_irq_type
= { </span></p>

<p class=MsoPlainText style='mso-outline-level:1;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span style='mso-tab-count:
2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&quot;XT-PIC&quot;, </span></p>

<p class=MsoPlainText style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;
</span><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp; </span>startup_<st1:chmetcnv
UnitName="a" SourceValue="8259" HasSpace="False" Negative="False" NumberType="1"
TCSC="0" w:st="on">8259A</st1:chmetcnv>_irq, </span></p>

<p class=MsoPlainText style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span style='mso-tab-count:
2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>shutdown_<st1:chmetcnv
UnitName="a" SourceValue="8259" HasSpace="False" Negative="False" NumberType="1"
TCSC="0" w:st="on">8259A</st1:chmetcnv>_irq, </span></p>

<p class=MsoPlainText style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span style='mso-tab-count:
2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang=PT-BR
style='mso-ansi-language:PT-BR'>do_<st1:chmetcnv UnitName="a" SourceValue="8259"
HasSpace="False" Negative="False" NumberType="1" TCSC="0" w:st="on">8259A</st1:chmetcnv>_IRQ,
<o:p></o:p></span></p>

<p class=MsoPlainText style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=PT-BR style='mso-ansi-language:PT-BR'><span
style='mso-spacerun:yes'>&nbsp;&nbsp; </span><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp; </span>enable_<st1:chmetcnv
UnitName="a" SourceValue="8259" HasSpace="False" Negative="False" NumberType="1"
TCSC="0" w:st="on">8259A</st1:chmetcnv>_irq, <o:p></o:p></span></p>

<p class=MsoPlainText style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=PT-BR style='mso-ansi-language:PT-BR'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span style='mso-tab-count:
2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>disable_<st1:chmetcnv
UnitName="a" SourceValue="8259" HasSpace="False" Negative="False" NumberType="1"
TCSC="0" w:st="on">8259A</st1:chmetcnv>_irq <o:p></o:p></span></p>

<p class=MsoPlainText style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=PT-BR style='mso-ansi-language:PT-BR'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>}; <o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:21.25pt'><span lang=PT-BR
style='mso-ansi-language:PT-BR'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=PT-BR style='mso-ansi-language:PT-BR'><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span></span>ÔÚÕâ¸ö½á¹¹ÖĞµÄµÚÒ»¸öÓò<span
style='mso-ansi-language:PT-BR'>¡°<span lang=PT-BR>XT-PIC</span>¡±</span>ÊÇÒ»¸öÃû×Ö¡£½ÓÏÂÀ´<span
style='mso-ansi-language:PT-BR'>£¬<st1:chmetcnv UnitName="a" SourceValue="8259"
HasSpace="False" Negative="False" NumberType="1" TCSC="0" w:st="on"><span
 lang=PT-BR>8259A</span></st1:chmetcnv><span lang=PT-BR>_irq_type</span></span>°üº¬µÄÖ¸ÕëÖ¸ÏòÎå¸ö²»Í¬µÄº¯Êı<span
style='mso-ansi-language:PT-BR'>£¬</span>ÕâĞ©º¯Êı¾ÍÊÇ¶Ô<span lang=PT-BR
style='mso-ansi-language:PT-BR'>PIC</span>±à³ÌµÄº¯Êı¡£Ç°Á½¸öº¯Êı·Ö±ğÆô¶¯ºÍ¹Ø±ÕÕâ¸öĞ¾Æ¬µÄÖĞ¶ÏÏß¡£µ«ÊÇ£¬ÔÚÊ¹ÓÃ<st1:chmetcnv
UnitName="a" SourceValue="8259" HasSpace="False" Negative="False" NumberType="1"
TCSC="0" w:st="on"><span lang=EN-US>8259A</span></st1:chmetcnv>Ğ¾Æ¬µÄÇé¿öÏÂ£¬ÕâÁ½¸öº¯ÊıµÄ×÷ÓÃÓëºóÁ½¸öº¯ÊıÊÇÒ»ÑùµÄ£¬ºóÁ½¸öº¯ÊıÊÇÆôÓÃºÍ½ûÓÃÖĞ¶ÏÏß¡£ºóÃæÔÚ¶Ô<span
lang=EN-US>do_IRQ</span>ÃèÊöÊ±¾ßÌåÃèÊö<span lang=EN-US>do_<st1:chmetcnv UnitName="a"
SourceValue="8259" HasSpace="False" Negative="False" NumberType="1" TCSC="0"
w:st="on">8259A</st1:chmetcnv>_IRQ(<span style='mso-spacerun:yes'>&nbsp;
</span>)</span>º¯Êı¡£</p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText style='mso-outline-level:1'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US>3</span>£®ÖĞ¶Ï·şÎñÀı³ÌÃèÊö·û<span lang=EN-US>irqaction<o:p></o:p></span></b></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span></span>ÔÚ<span
lang=EN-US>IRQ</span>ÃèÊö·ûÖĞÎÒÃÇ¿´µ½Ö¸Õë<span lang=EN-US>action</span>µÄ½á¹¹Îª<span
lang=EN-US>irqaction</span>£¬ËüÊÇÎª¶à¸öÉè±¸ÄÜ¹²ÏíÒ»ÌõÖĞ¶ÏÏß¶øÉèÖÃµÄÒ»¸öÊı¾İ½á¹¹¡£ÔÚ<span lang=EN-US>include/linux/interrupt.h</span>ÖĞ¶¨ÒåÈçÏÂ<span
lang=EN-US>:</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-spacerun:yes'>&nbsp;</span><span class=GramE>struct</span> irqaction
{</span></p>

<p class=MsoPlainText style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>void</span> (*handler)(int, void *, struct pt_regs *);</span></p>

<p class=MsoPlainText style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=GramE>unsigned</span> long flags;</span></p>

<p class=MsoPlainText style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>unsigned</span> long mask;</span></p>

<p class=MsoPlainText style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>const</span> char *name;</span></p>

<p class=MsoPlainText style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>void</span> *dev_id;</span></p>

<p class=MsoPlainText style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>struct</span> irqaction *next;</span></p>

<p class=MsoPlainText style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp; </span>};</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText>Õâ¸öÃèÊö·û°üº¬ÏÂÁĞÓò¡£</p>

<p class=MsoPlainText><span class=GramE><span lang=EN-US>handler</span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span></span>Ö¸ÏòÒ»¸ö¾ßÌå<span
lang=EN-US>I/O</span>Éè±¸µÄÖĞ¶Ï·şÎñÀı³Ì¡£ÕâÊÇÔÊĞí¶à¸öÉè±¸¹²ÏíÍ¬Ò»ÖĞ¶ÏÏßµÄ¹Ø¼üÓò¡£</p>

<p class=MsoPlainText><span class=GramE><span lang=EN-US>flags</span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span></span>ÓÃÒ»×é±êÖ¾ÃèÊöÖĞ¶ÏÏßÓë<span
lang=EN-US>I/O</span>Éè±¸Ö®¼äµÄ¹ØÏµ¡£</p>

<p class=MsoPlainText style='text-indent:21.25pt;mso-outline-level:1'><span
lang=EN-US>SA_INTERRUPT </span></p>

<p class=MsoPlainText style='margin-left:21.25pt;text-indent:21.25pt;
mso-outline-level:1'>ÖĞ¶Ï´¦Àí³ÌĞò±ØĞëÒÔ½ûÓÃÖĞ¶ÏÀ´Ö´ĞĞ</p>

<p class=MsoPlainText style='text-indent:21.25pt;mso-outline-level:1'><span
lang=EN-US>SA_SHIRQ </span></p>

<p class=MsoPlainText style='margin-left:21.25pt;text-indent:21.25pt'>¸ÃÉè±¸ÔÊĞíÆäÖĞ¶ÏÏßÓëÆäËûÉè±¸¹²Ïí¡£</p>

<p class=MsoPlainText style='text-indent:21.25pt;mso-outline-level:1'><span
lang=EN-US>SA_SAMPLE_RANDOM </span></p>

<p class=MsoPlainText style='margin-left:42.5pt;text-indent:.35pt'>¿ÉÒÔ°ÑÕâ¸öÉè±¸¿´×÷ÊÇËæ»úÊÂ¼ş·¢ÉúÔ´£»Òò´Ë£¬ÄÚºË¿ÉÒÔÓÃËü×öËæ»úÊı²úÉúÆ÷¡££¨ÓÃ»§¿ÉÒÔ´Ó<span
lang=EN-US>/dev/random </span>ºÍ<span lang=EN-US>/dev/urandom</span>Éè±¸ÎÄ¼şÖĞÈ¡µÃËæ»úÊı¶ø·ÃÎÊÕâÖÖÌØÕ÷£©</p>

<p class=MsoPlainText style='text-indent:21.25pt;mso-outline-level:1'><span
lang=EN-US>SA_PROBE </span></p>

<p class=MsoPlainText style='margin-left:21.25pt;text-indent:21.25pt'>ÄÚºËÔÚÖ´ĞĞÓ²¼şÉè±¸Ì½²âÊ±ÕıÔÚÊ¹ÓÃÕâÌõÖĞ¶ÏÏß¡£</p>

<p class=MsoPlainText><span class=GramE><span lang=EN-US>name</span></span></p>

<p class=MsoPlainText style='margin-left:21.0pt'><span lang=EN-US>I/O</span>Éè±¸Ãû£¨Í¨¹ı¶ÁÈ¡<span
lang=EN-US>/proc/interrupts</span>ÎÄ¼ş£¬¿ÉÒÔ¿´µ½<span lang=EN-US>,</span>ÔÚÁĞ³öÖĞ¶ÏºÅÊ±Ò²ÏÔÊ¾Éè±¸Ãû¡££©</p>

<p class=MsoPlainText><span lang=EN-US>dev_id</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span></span>Ö¸¶¨<span
lang=EN-US>I/O</span>Éè±¸µÄÖ÷Éè±¸ºÅºÍ<span class=GramE>´ÎÉè±¸ºÅ</span>¡£</p>

<p class=MsoPlainText><span class=GramE><span lang=EN-US>next</span></span></p>

<p class=MsoPlainText style='margin-left:21.0pt'>Ö¸Ïò<span lang=EN-US>irqaction</span>ÃèÊö·ûÁ´±íµÄÏÂÒ»¸öÔªËØ¡£¹²ÏíÍ¬Ò»ÖĞ¶ÏÏßµÄÃ¿¸öÓ²¼şÉè±¸¶¼ÓĞÆä¶ÔÓ¦µÄÖĞ¶Ï·şÎñÀı³Ì£¬Á´±íÖĞµÄÃ¿¸öÔªËØ¾ÍÊÇ¶ÔÏàÓ¦Éè±¸¼°ÖĞ¶Ï·şÎñÀı³ÌµÄÃèÊö¡£</p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText style='mso-outline-level:1'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US>4.</span>ÖĞ¶Ï·şÎñÀı³Ì<span lang=EN-US><o:p></o:p></span></b></p>

<p class=MsoNormal style='text-indent:21.25pt'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>ÎÒÃÇÕâÀïÌáµ½µÄÖĞ¶Ï·şÎñÀı³Ì£¨</span><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>Interrupt Service Routine</span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>£©ÓëÒÔÇ°ËùÌáµ½µÄÖĞ¶Ï´¦Àí³ÌĞò</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>(Interrupt
handler)</span><span style='font-size:10.5pt;mso-bidi-font-size:10.0pt;
font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>ÊÇ²»Í¬µÄ¸ÅÄî¡£¾ßÌåÀ´Ëµ£¬ÖĞ¶Ï´¦Àí³ÌĞòÏàµ±ÓÚÄ³¸öÖĞ¶ÏÏòÁ¿µÄ×Ü´¦Àí³ÌĞò£¬ÀıÈç</span><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>IRQ0x05_interrupt()</span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>£¬ÊÇÖĞ¶ÏºÅ</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>5</span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>£¨ÏòÁ¿Îª</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>37</span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>£©µÄ×Ü´¦Àí³ÌĞò£¬Èç¹ûÕâ¸ö</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>5</span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>ºÅÖĞ¶ÏÓÉÍø¿¨ºÍÍ¼ĞÎ¿¨¹²Ïí£¬ÔòÍø¿¨ºÍÍ¼ĞÎ<span
class=GramE>¿¨·Ö±ğ</span>ÓĞÆäÏàÓ¦µÄÖĞ¶Ï·şÎñÀı³Ì¡£Ã¿¸öÖĞ¶Ï·şÎñÀı³Ì¶¼ÓĞÏàÍ¬µÄ²ÎÊı£º</span><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.25pt'><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>IRQ</span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>£ºÖĞ¶ÏºÅ£»</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.25pt'><span lang=EN-US>dev_id: </span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>Éè±¸±êÊ¶·û£¬ÆäÀàĞÍÎª</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>void*</span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>£»</span></p>

<p class=MsoNormal style='margin-left:21.25pt'><span lang=EN-US>regs: </span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>Ö¸ÏòÄÚºË¶ÑÕ»ÇøµÄÖ¸Õë£¬¶ÑÕ»ÖĞ´æ·ÅµÄÊÇÖĞ¶Ï·¢ÉúºóËù±£´æµÄ¼Ä´æÆ÷£¬ÓĞ¹Ø</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>pt_regs</span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>½á¹¹µÄ¾ßÌåÄÚÈİ½«ÔÚºóÃæ½éÉÜ¡£</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:
10.0pt'><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span></span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>ÔÚÊµ¼ÊÖĞ£¬´ó¶àÊıÖĞ¶Ï·şÎñÀı³Ì²¢²»Ê¹ÓÃÕâĞ©²ÎÊı¡£</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.25pt'><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-outline-level:1'><st1:chsdate Year="1899"
Month="12" Day="30" IsLunarDate="False" IsROCDate="False" w:st="on"><b
 style='mso-bidi-font-weight:normal'><span lang=EN-US style='font-size:10.5pt;
 mso-bidi-font-size:10.0pt'>3.3.2</span></b></st1:chsdate><b style='mso-bidi-font-weight:
normal'><span style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:
ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>ÖĞ¶ÏÇëÇó¶ÓÁĞµÄ³õÊ¼»¯</span></b><b
style='mso-bidi-font-weight:normal'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:10.0pt'><o:p></o:p></span></b></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>ÔÚ</span><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>IDT</span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>±í³õÊ¼»¯Íê³ÉÖ®³õ£¬Ã¿¸öÖĞ¶Ï·şÎñ¶ÓÁĞ»¹Îª¿Õ¡£´ËÊ±£¬¼´Ê¹´ò¿ªÖĞ¶ÏÇÒÄ³¸öÍâÉèÖĞ¶ÏÕæµÄ·¢ÉúÁË£¬Ò²µÃ²»µ½Êµ¼ÊµÄ·şÎñ¡£ÒòÎª</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>CPU</span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>ËäÈ»Í¨¹ıÖĞ¶ÏÃÅ½øÈëÁËÄ³¸öÖĞ¶ÏÏòÁ¿µÄ×Ü´¦Àí³ÌĞò£¬ÀıÈç</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>IRQ0x05_interrupt()</span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>£¬µ«ÊÇ£¬¾ßÌåµÄÖĞ¶Ï·şÎñÀı³Ì£¨ÈçÍ¼ĞÎ¿¨µÄ£©»¹Ã»ÓĞ¹ÒÈëÖĞ¶ÏÇëÇó¶ÓÁĞ¡£Òò´Ë£¬ÔÚÉè±¸Çı¶¯³ÌĞòµÄ³õÊ¼»¯½×¶Î£¬±ØĞëÍ¨¹ı</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>request_irq()</span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>º¯Êı½«¶ÔÏàÓ¦µÄÖĞ¶Ï·şÎñÀı³Ì¹ÒÈëÖĞ¶ÏÇëÇó¶ÓÁĞ¡£</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt;color:fuchsia'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>request_irq()</span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>º¯ÊıµÄ´úÂëÔÚ£¯</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>arch/i386/kernel/irq.c</span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>ÖĞ£º</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:
10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp; </span>/*<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-spacerun:yes'>&nbsp;</span>*<span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>request_irq - allocate
an interrupt line<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp; </span>*<span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>@irq: Interrupt
line to allocate<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp; </span>*<span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>@handler:
Function to be called when the IRQ occurs<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp; </span>*<span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>@irqflags:
Interrupt type flags<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp; </span>*<span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>@devname: An <span
class=GramE>ascii</span> name for the claiming device<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp; </span>*<span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>@dev_id: A
cookie passed back to the handler function<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp; </span>*<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp; </span>*<span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>This call
allocates interrupt resources and enables the<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp; </span>*<span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>interrupt line
and IRQ handling. From the point this<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp; </span>*<span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>call</span> is made your handler function may be invoked. Since<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp; </span>*<span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>your</span> handler function must clear any interrupt the board <o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp; </span>*<span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>raises</span>, you must take care both to initialise your hardware<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp; </span>*<span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>and</span> to set up the interrupt handler in the right order.<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp; </span>*<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp; </span>*<span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Dev_id must be
globally unique. Normally the address of the<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp; </span>*<span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span
style='mso-spacerun:yes'>&nbsp;&nbsp;</span><span class=GramE>device</span>
data structure is used as the cookie. Since the handler<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp; </span>*<span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>receives this
value it makes sense to use it.<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp; </span>*<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp; </span>*<span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>If your
interrupt is shared you must pass a non NULL dev_id<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp; </span>*<span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>as</span> this is required when freeing the interrupt.<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp; </span>*<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp; </span>*<span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Flags:<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp; </span>*<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp; </span>*<span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>SA_SHIRQ<span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Interrupt is shared<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp; </span>*<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp; </span>*<span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>SA_INTERRUPT<span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Disable local interrupts while processing<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp; </span>*<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp; </span>*<span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>SA_SAMPLE_RANDOM<span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>The
interrupt can be used for entropy<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp; </span>*<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp; </span>*/<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp; </span><o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;</span><span class=GramE>int</span>
request_irq(unsigned int irq, <o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=GramE>void</span> (*handler)(int, void *, struct pt_regs *),<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=GramE>unsigned</span> long irqflags, <o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=GramE>const</span> char * devname,<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=GramE>void</span> *dev_id)<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;</span>{<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=GramE>int</span> retval;<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=GramE>struct</span> irqaction * action;<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;</span><o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;</span>#if 1<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>/*<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>* Sanity-check: shared interrupts should REALLY pass in<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>* <span class=GramE>a</span> real dev-ID, otherwise we'll have trouble
later trying<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>* <span class=GramE>to</span> figure out which interrupt is which
(messes up the<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>* interrupt freeing logic etc).<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>*/<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=GramE>if</span> (irqflags &amp; SA_SHIRQ) {<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=GramE>if</span> (!dev_id)<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=GramE>printk(</span>&quot;Bad boy: %s (at 0x%x) called us
without a dev_id!\n&quot;, devname, (&amp;irq)[-1]);<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>}<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>#endif<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=GramE>if</span> (irq &gt;= NR_IRQS)<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=GramE>return</span> -EINVAL;<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=GramE>if</span> (!handler)<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=GramE>return</span> -EINVAL;<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>action</span> = (struct irqaction *)<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=GramE>kmalloc(</span>sizeof(struct irqaction), GFP_KERNEL);<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=GramE>if</span> (!action)<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=GramE>return</span> -ENOMEM;<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><!--[if gte vml 1]><v:shapetype id="_x0000_t88" coordsize="21600,21600"
 o:spt="88" adj="1800,10800" path="m,qx10800@0l10800@2qy21600@11,10800@3l10800@1qy,21600e"
 filled="f">
 <v:formulas>
  <v:f eqn="val #0"/>
  <v:f eqn="sum 21600 0 #0"/>
  <v:f eqn="sum #1 0 #0"/>
  <v:f eqn="sum #1 #0 0"/>
  <v:f eqn="prod #0 9598 32768"/>
  <v:f eqn="sum 21600 0 @4"/>
  <v:f eqn="sum 21600 0 #1"/>
  <v:f eqn="min #1 @6"/>
  <v:f eqn="prod @7 1 2"/>
  <v:f eqn="prod #0 2 1"/>
  <v:f eqn="sum 21600 0 @9"/>
  <v:f eqn="val #1"/>
 </v:formulas>
 <v:path arrowok="t" o:connecttype="custom" o:connectlocs="0,0;21600,@11;0,21600"
  textboxrect="0,@4,7637,@5"/>
 <v:handles>
  <v:h position="center,#0" yrange="0,@8"/>
  <v:h position="bottomRight,#1" yrange="@9,@10"/>
 </v:handles>
</v:shapetype><v:shape id="_x0000_s1026" type="#_x0000_t88" style='position:absolute;
 left:0;text-align:left;margin-left:162.75pt;margin-top:7.95pt;width:26.25pt;
 height:85.65pt;z-index:1' o:allowincell="f"/><![endif]--><![if !vml]><span
style='mso-ignore:vglayout;position:absolute;z-index:1;left:0px;margin-left:
216px;margin-top:10px;width:37px;height:116px'><img width=37 height=116
src="3.3.3.files/image001.gif" v:shapes="_x0000_s1026"></span><![endif]><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=GramE>action</span>-&gt;handler = handler;<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=GramE>action</span>-&gt;flags = irqflags;<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=GramE>action</span>-&gt;mask = 0;<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>action-&gt;name = devname;<span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>¶Ô</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>action</span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>½øĞĞ³õÊ¼»¯</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=GramE>action</span>-&gt;next = NULL;<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=GramE>action</span>-&gt;dev_id = dev_id;<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=GramE>retval</span> = setup_irq(irq, action);<span
style='mso-spacerun:yes'>&nbsp; </span><o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=GramE>if</span> (retval)<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=GramE>kfree(</span>action);<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=GramE>return</span> retval;<o:p></o:p></span></p>

<p class=MsoNormal style='background:#BFBFBF;mso-shading:white;mso-pattern:
gray-25 auto'><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>±àÂë×÷Õß¶Ô´Ëº¯Êı¸ø³öÁË±È½ÏÏêÏ¸µÄÃèÊö¡£ÆäÖĞÖ÷ÒªÓï¾ä¾ÍÊÇ¶Ô</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>setup_irq</span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>£¨£©º¯ÊıµÄµ÷ÓÃ£¬¸Ãº¯Êı²ÅÊÇÕæÕı¶ÔÖĞ¶ÏÇëÇó¶ÓÁĞ½øĞĞ³õÊ¼»¯µÄº¯Êı£¨ÓĞËù¼ò»¯£©£º</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span class=GramE><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>int</span></span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>
setup_irq(unsigned int irq, struct irqaction * new)<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:10.0pt'>{<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=GramE>int</span> shared = 0;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=GramE>unsigned</span> long flags;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=GramE>struct</span> irqaction *old, **p;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>irq_desc_t *desc = irq_desc + irq;<span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>£¯£ª»ñµÃ</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>irq</span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>µÄÃèÊö·û£ª£¯</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:10.0pt'><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;
</span><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-outline-level:1;background:
#BFBFBF;mso-shading:white;mso-pattern:gray-25 auto'><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:10.5pt;mso-bidi-font-size:10.0pt;
font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>£¯</span><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:
10.0pt'>* </span><span style='font-size:10.5pt;mso-bidi-font-size:10.0pt;
font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>¶ÔÖĞ¶ÏÇëÇó¶ÓÁĞµÄ²Ù×÷±ØĞëÔÚÁÙ½çÇøÖĞ½øĞĞ</span><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt'> </span><span style='font-size:10.5pt;mso-bidi-font-size:
10.0pt;font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>£ª£¯</span><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>spin_lock_irqsave(&amp;desc-&gt;lock,flags);<span
style='mso-spacerun:yes'>&nbsp;&nbsp; </span></span><span style='font-size:
10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>£¯£ª½øÈëÁÙ½çÇø£ª£¯</span><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>p =
&amp;desc-&gt;action;<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span></span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>£¯£ªÈÃ</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>p </span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>Ö¸Ïò</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>irq</span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>ÃèÊö·ûµÄ</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>action</span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>Óò£¬¼´</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>irqaction</span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>Á´±íµÄÊ×²¿£ª£¯</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>if</span> ((old = *p) != NULL) {<span
style='mso-spacerun:yes'>&nbsp; </span></span><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>£¯£ªÈç¹ûÕâ¸öÁ´±í²»Îª¿Õ£ª£¯</span><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>/* <span class=GramE>Can't</span> share interrupts unless both agree to
*/<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=GramE>if</span> (!(old-&gt;flags &amp; new-&gt;flags &amp;
SA_SHIRQ)) {<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>spin_unlock_<span class=GramE>irqrestore(</span>&amp;desc-&gt;lock,flags);<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=GramE>return</span> -EBUSY;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>/* </span><span style='font-size:10.5pt;mso-bidi-font-size:10.0pt;
font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>°ÑĞÂµÄÖĞ¶Ï·şÎñÀı³Ì¼ÓÈëµ½</span><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:10.0pt'>irq</span><span style='font-size:10.5pt;mso-bidi-font-size:
10.0pt;font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>ÖĞ¶ÏÇëÇó¶ÓÁĞ</span><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:10.0pt'>*/<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=GramE>do</span> {<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:10.0pt'><span style='mso-spacerun:yes'>&nbsp; </span><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>p
= &amp;old-&gt;next;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=GramE>old</span> = *p;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>} while (old);<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=GramE>shared</span> = 1;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>*p =
new;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>if</span> (!shared) {<span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>£¯£ªÈç¹û</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>irq</span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>²»±»¹²Ïí</span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt'> </span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>£ª£¯</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>desc-&gt;depth = 0;<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:10.5pt;mso-bidi-font-size:10.0pt;
font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>£¯£ªÆôÓÃÕâÌõ</span><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:10.0pt'>irq</span><span style='font-size:10.5pt;mso-bidi-font-size:
10.0pt;font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>Ïß£ª£¯</span><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:10.0pt'><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=GramE>desc</span>-&gt;status &amp;= ~(IRQ_DISABLED |
IRQ_AUTODETECT | IRQ_WAITING);<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>desc-&gt;handler-&gt;startup(irq); </span><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>£¯£ª¼´µ÷ÓÃ</span><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>startup_<st1:chmetcnv
UnitName="a" SourceValue="8259" HasSpace="False" Negative="False" NumberType="1"
TCSC="0" w:st="on">8259A</st1:chmetcnv>_irq</span><span style='font-size:10.5pt;
mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>£¨£©º¯Êı£ª£¯</span><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp; </span><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>spin_unlock_irqrestore(&amp;desc-&gt;lock,flags);<span
style='mso-spacerun:yes'>&nbsp;&nbsp; </span></span><span style='font-size:
10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>£¯£ªÍË³öÁÙ½çÇø£ª£¯</span><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>register_irq_proc(irq);<span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>£¯£ªÔÚ</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>proc</span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>ÎÄ¼şÏµÍ³ÖĞÏÔÊ¾</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>irq</span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>µÄĞÅÏ¢£ª£¯</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:10.0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=GramE>return</span> 0;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;background:#BFBFBF;mso-shading:
white;mso-pattern:gray-25 auto'><span lang=EN-US style='font-size:10.5pt;
mso-bidi-font-size:10.0pt'>}<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:10.5pt;mso-bidi-font-size:10.0pt;
font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>ÏÂÃæÎÒÃÇ¾ÙÀıËµÃ÷¶ÔÕâÁ½¸öº¯ÊıµÄÊ¹ÓÃ£º</span><span lang=EN-US style='font-size:
10.5pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-outline-level:1'><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>1</span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>£®¶Ô</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>register_irq</span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>£¨£©º¯ÊıµÄÊ¹ÓÃ£º</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:
10.0pt'><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span></span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>ÔÚÇı¶¯³ÌĞò³õÊ¼»¯»òÕßÔÚÉè±¸µÚÒ»´Î´ò¿ªÊ±£¬Ê×ÏÈÒªµ÷ÓÃ¸Ãº¯Êı£¬ÒÔÉêÇëÊ¹ÓÃ¸Ã</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>irq</span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>¡£ÆäÖĞ²ÎÊı</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>handler</span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>Ö¸µÄÊÇÒª¹ÒÈëµ½ÖĞ¶ÏÇëÇó¶ÓÁĞÖĞµÄÖĞ¶Ï·şÎñÀı³Ì¡£¼Ù¶¨Ò»¸ö³ÌĞòÒª¶Ô£¯</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>dev/fd0/</span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>£¨µÚÒ»¸öÈíÅÌ¶ÔÓ¦µÄÉè±¸£©Éè±¸½øĞĞ·ÃÎÊ£¬ÓĞÁ½ÖÖ·½Ê½£¬Ò»ÊÇÖ±½Ó·ÃÎÊ£¯</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>dev/fd0/</span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>£¬ÁíÒ»ÖÖÊÇÔÚÏµÍ³ÉÏ°²×°Ò»¸öÎÄ¼şÏµÍ³£¬ÎÒÃÇÕâÀï¼Ù¶¨²ÉÓÃµÚÒ»ÖÖ¡£Í¨³£½«</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>IRQ6</span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>·ÖÅä¸øÈíÅÌ¿ØÖÆÆ÷£¬¸ø¶¨Õâ¸öÖĞ¶ÏºÅ</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>6</span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>£¬ÈíÅÌÇı¶¯³ÌĞò¾Í¿ÉÒÔ·¢³öÏÂÁĞÇëÇó£¬ÒÔ½«ÆäÖĞ¶Ï·şÎñÀı³Ì¹ÒÈëÖĞ¶ÏÇëÇó¶ÓÁĞ£º</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span style='mso-tab-count:
2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>request_<span class=GramE>irq(</span>6,
floppy_interrupt, </span></p>

<p class=MsoPlainText><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>SA_INTERRUPT|SA_SAMPLE_RANDOM,
&quot;floppy&quot;, NULL); </span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:
10.0pt'><span style='mso-spacerun:yes'>&nbsp;&nbsp; </span></span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>ÎÒÃÇ¿ÉÒÔ¿´µ½£¬</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>floppy_interrupt</span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>£¨£©ÖĞ¶Ï·şÎñÀı³ÌÔËĞĞÊ±±ØĞë½ûÓÃÖĞ¶Ï£¨ÉèÖÃÁË</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>SA_INTERRUPT</span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>±êÖ¾£©£¬²¢ÇÒ²»ÔÊĞí¹²ÏíÕâ¸ö</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>IRQ</span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>£¨Çå</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>SA_SHIRQ</span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>±êÖ¾</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>£©</span><span style='font-size:10.5pt;mso-bidi-font-size:
10.0pt;font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>¡£</span><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:
10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:
10.0pt'><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span></span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>ÔÚ¹Ø±ÕÉè±¸Ê±£¬±ØĞëÍ¨¹ıµ÷ÓÃ</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>free_irq()</span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>º¯ÊıÊÍ·ÅËùÉêÇëµÄÖĞ¶ÏÇëÇóºÅ¡£ÀıÈç£¬µ±ÈíÅÌ²Ù×÷ÖÕÖ¹Ê±£¨»òÕßÖÕÖ¹¶Ô£¯</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>dev/fd0/</span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>µÄ</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>I/O</span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>²Ù×÷£¬»òÕßĞ¶ÔØÕâ¸öÎÄ¼şÏµÍ³£©£¬Çı¶¯³ÌĞò¾Í·ÅÆúÕâ¸öÖĞ¶ÏºÅ£º</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:21.25pt;text-indent:21.25pt'><span
lang=EN-US>free_<span class=GramE>irq(</span>6, NULL);</span></p>

<p class=MsoNormal style='mso-outline-level:1'><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>2</span><span
style='font-size:10.5pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>£®¶Ô</span><span
lang=EN-US style='font-size:10.5pt;mso-bidi-font-size:10.0pt'>setup_</span><span
lang=EN-US> irq()</span><span style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>º¯ÊıµÄÊ¹ÓÃ</span><span lang=EN-US
style='font-size:10.5pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp; </span></span>ÔÚÏµÍ³³õÊ¼»¯½×¶Î£¬ÄÚºËÎªÁË³õÊ¼»¯Ê±ÖÓÖĞ¶ÏÉè±¸<span
lang=EN-US>irq0</span>ÃèÊö·û£¬ÔÚ<span lang=EN-US>time_init(<span
style='mso-spacerun:yes'>&nbsp; </span>)</span>º¯ÊıÖĞÊ¹ÓÃÁËÏÂÃæµÄÓï¾ä£º</p>

<p class=MsoPlainText style='text-indent:21.25pt'><span class=GramE><span
lang=EN-US>struct</span></span><span lang=EN-US> irqaction irq0<span
style='mso-spacerun:yes'>&nbsp; </span>= </span></p>

<p class=MsoPlainText><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>{timer_interrupt, SA_INTERRUPT,
0, &quot;timer&quot;, NULL,}; </span></p>

<p class=MsoPlainText><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>setup_<span class=GramE>irq(</span>0,
&amp;irq0); </span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span></span>Ê×ÏÈ£¬³õÊ¼»¯ÀàĞÍÎª<span
lang=EN-US>irqaction</span>µÄ<span lang=EN-US>irq0</span>±äÁ¿£¬°Ñ<span lang=EN-US>handler</span><span
class=GramE>ÓòÉèÖÃ</span>³É<span lang=EN-US>timer_interrupt(<span
style='mso-spacerun:yes'>&nbsp; </span>)</span>º¯ÊıµÄµØÖ·£¬<span lang=EN-US>flags</span><span
class=GramE>ÓòÉèÖÃ</span>³É<span lang=EN-US>SA_INTERRUPT</span>£¬<span lang=EN-US>name</span><span
class=GramE>ÓòÉèÖÃ</span>³É<span lang=EN-US>&quot;timer&quot;</span>£¬×îºóÒ»¸ö<span
class=GramE>ÓòÉèÖÃ</span>³É<span lang=EN-US>NULL</span>ÒÔ±íÊ¾Ã»ÓĞÓÃ<span lang=EN-US>dev_id</span>Öµ¡£½ÓÏÂÀ´£¬ÄÚºËµ÷ÓÃ<span
lang=EN-US>setup_x86_irq(<span style='mso-spacerun:yes'>&nbsp; </span>)</span>£¬°Ñ<span
lang=EN-US>irq0</span>²åÈëµ½<span lang=EN-US>IRQ0</span>µÄÖĞ¶ÏÇëÇó¶ÓÁĞ£º</p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span><span
style='mso-spacerun:yes'>&nbsp;</span></span>ÀàËÆµØ£¬ÄÚºË³õÊ¼»¯Óë<span lang=EN-US>IRQ2</span>ºÍ<span
lang=EN-US>IRQ13</span>Ïà¹ØµÄ<span lang=EN-US>irqaction</span>ÃèÊö·û£¬²¢°ÑËüÃÇ²åÈëµ½ÏàÓ¦µÄÇëÇó¶ÓÁĞÖĞ£¬ÔÚ<span
lang=EN-US> init_IRQ(<span style='mso-spacerun:yes'>&nbsp; </span>)</span>º¯ÊıÖĞÓĞÏÂÃæµÄÓï¾ä£º</p>

<p class=MsoPlainText style='text-indent:21.25pt'><span class=GramE><span
lang=EN-US>struct</span></span><span lang=EN-US> irqaction irq2 = </span></p>

<p class=MsoPlainText><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span style='mso-tab-count:
2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{no_action, 0, 0,
&quot;cascade&quot;, NULL,}; </span></p>

<p class=MsoPlainText style='text-indent:21.25pt'><span class=GramE><span
lang=EN-US>struct</span></span><span lang=EN-US> irqaction irq13 = </span></p>

<p class=MsoPlainText><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>{<span style='mso-tab-count:
1'>&nbsp;&nbsp; </span>math_error_irq, 0, 0, &quot;fpu&quot;, NULL,}; </span></p>

<p class=MsoPlainText style='text-indent:21.25pt'><span lang=EN-US>setup_x86_<span
class=GramE>irq(</span>2, &amp;irq2); </span></p>

<p class=MsoPlainText style='text-indent:21.25pt'><span lang=EN-US>setup_x86_<span
class=GramE>irq(</span>13, &amp;irq13); </span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

</div>

</body>


<!-- Mirrored from www.kerneltravel.net/kernel-book/ç¬¬ä¸‰ç« ä¸­æ–­æœºåˆ¶/3.3.3.htm by HTTrack Website Copier/3.x [XR&CO'2008], Sat, 29 Dec 2012 03:00:07 GMT -->
</html>
