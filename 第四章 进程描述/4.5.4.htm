<html xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:st1="urn:schemas-microsoft-com:office:smarttags"
xmlns="http://www.w3.org/TR/REC-html40">


<!-- Mirrored from www.kerneltravel.net/kernel-book/ç¬¬å››ç« %20è¿›ç¨‹æè¿°/4.5.4.htm by HTTrack Website Copier/3.x [XR&CO'2008], Sat, 29 Dec 2012 03:00:20 GMT -->
<head>
<meta http-equiv=Content-Type content="text/html; charset=gb2312">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 11">
<meta name=Originator content="Microsoft Word 11">
<link rel=File-List href="4.5.5.files/filelist.html">
<title>µÈ´ı¶ÓÁĞ</title>
<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="chsdate" downloadurl=""/>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>CLJ</o:Author>
  <o:Template>Normal</o:Template>
  <o:LastAuthor>CLJ</o:LastAuthor>
  <o:Revision>2</o:Revision>
  <o:TotalTime>0</o:TotalTime>
  <o:Created>2007-08-15T03:05:00Z</o:Created>
  <o:LastSaved>2007-08-15T03:05:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>842</o:Words>
  <o:Characters>4803</o:Characters>
  <o:Lines>40</o:Lines>
  <o:Paragraphs>11</o:Paragraphs>
  <o:CharactersWithSpaces>5634</o:CharactersWithSpaces>
  <o:Version>11.5606</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:GrammarState>Clean</w:GrammarState>
  <w:PunctuationKerning/>
  <w:DrawingGridVerticalSpacing>7.8 °õ</w:DrawingGridVerticalSpacing>
  <w:DisplayHorizontalDrawingGridEvery>0</w:DisplayHorizontalDrawingGridEvery>
  <w:DisplayVerticalDrawingGridEvery>2</w:DisplayVerticalDrawingGridEvery>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:Compatibility>
   <w:SpaceForUL/>
   <w:BalanceSingleByteDoubleByteWidth/>
   <w:DoNotLeaveBackslashAlone/>
   <w:ULTrailSpace/>
   <w:DoNotExpandShiftReturn/>
   <w:AdjustLineHeightInTable/>
   <w:BreakWrappedTables/>
   <w:SnapToGridInCell/>
   <w:WrapTextWithPunct/>
   <w:UseAsianBreakRules/>
   <w:DontGrowAutofit/>
   <w:UseFELayout/>
  </w:Compatibility>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" LatentStyleCount="156">
 </w:LatentStyles>
</xml><![endif]--><!--[if !mso]><object
 classid="clsid:38481807-CA0E-42D2-BF39-B33AF135CC4D" id=ieooui></object>
<style>
st1\:*{behavior:url(#ieooui) }
</style>
<![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:ËÎÌå;
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-alt:SimSun;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 135135232 16 0 262145 0;}
@font-face
	{font-family:"\@ËÎÌå";
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 135135232 16 0 262145 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	mso-pagination:none;
	font-size:10.5pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:ËÎÌå;
	mso-font-kerning:1.0pt;}
p.MsoPlainText, li.MsoPlainText, div.MsoPlainText
	{margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	mso-pagination:none;
	font-size:10.5pt;
	mso-bidi-font-size:10.0pt;
	font-family:ËÎÌå;
	mso-hansi-font-family:"Courier New";
	mso-bidi-font-family:"Times New Roman";
	color:black;
	mso-font-kerning:1.0pt;}
span.GramE
	{mso-style-name:"";
	mso-gram-e:yes;}
 /* Page Definitions */
 @page
	{mso-page-border-surround-header:no;
	mso-page-border-surround-footer:no;}
@page Section1
	{size:595.3pt 841.9pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;
	mso-header-margin:42.55pt;
	mso-footer-margin:49.6pt;
	mso-paper-source:0;
	layout-grid:15.6pt;}
div.Section1
	{page:Section1;}
 /* List Definitions */
 @list l0
	{mso-list-id:227963544;
	mso-list-type:simple;
	mso-list-template-ids:1937021516;}
@list l0:level1
	{mso-level-number-format:bullet;
	mso-level-text:¡¤;
	mso-level-tab-stop:21.25pt;
	mso-level-number-position:left;
	margin-left:21.25pt;
	text-indent:-21.25pt;
	font-family:ËÎÌå;
	mso-hansi-font-family:Wingdings;}
@list l1
	{mso-list-id:1610237553;
	mso-list-type:simple;
	mso-list-template-ids:1937021516;}
@list l1:level1
	{mso-level-number-format:bullet;
	mso-level-text:¡¤;
	mso-level-tab-stop:21.25pt;
	mso-level-number-position:left;
	margin-left:21.25pt;
	text-indent:-21.25pt;
	font-family:ËÎÌå;
	mso-hansi-font-family:Wingdings;}
@list l2
	{mso-list-id:1998266859;
	mso-list-type:simple;
	mso-list-template-ids:1937021516;}
@list l2:level1
	{mso-level-number-format:bullet;
	mso-level-text:¡¤;
	mso-level-tab-stop:21.25pt;
	mso-level-number-position:left;
	margin-left:21.25pt;
	text-indent:-21.25pt;
	font-family:ËÎÌå;
	mso-hansi-font-family:Wingdings;}
ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:ÆÕÍ¨±í¸ñ;
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
	mso-para-margin:0cm;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-ansi-language:#0400;
	mso-fareast-language:#0400;
	mso-bidi-language:#0400;}
</style>
<![endif]-->
</head>

<body lang=ZH-CN style='tab-interval:21.0pt;text-justify-trim:punctuation'>

<div class=Section1 style='layout-grid:15.6pt'>

<p class=MsoNormal align=left style='text-align:left;mso-outline-level:1;
mso-layout-grid-align:none;text-autospace:none'><st1:chsdate Year="1899"
Month="12" Day="30" IsLunarDate="False" IsROCDate="False" w:st="on"><b
 style='mso-bidi-font-weight:normal'><span lang=EN-US style='font-family:ËÎÌå;
 mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>4.5.4</span></b></st1:chsdate><b
style='mso-bidi-font-weight:normal'><span style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'>µÈ´ı¶ÓÁĞ<span lang=EN-US><o:p></o:p></span></span></b></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:36.0pt;
mso-layout-grid-align:none;text-autospace:none'><span style='font-family:ËÎÌå;
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>ÔÚ<span
lang=EN-US>2.4</span>°æ±¾ÖĞ£¬ÒıÈëÁËÒ»ÖÖÌØÊâµÄÁ´±í<span lang=EN-US>-</span>Í¨ÓÃË«ÏòÁ´±í£¬ËüÊÇÄÚºËÖĞÊµÏÖÆäËüÁ´±íµÄ»ù´¡£¬Ò²ÊÇÃæÏò¶ÔÏóµÄË¼ÏëÔÚ<span
lang=EN-US>C</span>ÓïÑÔÖĞµÄÓ¦ÓÃ¡£ÔÚµÈ´ı¶ÓÁĞµÄÊµÏÖÖĞ¶à´ÎÉæ¼°Óë´ËÁ´±íÏà¹ØµÄÄÚÈİ¡£<span lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-outline-level:1;
mso-layout-grid-align:none;text-autospace:none'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black;mso-font-kerning:0pt'>1</span></b><b style='mso-bidi-font-weight:
normal'><span style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black;mso-font-kerning:0pt'>£®Í¨ÓÃË«ÏòÁ´±í<span lang=EN-US><o:p></o:p></span></span></b></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp; </span></span><span style='font-family:
ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>ÔÚ<span
lang=EN-US>include/linux/list.h</span>ÖĞ¶¨ÒåÁËÕâÖÖÁ´±í£º<span lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span class=GramE><span lang=EN-US style='font-family:
ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>struct</span></span><span
lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black;mso-font-kerning:0pt'> list_head {<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>struct</span> list_head *next, *prev;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'>};<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'>ÕâÊÇË«ÏòÁ´±íµÄÒ»¸ö»ù±¾¿ò¼Ü£¬ÔÚÆäËüÊ¹ÓÃÁ´±íµÄµØ·½¾Í¿ÉÒÔÊ¹ÓÃËüÀ´¶¨ÒåÈÎÒâÒ»¸öË«ÏòÁ´±í£¬ÀıÈç£º<span
lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span class=GramE><span lang=EN-US style='font-family:
ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>struct</span></span><span
lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black;mso-font-kerning:0pt'> foo_list {<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span style='mso-tab-count:
1'>&nbsp;&nbsp;&nbsp; </span><span class=GramE>int</span> data;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span style='mso-tab-count:
1'>&nbsp;&nbsp;&nbsp; </span><span class=GramE>struct</span> list_head list;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'>};<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'>¶ÔÓÚ<span lang=EN-US>list_head</span>ÀàĞÍµÄÁ´±í£¬<span
lang=EN-US>Linux</span>¶¨ÒåÁËÎå¸öºê£º<span lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'>#define LIST_HEAD_<span
class=GramE>INIT(</span>name) { &amp;(name), &amp;(name) }<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'>#define LIST_<span
class=GramE>HEAD(</span>name) \<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>struct</span> list_head name = LIST_HEAD_INIT(name)<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'>#define INIT_LIST_<span
class=GramE>HEAD(</span>ptr) do { \<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-outline-level:1;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(<span
class=GramE>ptr</span>)-&gt;next = (ptr); (ptr<span class=GramE>)-</span>&gt;prev
= (ptr); \<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'>} while (0)<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'>#define list_<span
class=GramE>entry(</span>ptr, type, member) \<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>((type *<span class=GramE>)(</span>(char *)(ptr)-(unsigned
long)(&amp;((type *)0)-&gt;member)))<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'>#define list_for_<span
class=GramE>each(</span>pos, head) \<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp; </span><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span
class=GramE>for</span> (pos = (head)-&gt;next; pos != (head); pos =
pos-&gt;next)<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt;
mso-layout-grid-align:none;text-autospace:none'><span style='font-family:ËÎÌå;
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>Ç°Èı¸ö<span
class=GramE>ºê¶¼ÊÇ</span>³õÊ¼»¯Ò»¸ö¿ÕµÄÁ´±í£¬µ«ÓÃ·¨²»Í¬£¬<span lang=EN-US>LIST_HEAD_INIT()</span>ÔÚÉùÃ÷Ê±Ê¹ÓÃ£¬ÓÃÀ´³õÊ¼»¯½á¹¹ÔªËØ£¬µÚ¶ş¸öºêÓÃÔÚ¾²Ì¬±äÁ¿³õÊ¼»¯µÄÉùÃ÷ÖĞ£¬¶øµÚÈı¸öºêÓÃÔÚº¯ÊıÄÚ²¿¡£<span
lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt;
mso-layout-grid-align:none;text-autospace:none'><span style='font-family:ËÎÌå;
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>ÆäÖĞ£¬×îÄÑÀí½âµÄºêÎª<span
lang=EN-US>list_entry</span>£¨£©£¬ÔÚÄÚºË´úÂëµÄºÜ¶à´¦¶¼ÓÃµ½Õâ¸öºê£¬ÀıÈç£¬ÔÚµ÷¶È³ÌĞòÖĞ£¬´ÓÔËĞĞ¶ÓÁĞÖĞÑ¡ÔñÒ»¸ö×îÖµµÃÔËĞĞµÄ½ø³Ì£¬²¿·Ö´úÂëÈçÏÂ£º<span
lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt;
mso-layout-grid-align:none;text-autospace:none'><span class=GramE><span
lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black;mso-font-kerning:0pt'>static</span></span><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'> LIST_HEAD(runqueue_head);<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt;
mso-layout-grid-align:none;text-autospace:none'><span class=GramE><span
lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black;mso-font-kerning:0pt'>struct</span></span><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'> list_head *tmp;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt;
mso-layout-grid-align:none;text-autospace:none'><span class=GramE><span
lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black;mso-font-kerning:0pt'>struct</span></span><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'> task_struct *p;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>list_for_<span class=GramE>each(</span>tmp,
&amp;runqueue_head) {<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;
</span>p = list_<span class=GramE>entry(</span>tmp, struct task_struct,
run_list);<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span
class=GramE>if</span> (can_schedule(p)) {<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>int</span> weight = goodness(p, this_cpu, prev-&gt;active_mm);<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>if</span> (weight &gt; c)<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'><span style='mso-spacerun:yes'>&nbsp; </span><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>c
= weight, next = p;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;
</span>}<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>}<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp; </span></span><span style='font-family:ËÎÌå;
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>´ÓÕâ¶Î´úÂë¿ÉÒÔ·ÖÎö³ö<span
lang=EN-US>list_entry(ptr, type, member)</span><span class=GramE>ºê¼°²ÎÊı</span>µÄº¬Òå£º<span
lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp; </span>ptr</span>ÊÇÖ¸Ïò<span
lang=EN-US>list_head</span>ÀàĞÍÁ´±íµÄÖ¸Õë£¬<span lang=EN-US>type</span>ÎªÒ»¸ö½á¹¹£¬¶ø<span
lang=EN-US>member</span>Îª½á¹¹<span lang=EN-US>type</span>ÖĞµÄÒ»¸öÓò£¬ÀàĞÍÎª<span
lang=EN-US>list_head</span>£¬Õâ¸öºê·µ»ØÖ¸Ïò<span lang=EN-US>type</span>½á¹¹µÄÖ¸Õë¡£ÔÚÄÚºË´úÂëÖĞ´óÁ¿ÒıÓÃÁËÕâ¸öºê£¬Òò´Ë£¬¸ãÇå³şÕâ¸öºêµÄº¬ÒåºÍÓÃ·¨·Ç³£ÖØÒª¡£<span
lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:36.0pt;
mso-layout-grid-align:none;text-autospace:none'><span style='font-family:ËÎÌå;
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>ÁíÍâ£¬¶Ô<span
lang=EN-US>list_head</span>ÀàĞÍµÄÁ´±í½øĞĞÉ¾³ıºÍ²åÈë£¨Í·»òÎ²£©µÄºêÎª<span lang=EN-US>list_del()/list_add()/list_add_tail()</span>£¬ÔÚÄÚºËµÄÆäËüº¯ÊıÖĞ¿ÉÒÔµ÷ÓÃÕâĞ©ºê¡£ÀıÈç£¬´ÓÔËĞĞ¶ÓÁĞÖĞÉ¾³ı¡¢Ôö¼Ó¼°ÒÆ¶¯Ò»¸öÈÎÎñµÄ´úÂëÈçÏÂ£º<span
lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span class=GramE><span lang=EN-US style='font-family:
ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>static</span></span><span
lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black;mso-font-kerning:0pt'> inline void del_from_runqueue(struct
task_struct * p)<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'>{<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>nr_running--</span>;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>list_<span class=GramE>del(</span>&amp;p-&gt;run_list);<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>p</span>-&gt;run_list.next = NULL;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'>}<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span class=GramE><span lang=EN-US style='font-family:
ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>static</span></span><span
lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black;mso-font-kerning:0pt'> inline void add_to_runqueue(struct
task_struct * p)<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'>{<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>list_<span class=GramE>add(</span>&amp;p-&gt;run_list, &amp;runqueue_head);<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>nr_running</span>++;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'>}<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span class=GramE><span lang=EN-US style='font-family:
ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>static</span></span><span
lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black;mso-font-kerning:0pt'> inline void move_last_runqueue(struct
task_struct * p)<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'>{<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>list_<span class=GramE>del(</span>&amp;p-&gt;run_list);<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>list_add_<span class=GramE>tail(</span>&amp;p-&gt;run_list,
&amp;runqueue_head);<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'>}<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span class=GramE><span lang=EN-US style='font-family:
ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>static</span></span><span
lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black;mso-font-kerning:0pt'> inline void move_first_runqueue(struct
task_struct * p)<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'>{<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>list_<span class=GramE>del(</span>&amp;p-&gt;run_list);<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>list_<span class=GramE>add(</span>&amp;p-&gt;run_list,
&amp;runqueue_head);<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'>}<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-outline-level:1;
mso-layout-grid-align:none;text-autospace:none'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black;mso-font-kerning:0pt'>2.</span></b><b style='mso-bidi-font-weight:
normal'><span style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black;mso-font-kerning:0pt'>µÈ´ı¶ÓÁĞ<span lang=EN-US><o:p></o:p></span></span></b></p>

<p class=MsoPlainText style='text-indent:21.25pt'>ÔËĞĞ¶ÓÁĞÁ´±í°Ñ´¦ÓÚ<span lang=EN-US>TASK_RUNNING</span>×´Ì¬µÄËùÓĞ½ø³Ì×éÖ¯ÔÚÒ»Æğ¡£µ±Òª°ÑÆäËû×´Ì¬µÄ½ø³Ì·Ö×éÊ±£¬²»Í¬µÄ×´Ì¬ÒªÇó²»Í¬µÄ´¦Àí£¬<span
lang=EN-US>Linux</span>Ñ¡ÔñÁËÏÂÁĞ·½Ê½Ö®Ò»£º</p>

<p class=MsoPlainText style='margin-left:42.25pt;text-indent:-21.25pt;
mso-list:l2 level1 lfo1;tab-stops:list 21.25pt'><![if !supportLists]><span
lang=EN-US style='mso-hansi-font-family:Wingdings;mso-bidi-font-family:ËÎÌå'><span
style='mso-list:Ignore'>¡¤<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span lang=EN-US>TASK_STOPPED</span>»ò<span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp; </span>TASK_ZOMBIE</span>×´Ì¬µÄ½ø³Ì<span
class=GramE>²»</span>Á´½ÓÔÚ×¨ÃÅµÄÁ´±íÖĞ£¬Ò²Ã»±ØÒª°ÑËüÃÇ·Ö×é£¬ÒòÎª¸¸½ø³Ì¿ÉÒÔÍ¨¹ı½ø³ÌµÄ<span lang=EN-US>PID</span>£¬»ò½ø³Ì¼äµÄÇ×Êô¹ØÏµ¼ìË÷µ½×Ó½ø³Ì¡£</p>

<p class=MsoPlainText style='margin-left:42.25pt;text-indent:-21.25pt;
mso-list:l2 level1 lfo1;tab-stops:list 21.25pt'><![if !supportLists]><span
lang=EN-US style='mso-hansi-font-family:Wingdings;mso-bidi-font-family:ËÎÌå'><span
style='mso-list:Ignore'>¡¤<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>°Ñ<span lang=EN-US>TASK_INTERRUPTIBLE </span>»ò<span
lang=EN-US> TASK_UNINTERRUPTIBLE</span>×´Ì¬µÄ½ø³ÌÔÙ·Ö³ÉºÜ¶àÀà£¬ÆäÃ¿Ò»Àà¶ÔÓ¦Ò»¸öÌØ¶¨µÄÊÂ¼ş¡£ÔÚÕâÖÖÇé¿öÏÂ£¬½ø³Ì×´Ì¬Ìá¹©µÄĞÅÏ¢Âú×ã²»ÁË¿ìËÙ¼ìË÷½ø³Ì£¬Òò´Ë£¬ÓĞ±ØÒªÒıÈëÁíÍâµÄ½ø³ÌÁ´±í¡£ÕâĞ©Á´±í½ĞµÈ´ı¶ÓÁĞ¡£</p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='mso-spacerun:yes'>&nbsp; </span></span><span style='font-family:ËÎÌå;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>µÈ´ı¶ÓÁĞÔÚÄÚºËÖĞÓĞºÜ¶àÓÃÍ¾£¬ÓÈÆä¶ÔÖĞ¶Ï´¦Àí¡¢½ø³ÌÍ¬²½¼°¶¨Ê±ÓÃ´¦¸ü´ó¡£ÒòÎªÕâĞ©ÄÚÈİÔÚÒÔºóµÄÕÂ½ÚÖĞÌÖÂÛ£¬ÎÒÃÇÖ»ÔÚÕâÀïËµÃ÷£¬½ø³Ì±ØĞë¾­³£µÈ´ıÄ³Ğ©ÊÂ¼şµÄ·¢Éú£¬ÀıÈç£¬µÈ´ıÒ»¸ö´ÅÅÌ²Ù×÷µÄÖÕÖ¹£¬µÈ´ıÊÍ·ÅÏµÍ³×ÊÔ´£¬»òµÈ´ıÊ±¼ä×ß¹ı¹Ì¶¨µÄ¼ä¸ô¡£µÈ´ı¶ÓÁĞÊµÏÖÔÚÊÂ¼şÉÏµÄÌõ¼şµÈ´ı£¬Ò²¾ÍÊÇËµ£¬Ï£ÍûµÈ´ıÌØ¶¨ÊÂ¼şµÄ½ø³Ì°Ñ×Ô¼º·Å½øºÏÊÊµÄµÈ´ı¶ÓÁĞ£¬²¢·ÅÆú¿ØÖÆÈ¨¡£Òò´Ë£¬µÈ´ı¶ÓÁĞ±íÊ¾Ò»×éË¯ÃßµÄ½ø³Ì£¬µ±Ä³Ò»Ìõ¼ş±äÎªÕæÊ±£¬ÓÉÄÚºË»½ĞÑËüÃÇ¡£µÈ´ı¶ÓÁĞÓÉÑ­»·Á´±íÊµÏÖ¡£ÔÚ</span><span
lang=EN-US>2.4</span><span style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>µÄ°æ±¾ÖĞ£¬¹ØÓÚµÈ´ı¶ÓÁĞµÄ¶¨ÒåÈçÏÂ£¨ÎªÁËÃèÊö·½±ã£¬ÓĞËù¼ò»¯£©£º</span></p>

<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
mso-layout-grid-align:none;text-autospace:none'><span class=GramE><span
lang=EN-US>struct</span></span><span lang=EN-US> __wait_queue {</span></p>

<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>unsigned</span> int flags;</span></p>

<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>struct</span> task_struct * task;</span></p>

<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>struct</span> list_head task_list;</span></p>

<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US>};</span></p>

<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
mso-layout-grid-align:none;text-autospace:none'><span class=GramE><span
lang=EN-US>typedef</span></span><span lang=EN-US> struct __wait_queue
wait_queue_t;</span></p>

<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span></span><span
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>ÁíÍâ£¬¹ØÓÚµÈ´ı¶ÓÁĞÁíÒ»¸öÖØÒªµÄÊı¾İ½á¹¹¡ªµÈ´ı¶ÓÁĞÊ×²¿µÄÃèÊöÈçÏÂ£º<span lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
mso-layout-grid-align:none;text-autospace:none'><span class=GramE><span
lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black;mso-font-kerning:0pt'>struct</span></span><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'> __wait_queue_head {<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>wq_lock_t</span> lock;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>struct</span> list_head task_list;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>};<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
mso-layout-grid-align:none;text-autospace:none'><span class=GramE><span
lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black;mso-font-kerning:0pt'>typedef</span></span><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'> struct __wait_queue_head wait_queue_head_t;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
mso-layout-grid-align:none;text-autospace:none'><span style='font-family:ËÎÌå;
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>ÔÚÕâÁ½¸öÊı¾İ½á¹¹µÄ¶¨ÒåÖĞ£¬¶¼Éæ¼°<span
class=GramE>µ½ÀàĞÍ</span>Îª<span lang=EN-US>list_head</span>µÄÁ´±í£¬ÕâÓë<span lang=EN-US>2.2</span>°æ¶¨ÒåÊÇ²»Í¬µÄ£¬ÔÚ<span
lang=EN-US>2.2</span>°æÖĞµÄ¶¨ÒåÎª£º<span lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
mso-layout-grid-align:none;text-autospace:none'><span class=GramE><span
lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black;mso-font-kerning:0pt'>struct</span></span><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'> wait_queue {<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>struct</span> task_struct * task;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=GramE>struct</span> wait_queue * next;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>};<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
mso-layout-grid-align:none;text-autospace:none'><span class=GramE><span
lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black;mso-font-kerning:0pt'>typedef</span></span><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'> struct wait_queue wait_queue_t;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
mso-layout-grid-align:none;text-autospace:none'><span class=GramE><span
lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black;mso-font-kerning:0pt'>typedef</span></span><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'> struct wait_queue *wait_queue_head_t;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt;
mso-layout-grid-align:none;text-autospace:none'><span style='font-family:ËÎÌå;
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>ÕâÀïÒªÌØ±ğÇ¿µ÷µÄÊÇ£¬<span
lang=EN-US>2.4</span>°æÖĞ¶ÔµÈ´ı¶ÓÁĞµÄ²Ù×÷º¯ÊıºÍ<span class=GramE>ºê±È</span><span lang=EN-US>2.2</span>°æ·á¸»ÁË£¬¶øÔÚÄã±àĞ´Éè±¸Çı¶¯³ÌĞòÊ±»áÓÃµ½ÕâĞ©º¯ÊıºÍ<span
class=GramE>ºê£¬</span>Òò´Ë£¬Òª×¢Òâ<span lang=EN-US>2.2</span>µ½<span lang=EN-US>2.4</span>º¯ÊıµÄÒÆÖ²ÎÊÌâ¡£ÏÂÃæ¸ø³ö<span
lang=EN-US>2.4</span>°æÖĞµÄÒ»Ğ©Ö÷Òªº¯Êı¼°Æä¹¦ÄÜ£º<span lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>init_waitqueue_head</span><span style='font-family:ËÎÌå;
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>£¨£©¡ª¶ÔµÈ´ı¶ÓÁĞÊ×²¿½øĞĞ³õÊ¼»¯<span
lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>init_waitqueue_entry</span><span style='font-family:ËÎÌå;
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>£¨£©£­¶ÔÒª¼ÓÈëµÈ´ı¶ÓÁĞµÄÔªËØ½øĞĞ³õÊ¼»¯<span
lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>waitqueue_active</span><span style='font-family:ËÎÌå;
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>£¨£©<span
class=GramE>¡ªÅĞ¶Ï</span>µÈ´ı¶ÓÁĞÖĞÒÑ¾­Ã»ÓĞµÈ´ıµÄ½ø³Ì<span lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>add_wait_queue</span><span style='font-family:ËÎÌå;
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>£¨£©¡ª¸øµÈ´ı¶ÓÁĞÖĞÔö¼ÓÒ»¸öÔªËØ<span
lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>remove_wait_queue</span><span style='font-family:ËÎÌå;
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>£¨£©¡ª´ÓµÈ´ı¶ÓÁĞÖĞÉ¾³ıÒ»¸öÔªËØ<span
lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
mso-layout-grid-align:none;text-autospace:none'><span style='font-family:ËÎÌå;
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>×¢Òâ£¬ÔÚÒÔÉÏº¯ÊıµÄÊµÏÖÖĞ£¬¶¼µ÷ÓÃÁË¶Ô<span
lang=EN-US>list_head </span>ÀàĞÍÁ´±íµÄ²Ù×÷º¯Êı£¨<span lang=EN-US>list_del()/list_add()/list_add_tail()</span>£©£¬Òò´ËËµ£¬<span
lang=EN-US>list_head </span>ÀàĞÍÏàµ±ÓÚ<span lang=EN-US>C++</span>ÖĞµÄ»ùÀàĞÍ£¬ÕâÒ²ÊÇ¶Ô<span
lang=EN-US>2.2 </span>°æµÄ¼«´ó¸Ä½ø¡£<span lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText>Ï£ÍûµÈ´ıÒ»¸öÌØ¶¨ÊÂ¼şµÄ½ø³ÌÄÜµ÷ÓÃÏÂÁĞº¯ÊıÖĞµÄÈÎÒ»<span class=GramE>¸ö</span>£º</p>

<p class=MsoPlainText style='margin-left:21.25pt;text-indent:-21.25pt;
mso-list:l0 level1 lfo2;tab-stops:list 21.25pt'><![if !supportLists]><span
lang=EN-US style='mso-hansi-font-family:Wingdings;mso-bidi-font-family:ËÎÌå'><span
style='mso-list:Ignore'>¡¤<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span lang=EN-US>sleep_on(<span
style='mso-spacerun:yes'>&nbsp; </span>)</span>º¯Êı¶Ôµ±Ç°µÄ½ø³ÌÆğ×÷ÓÃ£¬ÎÒÃÇ°Ñµ±Ç°½ø³Ì½Ğ×ö<span
lang=EN-US>P</span>£º</p>

<p class=MsoPlainText><span lang=EN-US>sleep_<span class=GramE>on(</span>wait_queue_head_t
*q)</span></p>

<p class=MsoPlainText><span lang=EN-US>{</span></p>

<p class=MsoPlainText><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>SLEEP_ON_VAR<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span></span>£¯£ªºê¶¨Òå£¬ÓÃÀ´³õÊ¼»¯Òª²åÈëµ½µÈ´ı¶ÓÁĞÖĞµÄÔªËØ£ª£¯</p>

<p class=MsoPlainText><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=GramE>current</span>-&gt;state = TASK_UNINTERRUPTIBLE;</span></p>

<p class=MsoPlainText><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='mso-spacerun:yes'>&nbsp;</span>SLEEP_ON_HEAD<span
style='mso-spacerun:yes'>&nbsp; </span></span>£¯£ªºê¶¨Òå£¬°Ñ<span lang=EN-US>P</span>²åÈëµ½µÈ´ı¶ÓÁĞ
£ª£¯</p>

<p class=MsoPlainText><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=GramE>schedule(</span>);</span></p>

<p class=MsoPlainText><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>SLEEP_ON_TAIL<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span></span>£¯£ªºê¶¨Òå£¬
°Ñ<span lang=EN-US>P</span>´ÓµÈ´ı¶ÓÁĞÖĞÉ¾³ı £ª£¯</p>

<p class=MsoPlainText><span lang=EN-US>}</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span></span>Õâ¸öº¯Êı°Ñ<span
lang=EN-US>P</span>µÄ×´Ì¬ÉèÖÃÎª<span lang=EN-US>TASK_UNINTERRUPTIBLE</span>£¬²¢°Ñ<span
lang=EN-US>P</span>²åÈëµÈ´ı¶ÓÁĞ¡£È»ºó£¬Ëüµ÷ÓÃµ÷¶È³ÌĞò»Ö¸´ÁíÒ»¸ö³ÌĞòµÄÖ´ĞĞ¡£µ±<span lang=EN-US>P</span>±»»½ĞÑÊ±£¬µ÷¶È³ÌĞò»Ö¸´<span
lang=EN-US>sleep_on(<span style='mso-spacerun:yes'>&nbsp; </span>)</span>º¯ÊıµÄÖ´ĞĞ£¬°Ñ<span
lang=EN-US>P</span>´ÓµÈ´ı¶ÓÁĞÖĞÉ¾³ı¡£</p>

<p class=MsoPlainText style='margin-left:21.25pt;text-indent:-21.25pt;
mso-list:l1 level1 lfo3;tab-stops:list 21.25pt'><![if !supportLists]><span
lang=EN-US style='mso-hansi-font-family:Wingdings;mso-bidi-font-family:ËÎÌå'><span
style='mso-list:Ignore'>¡¤<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span lang=EN-US>interruptible_sleep_on(<span
style='mso-spacerun:yes'>&nbsp; </span>)</span>Óë<span lang=EN-US>sleep_on(<span
style='mso-spacerun:yes'>&nbsp; </span>)</span>º¯ÊıÊÇÒ»ÑùµÄ£¬µ«ÉÔÓĞ²»Í¬£¬Ç°Õß<span
class=GramE>°Ñ½ø³Ì</span><span lang=EN-US>P</span>µÄ×´Ì¬ÉèÖÃÎª<span lang=EN-US>TASK_INTERRUPTIBLE
</span>¶ø²»ÊÇ<span lang=EN-US>TASK_UNINTERRUPTIBLE </span>£¬Òò´Ë£¬Í¨¹ı½ÓÊÜÒ»¸öĞÅºÅ¿ÉÒÔ»½ĞÑ<span
lang=EN-US>P</span>¡£</p>

<p class=MsoPlainText style='margin-left:21.25pt;text-indent:-21.25pt;
mso-list:l1 level1 lfo3;tab-stops:list 21.25pt'><![if !supportLists]><span
lang=EN-US style='mso-hansi-font-family:Wingdings;mso-bidi-font-family:ËÎÌå'><span
style='mso-list:Ignore'>¡¤<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span lang=EN-US>sleep_on_timeout(<span
style='mso-spacerun:yes'>&nbsp; </span>) </span>ºÍ<span lang=EN-US>interruptible_sleep_on_timeout(<span
style='mso-spacerun:yes'>&nbsp; </span>)</span>ÓëÇ°ÃæÇé¿öÀàËÆ£¬µ«ËüÃÇÔÊĞíµ÷ÓÃÕß¶¨ÒåÒ»¸öÊ±¼ä¼ä¸ô£¬¹ıÁËÕâ¸ö¼ä¸ôÒÔºó£¬ÄÚºË»½ĞÑ½ø³Ì¡£ÎªÁË×öµ½Õâµã£¬ËüÃÇµ÷ÓÃ<span
lang=EN-US>schedule_timeout(<span style='mso-spacerun:yes'>&nbsp; </span>)</span>º¯Êı¶ø²»ÊÇ<span
lang=EN-US>schedule(<span style='mso-spacerun:yes'>&nbsp; </span>)</span>º¯Êı¡£</p>

<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.25pt;
mso-layout-grid-align:none;text-autospace:none'><span style='font-family:ËÎÌå;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>ÀûÓÃ</span><span
lang=EN-US>wake_up </span><span style='font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>»òÕß</span><span
lang=EN-US> wake_up_interruptible</span><span style='font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>ºê£¬ÈÃ²åÈëµÈ´ı¶ÓÁĞÖĞµÄ½ø³Ì½øÈë</span><span
lang=EN-US>TASK_RUNNING</span><span style='font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>×´Ì¬£¬ÕâÁ½¸ö<span
class=GramE>ºê×îÖÕ</span>¶¼µ÷ÓÃÁË</span><span lang=EN-US>try_to_wake_up(<span
style='mso-spacerun:yes'>&nbsp; </span>)</span><span style='font-family:ËÎÌå;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>º¯Êı£º</span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.25pt;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span class=GramE>static</span>
inline int try_to_wake_up(struct task_struct * p, int synchronous)</span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp; </span>{</span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>unsigned</span> long flags;</span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=GramE>int</span> success = 0;</span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>spin_lock_irqsave(&amp;runqueue_lock, flags); /</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>£ª¼ÓËø£ª£¯</span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=GramE>p</span>-&gt;state = TASK_RUNNING;</span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if
(task_on_runqueue(p))<span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>£¯£ªÅĞ¶Ï</span><span lang=EN-US>p</span><span style='font-family:
ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>ÊÇ·ñÒÑ¾­ÔÚÔËĞĞ¶ÓÁĞ£ª£¯</span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=GramE>goto</span> out;</span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>add_to_runqueue(p);<span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>£¯£ª²»ÔÚ£¬Ôò°Ñ</span><span lang=EN-US>p</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>²åÈëµ½ÔËĞĞ¶ÓÁĞ£ª£¯</span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=GramE>if</span> (!synchronous || !(p-&gt;cpus_allowed &amp;
(1 &lt;&lt; smp_processor_id())))<span style='mso-spacerun:yes'>&nbsp; </span></span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>£¯</span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>reschedule_<span class=GramE>idle(</span>p);</span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=GramE>success</span> = 1;</span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span
style='mso-spacerun:yes'>&nbsp;</span><span class=GramE>out</span>:</span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>spin_unlock_irqrestore(&amp;runqueue_lock, flags);<span
style='mso-spacerun:yes'>&nbsp; </span></span><span style='font-family:ËÎÌå;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>£¯£ª¿ªËø£ª£¯</span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>return</span> success;</span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp; </span>}</span><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span></span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>ÔÚÕâ¸öº¯ÊıÖĞ£¬</span><span lang=EN-US>p</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>ÎªÒª»½ĞÑµÄ½ø³Ì¡£Èç¹û</span><span lang=EN-US>p</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>²»ÔÚÔËĞĞ¶ÓÁĞÖĞ£¬Ôò°ÑËü·ÅÈëÔËĞĞ¶ÓÁĞ¡£Èç¹ûÖØĞÂµ÷¶ÈÕıÔÚ½øĞĞµÄ¹ı³ÌÖĞ£¬Ôòµ÷ÓÃ</span><span lang=EN-US>reschedule_idle</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>£¨£©º¯Êı£¬Õâ¸öº¯Êı¾ö¶¨½ø³Ì</span><span lang=EN-US>p</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>ÊÇ·ñÓ¦¸ÃÇÀÕ¼Ä³Ò»</span><span lang=EN-US>CPU</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>ÉÏµÄµ±Ç°½ø³Ì£¨²Î¼ûÏÂÒ»ÕÂ£©¡£</span><span lang=EN-US style='font-family:
ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp; </span></span><span style='font-family:
ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>Êµ¼ÊÉÏ£¬ÔÚÄÚºËµÄÆäËü²¿·Ö£¬×î³£ÓÃµÄ»¹ÊÇ</span><span
lang=EN-US>wake_up </span><span style='font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>»òÕß</span><span
lang=EN-US> wake_up_interruptible</span><span style='font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>ºê£¬Ò²¾ÍÊÇËµ£¬Èç¹ûÄãÒªÔÚ<span
class=GramE>ÄÚºË¼¶</span>½øĞĞ±à³Ì£¬Ö»Ğèµ÷ÓÃÆäÖĞµÄÒ»¸öºê¡£ÀıÈçÒ»¸ö¼òµ¥µÄÊµÊ±Ê±ÖÓ£¨</span><span lang=EN-US>RTC</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>£©ÖĞ¶Ï³ÌĞòÈçÏÂ£º</span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:36.0pt;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:36.0pt;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US>static
DECLARE_WAIT_QUEUE_HEAD(rtc_wait); </span><span style='font-family:ËÎÌå;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>£¯£ª³õÊ¼»¯µÈ´ı¶ÓÁĞÊ×²¿£ª£¯</span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:36.0pt;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:36.0pt;
mso-layout-grid-align:none;text-autospace:none'><span class=GramE><span
lang=EN-US>void</span></span><span lang=EN-US> rtc_interrupt(int irq, void
*dev_id, struct pt_regs *regs)</span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:36.0pt;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US>{</span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:36.0pt;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>spin_<span class=GramE>lock(</span>&amp;rtc_lock);<span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:36.0pt;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>rtc_irq_data = CMOS_<span class=GramE>READ(</span>RTC_INTR_FLAGS);</span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:36.0pt;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>spin_<span class=GramE>unlock(</span>&amp;rtc_lock);<span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:36.0pt;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>wake_up_<span class=GramE>interruptible(</span>&amp;rtc_wait);</span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:36.0pt;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US>}</span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'>Õâ¸öÖĞ¶Ï´¦Àí³ÌĞòÍ¨¹ı´ÓÊµÊ±Ê±ÖÓµÄ<span
lang=EN-US>I/O</span>¶Ë¿Ú£¨</span><span lang=EN-US>CMOS_READ</span><span
class=GramE><span style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>ºê²úÉú</span></span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>Ò»¶Ô</span><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'>outb/inb</span><span
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>£©¶ÁÈ¡Êı¾İ£¬È»ºó»½ĞÑÔÚ</span><span lang=EN-US>rtc_wait</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>µÈ´ı¶ÓÁĞÉÏË¯ÃßµÄÈÎÎñ¡£</span><span lang=EN-US style='font-family:ËÎÌå;
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'><o:p></o:p></span></p>

<p class=MsoNormal align=left style='margin-left:5.4pt;text-align:left;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'><span style='mso-spacerun:yes'>&nbsp;</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

</div>

</body>


<!-- Mirrored from www.kerneltravel.net/kernel-book/ç¬¬å››ç« %20è¿›ç¨‹æè¿°/4.5.4.htm by HTTrack Website Copier/3.x [XR&CO'2008], Sat, 29 Dec 2012 03:00:21 GMT -->
</html>
