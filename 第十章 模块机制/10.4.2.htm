<html xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:st1="urn:schemas-microsoft-com:office:smarttags"
xmlns="http://www.w3.org/TR/REC-html40">


<!-- Mirrored from www.kerneltravel.net/kernel-book/ç¬¬åç« %20æ¨¡å—æœºåˆ¶/10.4.2.htm by HTTrack Website Copier/3.x [XR&CO'2008], Sat, 29 Dec 2012 03:01:28 GMT -->
<head>
<meta http-equiv=Content-Type content="text/html; charset=gb2312">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 11">
<meta name=Originator content="Microsoft Word 11">
<link rel=File-List href="10.4.2.files/filelist.html">
<title>´Ó°æ±¾2.0µ½2.2ÄÚºËAPIµÄ±ä»¯</title>
<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="chsdate" downloadurl=""/>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>CLJ</o:Author>
  <o:Template>Normal</o:Template>
  <o:LastAuthor>CLJ</o:LastAuthor>
  <o:Revision>2</o:Revision>
  <o:TotalTime>1</o:TotalTime>
  <o:Created>2007-08-17T03:40:00Z</o:Created>
  <o:LastSaved>2007-08-17T03:40:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>786</o:Words>
  <o:Characters>4482</o:Characters>
  <o:Lines>37</o:Lines>
  <o:Paragraphs>10</o:Paragraphs>
  <o:CharactersWithSpaces>5258</o:CharactersWithSpaces>
  <o:Version>11.5606</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:GrammarState>Clean</w:GrammarState>
  <w:PunctuationKerning/>
  <w:DrawingGridVerticalSpacing>7.8 °õ</w:DrawingGridVerticalSpacing>
  <w:DisplayHorizontalDrawingGridEvery>0</w:DisplayHorizontalDrawingGridEvery>
  <w:DisplayVerticalDrawingGridEvery>2</w:DisplayVerticalDrawingGridEvery>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:Compatibility>
   <w:SpaceForUL/>
   <w:BalanceSingleByteDoubleByteWidth/>
   <w:DoNotLeaveBackslashAlone/>
   <w:ULTrailSpace/>
   <w:DoNotExpandShiftReturn/>
   <w:AdjustLineHeightInTable/>
   <w:BreakWrappedTables/>
   <w:SnapToGridInCell/>
   <w:WrapTextWithPunct/>
   <w:UseAsianBreakRules/>
   <w:DontGrowAutofit/>
   <w:UseFELayout/>
  </w:Compatibility>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" LatentStyleCount="156">
 </w:LatentStyles>
</xml><![endif]--><!--[if !mso]><object
 classid="clsid:38481807-CA0E-42D2-BF39-B33AF135CC4D" id=ieooui></object>
<style>
st1\:*{behavior:url(#ieooui) }
</style>
<![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:ËÎÌå;
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-alt:SimSun;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 135135232 16 0 262145 0;}
@font-face
	{font-family:"\@ËÎÌå";
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 135135232 16 0 262145 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	mso-pagination:none;
	font-size:10.5pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:ËÎÌå;
	mso-font-kerning:1.0pt;}
p.MsoDate, li.MsoDate, div.MsoDate
	{mso-style-next:ÕıÎÄ;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	mso-pagination:none;
	font-size:10.5pt;
	mso-bidi-font-size:10.0pt;
	font-family:ËÎÌå;
	mso-hansi-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:black;}
span.GramE
	{mso-style-name:"";
	mso-gram-e:yes;}
 /* Page Definitions */
 @page
	{mso-page-border-surround-header:no;
	mso-page-border-surround-footer:no;}
@page Section1
	{size:595.3pt 841.9pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;
	mso-header-margin:42.55pt;
	mso-footer-margin:49.6pt;
	mso-paper-source:0;
	layout-grid:15.6pt;}
div.Section1
	{page:Section1;}
 /* List Definitions */
 @list l0
	{mso-list-id:1056440674;
	mso-list-type:simple;
	mso-list-template-ids:-1919143702;}
@list l0:level1
	{mso-level-text:%1£®;
	mso-level-tab-stop:15.6pt;
	mso-level-number-position:left;
	margin-left:15.6pt;
	text-indent:-15.6pt;}
ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:ÆÕÍ¨±í¸ñ;
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
	mso-para-margin:0cm;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-ansi-language:#0400;
	mso-fareast-language:#0400;
	mso-bidi-language:#0400;}
</style>
<![endif]-->
</head>

<body lang=ZH-CN style='tab-interval:21.0pt;text-justify-trim:punctuation'>

<div class=Section1 style='layout-grid:15.6pt'>

<p class=MsoDate><st1:chsdate Year="1899" Month="12" Day="30"
IsLunarDate="False" IsROCDate="False" w:st="on"><span lang=EN-US>10.4.2</span></st1:chsdate><span
lang=EN-US> </span>´Ó°æ±¾<span lang=EN-US>2.0</span>µ½<span lang=EN-US>2.2</span>ÄÚºË<span
lang=EN-US>API</span>µÄ±ä»¯</p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>Óë<span lang=EN-US>Linux2.0</span>Ïà±È£¬<span lang=EN-US>2.2</span>ÔÚĞÔÄÜ¡¢×ÊÔ´µÄÀûÓÃ¡¢½¡×³ĞÔÒÔ¼°¿ÉÀ©Õ¹ĞÔµÈ·½ÃæÒÑ¾­ÓĞÁËºÜ´óµÄ¸ÄÉÆ£¬ÕâĞ©¸ÄÉÆÊÆ±Øµ¼ÖÂÄÚºË<span
lang=EN-US>API</span>µÄ±ä»¯¡£ËùÎ½ÄÚºË<span lang=EN-US>API</span>¾ÍÊÇÖ¸Îª½øĞĞÄÚºËÀ©Õ¹¶øÌá¹©µÄ±à³Ì½Ó¿Ú£¬ÄÚºËµÄ<span
class=GramE>±à³ÌÖ¸</span>±àĞ´Çı¶¯³ÌĞò¡¢ÎÄ¼şÏµÍ³¼°ÆäËûµÄÄÚºË´úÂë¡£ÓĞ¹ØÇı¶¯³ÌĞòµÄÄÚÈİÇë²Î¼ûÏÂÒ»ÕÂ¡£<span lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal align=left style='margin-left:15.6pt;text-align:left;
text-indent:-15.6pt;mso-list:l0 level1 lfo1;tab-stops:list 15.6pt;mso-layout-grid-align:
none;text-autospace:none'><![if !supportLists]><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:
ËÎÌå;color:black;mso-font-kerning:0pt'><span style='mso-list:Ignore'>1£®<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span></span></span><![endif]><span
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>ÓÃ»§¿Õ¼äÓëÄÚºË¿Õ¼äÖ®¼äÊı¾İµÄ¿½±´<span lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:20.4pt;
mso-layout-grid-align:none;text-autospace:none'><span style='font-family:ËÎÌå;
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>ÔçÔÚ<span
lang=EN-US>Linux2.1.x</span>°æ±¾Ê±£¬<span lang=EN-US>Liuns</span>¾ÍÌá³öÁËÒ»ÖÖÓĞĞ§µÄ°ì·¨À´¸ÄÉÆÄÚºË¿Õ¼äÓëÓÃ»§¿Õ¼äÖ®¼äÊı¾İµÄ¿½±´¡£ÎÒÃÇÖªµÀ£¬ÄÚºË¿Õ¼äÓëÓÃ»§¿Õ¼äÖ®¼äÊı¾İµÄ¿½±´ÒªÍ¨¹ıÒ»¸ö»º³åÇø£¬ÔÚÒÔÇ°µÄÄÚºËÖĞ£¬¶ÔÕâ¸ö»º³åÇøÓĞĞ§ĞÔµÄ¼ì²éÊÇÍ¨¹ı<span
lang=EN-US>verify_area()</span>º¯ÊıµÄ£¬Èç¹ûÕâ¸ö»º³åÇøÓĞĞ§£¬Ôòµ÷ÓÃ<span lang=EN-US>memcpy_tofs()</span>°ÑÊı¾İ´ÓÄÚºË¿Õ¼ä¿½±´µ½ÓÃ»§¿Õ¼ä¡£µ«ÊÇ£¬<span
lang=EN-US>verify_area()</span>º¯ÊıÊÇµÍĞ§µÄ£¬ÒòÎªËü±ØĞë¼ì²éÃ¿Ò»¸öÒ³Ãæ£¬¿´ÆäÊÇ·ñÊÇÒ»¸öÓĞĞ§µÄÓ³Éä¡£<span
lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:20.4pt;
mso-layout-grid-align:none;text-autospace:none'><span style='font-family:ËÎÌå;
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>ÔÚ<span
lang=EN-US>2.1.x</span>£¨ÒÔ¼°ºóÀ´µÄ°æ±¾£©ÖĞ£¬È¡ÏûÁË¶ÔÓÃ»§¿Õ¼ä»º³åÇøÃ¿¸öÒ³ÃæµÄ¼ì²é£¬È¡¶ø´úÖ®µÄÊÇÓÃÒì³£À´´¦Àí·Ç·¨µÄ»º³åÇø¡£Õâ¾Í±ÜÃâÁËÔÚ<span
lang=EN-US>SMP</span>ÉÏµÄ¾ºÕùÌõ¼ş¼°ÓĞĞ§ĞÔ¼ì²é¡£<span lang=EN-US>verify_area()</span>º¯ÊıÏÖÔÚ½ö½öÓÃÀ´¼ì²é»º³åÇøµÄ·¶Î§ÊÇ·ñºÏ·¨£¬ÕâÊÇÒ»¸ö¿ìËÙµÄ²Ù×÷¡£<span
lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp; </span></span><span style='font-family:
ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>Òò´Ë£¬Èç¹ûÄãÒª°ÑÊı¾İ¿½±´µ½ÓÃ»§¿Õ¼ä£¬¾ÍÊ¹ÓÃ<span
lang=EN-US>copy_to_user()</span>º¯Êı£¬ÆäÓÃ·¨ÈçÏÂ£º<span lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span style='mso-tab-count:
1'>&nbsp;&nbsp;&nbsp; </span><span class=GramE>if</span> ( copy_to_user (ubuff,
kbuff, length) ) return -EFAULT;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp; </span></span><span style='font-family:
ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>ÕâÀï£¬<span
lang=EN-US>ubuff</span>ÊÇÓÃ»§¿Õ¼äµÄ»º³åÇø£¬<span lang=EN-US>kbuff</span>ÊÇÄÚºË¿Õ¼äµÄ»º³åÇø£¬¶ø<span
lang=EN-US>length</span>ÊÇÒª¿½±´µÄ×Ö½ÚÊı¡£Èç¹û<span lang=EN-US>copy_to_user()</span>º¯Êı·µ»ØÒ»¸ö·Ç<span
lang=EN-US>0</span>Öµ£¬¾ÍÒâÎ¶×ÅÄ³Ğ©Êı¾İÃ»ÓĞ±»¿½±´£¨ÓÉÓÚÎŞĞ§µÄ»º³åÇø£©¡£ÔÚÕâÖÖÇé¿öÏÂ£¬·µ»Ø<span lang=EN-US>-EFAULT</span>ÒÔ±íÊ¾»º³åÇøÊÇÎŞĞ§µÄ¡£ÀàËÆµØ£¬´ÓÓÃ»§¿Õ¼ä¿½±´µ½ÄÚºË¿Õ¼äµÄÓÃ·¨ÈçÏÂ£º<span
lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span style='mso-tab-count:
1'>&nbsp;&nbsp;&nbsp; </span><span class=GramE>if</span> ( copy_from_user
(kbuff, ubuff, length) ) return -EFAULT;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp; </span></span><span style='font-family:ËÎÌå;
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>×¢Òâ£¬ÕâÁ½¸öº¯Êı¶¼×Ô¶¯µ÷ÓÃ<span
lang=EN-US>verify_area()</span>º¯Êı£¬ÄãÃ»±ØÒª×Ô¼ºµ÷ÓÃËü¡£<span lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'>2</span><span
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>£® ÎÄ¼ş²Ù×÷µÄ·½·¨<span lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span></span><span
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>ÔÚÄÚºË<st1:chsdate Year="1899" Month="12" Day="30"
IsLunarDate="False" IsROCDate="False" w:st="on"><span lang=EN-US>2.1.42</span></st1:chsdate>°æ±¾ÒÔºó£¬Ôö¼ÓÁËÒ»¸öÄ¿Â¼¸ßËÙ»º´æ£¨<span
lang=EN-US>dcache</span>£©²ã£¬Õâ¸ö²ã¼ÓËÙÁËÄ¿Â¼ËÑË÷²Ù×÷£¨´óÔ¼ÄÜÌá¸ß<span lang=EN-US>4</span>±¶£©£¬µ«Í¬Ê±Ò²ĞèÒª¸Ä±äÎÄ¼ş²Ù×÷½Ó¿Ú¡£¶ÔÇı¶¯³ÌĞòµÄ±àĞ´Õß£¬Õâ¸ö±ä»¯Ïà¶Ô±È½Ï¼òµ¥£ºÔ­À´´«µİ¸ø<span
lang=EN-US>file_operations</span>Ä³Ğ©·½·¨µÄ²ÎÊıÎª<span lang=EN-US>struct inode *</span>£¬ÏÖÔÚ¸ÄÎª<span
lang=EN-US>struct dentry *</span>¡£Èç¹ûÄãµÄÇı¶¯³ÌĞòÒªÒıÓÃ<span lang=EN-US>inode</span>£¬ÏÂÃæ´úÂë¾Í×ã¹»ÁË£º<span
lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span style='mso-tab-count:
1'>&nbsp;&nbsp;&nbsp; </span><span class=GramE>struct</span> inode *inode =
dentry-&gt;d_inode;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp; </span></span><span style='font-family:
ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>¼Ù¶¨<span
lang=EN-US>dentry</span>ÊÇÄ¿Â¼ÏîµÄ±äÁ¿Ãû¡£Êµ¼ÊÉÏ£¬ÓĞĞ©Çı¶¯³ÌĞò¾Í²»Éæ¼°<span lang=EN-US>inode</span>£¬Òò´Ë¿ÉºöÂÔÕâÒ»²½¡£È»¶ø£¬Äã±ØĞë¸Ä±äµÄÊÇ£¬ÖØĞÂÉùÃ÷<span
lang=EN-US>file_operations</span>ÖĞµÄº¯Êı¡£×¢Òâ£¬Ä³Ğ©·½·¨»¹ÊÇ°Ñ<span lang=EN-US>inode</span>¶ø²»ÊÇ<span
lang=EN-US>dentry</span>×÷Îª²ÎÊıÀ´´«µİ¡£<span lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp; </span></span><span style='font-family:
ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>ÓĞĞ©·½·¨ÉõÖÁÃ»ÓĞÌá¹©<span
lang=EN-US>dentry</span>£¬½ö½öÌá¹©ÁË<span lang=EN-US>struct file *</span>£¬ÔÚÕâÖÖÇé¿öÏÂ£¬Äã¿ÉÒÔÓÃÏÂÃæµÄ´úÂëÌáÈ¡³ö<span
lang=EN-US>dentry</span>£º<span lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span style='mso-tab-count:
1'>&nbsp;&nbsp;&nbsp; </span><span class=GramE>struct</span> dentry *dentry =
file-&gt;f_dentry;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span></span><span
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>¼Ù¶¨<span lang=EN-US>file</span>ÊÇÖ¸Ïò<span lang=EN-US>file</span>Ö¸ÕëµÄ±äÁ¿Ãû¡£<span
lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span></span><span
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>ÏÂÃæÊÇÄÚºË<span lang=EN-US>2.2.x</span>ÎÄ¼ş²Ù×÷µÄ·½·¨£º<span
lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span class=GramE>loff_t</span>
llseek (struct file *, loff_t, int);<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span class=GramE>ssize_t</span>
read (struct file *, char *, size_t, loff_t *);<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span class=GramE>ssize_t</span>
write (struct file *, const char *, size_t, loff_t *);<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span class=GramE>int</span>
readdir (struct file *, void *, filldir_t);<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span class=GramE>unsigned</span>
int poll (struct file *, struct poll_table_struct *);<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span class=GramE>int</span>
ioctl (struct inode *, struct file *, unsigned int, unsigned long);<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span class=GramE>int</span>
mmap (struct file *, struct vm_area_struct *);<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span class=GramE>int</span>
open (struct inode *, struct file *);<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span class=GramE>int</span>
flush (struct file *);<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span class=GramE>int</span>
release (struct inode *, struct file *);<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span class=GramE>int</span>
fsync (struct file *, struct dentry *);<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span class=GramE>int</span>
fasync (int, struct file *, int);<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span class=GramE>int</span>
check_media_change (kdev_t dev);<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span class=GramE>int</span>
revalidate (kdev_t dev);<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span class=GramE>int</span>
lock (struct file *, int, struct file_lock *);<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span></span><span
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>ÔÚÄãÉùÃ÷×Ô¼ºµÄ<span lang=EN-US>file_operations</span>½á¹¹Ê±£¬Ó¦µ±È·±£°Ñ×Ô¼ºµÄ·½·¨·ÅÖÃÔÚÓëÉÏÃæÒ»ÖÂµÄÎ»ÖÃ¡£²»¹ı£¬»¹ÓĞÁíÍâÒ»ÖÖÎÒÃÇÌáµ½¹ıµÄ·½·¨£¬ÆäĞÎÊ½ÈçÏÂ£º<span
lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span class=GramE><span lang=EN-US style='font-family:
ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>static</span></span><span
lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black;mso-font-kerning:0pt'> struct file_operations mydev_fops = {<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span style='mso-tab-count:
1'>&nbsp;&nbsp;&nbsp; </span><span class=GramE>open</span>:<span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>mydev_open,<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span style='mso-tab-count:
1'>&nbsp;&nbsp;&nbsp; </span><span class=GramE>release</span>: mydev_close,<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span style='mso-tab-count:
1'>&nbsp;&nbsp;&nbsp; </span><span class=GramE>read</span>:<span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>mydev_read,<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span style='mso-tab-count:
1'>&nbsp;&nbsp;&nbsp; </span><span class=GramE>write</span>:<span
style='mso-spacerun:yes'>&nbsp;&nbsp; </span>mydev_write,<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'>};<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp; </span>gcc</span><span style='font-family:ËÎÌå;
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>±àÒë³ÌĞòÄÜ¹»°ÑÕâĞ©·½·¨·ÅÔÚÕıÈ·µÄÎ»ÖÃ£¬²¢°ÑÎ´¶¨ÒåµÄ·½·¨ÖÃÎª<span
lang=EN-US>NULL</span>¡£<span lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp; </span></span><span style='font-family:ËÎÌå;
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>ÁíÍâ»¹ÖµµÃ×¢ÒâµÄÊÇ£¬<span
lang=EN-US>Linux2.2</span>ÖĞÒıÈëÁË<span lang=EN-US>pread() </span>ºÍ<span
lang=EN-US>pwrite()</span>ÏµÍ³µ÷ÓÃ£¬Õâ¾ÍÔÊĞí½ø³Ì¿ÉÒÔ´ÓÒ»¸öÎÄ¼şµÄÖ¸¶¨Î»ÖÃ½øĞĞ¶ÁºÍĞ´£¬ÕâÓëÁíÒ»¸ö<span lang=EN-US>lseek()</span>ÏµÍ³µ÷ÓÃÀàËÆµ«²»ÍêÈ«ÏàÍ¬¡£Æä²»Í¬Ö®´¦ÊÇ£¬<span
lang=EN-US>pread() </span>ºÍ<span lang=EN-US>pwrite()</span>ÏµÍ³µ÷ÓÃÄÜ¶ÔÒ»¸öÎÄ¼ş½øĞĞ²¢·¢·ÃÎÊ¡£ÎªÁË¶ÔÕâĞ©ĞÂµÄÏµÍ³µ÷ÓÃ½øĞĞÖ§³Ö£¬ÔÚ<span
lang=EN-US>read()</span>ºÍ<span lang=EN-US>write()</span>·½·¨ÖĞÔö¼ÓÁËµÚ<span
lang=EN-US>4</span>¸ö£¨»ò×îºóÒ»¸ö£©²ÎÊı£¬Õâ¸ö²ÎÊıÊÇÖ¸Ïò<span lang=EN-US>offset</span>µÄÒ»¸öÖ¸Õë¡£×÷ÎªÇı¶¯³ÌĞòµÄ±àĞ´Õß£¬Äã²»±Ø¹ØĞÄÎÄ¼şµÄÎ»ÖÃ£¬Òò´Ë¿ÉÒÔºöÂÔÕâ¸ö²ÎÊı¡£²»¹ı£¬ÎªÁËÕıÈ·ĞÔÆÚ¼ä£¬Äã×îºÃÔÚÄãµÄÇı¶¯³ÌĞòÖĞ±ÜÃâÊ¹ÓÃĞÂµÄÏµÍ³µ÷ÓÃ£¬¾ÍÏñÄã²»±ØÖ§³Ö<span
lang=EN-US>llseek()</span>·½·¨Ò»Ñù£¬ÄãÒ²¿ÉÒÔÔÚ<span lang=EN-US>read()</span>ºÍ<span
lang=EN-US>write()</span>·½·¨µÄ×î¶¥ĞĞÔö¼ÓÈçÏÂĞĞÀ´±ÜÃâĞÂ¾ÉÏµÍ³µ÷ÓÃµÄ²îÒì£º<span lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span style='mso-tab-count:
1'>&nbsp;&nbsp;&nbsp; </span><span class=GramE>if</span> (ppos !=
&amp;file-&gt;f_pos) return </span><span lang=EN-US style='mso-ascii-font-family:
ËÎÌå;color:black;mso-font-kerning:0pt'>¨C</span><span lang=EN-US style='font-family:
ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>ESPIPE<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:20.4pt;
mso-layout-grid-align:none;text-autospace:none'><span style='font-family:ËÎÌå;
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>¼Ù¶¨<span
lang=EN-US>ppos</span>ÊÇÖ¸Ïò<span lang=EN-US>offset</span>Ö¸ÕëµÄ±äÁ¿Ãû£¬<span lang=EN-US>file</span>ÊÇÖ¸Ïò<span
lang=EN-US>struct file</span>½á¹¹µÄ±äÁ¿Ãû¡£¶ÔÓÚ<span lang=EN-US>read() </span>ºÍ<span
lang=EN-US>write()</span>ÏµÍ³µ÷ÓÃ£¬´«µİ¸ø²ÎÊı<span lang=EN-US>offset</span>µÄÎª<span
lang=EN-US>file-&gt;f_pos</span>µÄµØÖ·£¬¶ø¶ÔÓÚ<span lang=EN-US>pread() </span>ºÍ<span
lang=EN-US>pwrite()</span>ÏµÍ³µ÷ÓÃ£¬´«µİ¸ø<span lang=EN-US>offset</span>µÄÎª<span
lang=EN-US>ppos</span>µÄµØÖ·£¬ÓÉ´Ë¿ÉÒÔºÜÈİÒ×µØÇø±ğÕâÖÖÁ½ÖÖÇé¿ö¡£<span lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:20.4pt;
mso-layout-grid-align:none;text-autospace:none'><span style='font-family:ËÎÌå;
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>Èç¹ûÄãÈ·Êµ¹ØĞÄÎÄ¼şµÄÎ»ÖÃ£¬ÄÇ¾Í±ØĞëÊ¹ÓÃºÍ¸üĞÂÓÉ<span
lang=EN-US>ppos</span>ËùÖ¸ÏòµÄÖµ£¬ÒÔ¸ú×Ù½ø³ÌÕı¶ÁÔÚºÎ´¦¡£<span lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'>3</span><span
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>£® ĞÅºÅµÄ´¦Àí<span lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp; </span></span><span style='font-family:ËÎÌå;
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>ĞÂÔö¼ÓµÄ<span
lang=EN-US>signal_pending()</span>º¯ÊıÊ±µÄĞÅºÅµÄ´¦Àí¸ü¼ÓÈİÒ×ºÍ½¡×³¡£<span lang=EN-US>2.0</span>´¦Àí·½Ê½ÊÇ<span
lang=EN-US>:<o:p></o:p></span></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span style='mso-tab-count:
1'>&nbsp;&nbsp;&nbsp; </span><span class=GramE>if</span> (current-&gt;signal
&amp; ~current-&gt;blocked)<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp; </span>2.2</span><span style='font-family:ËÎÌå;
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>ÊÇ<span
lang=EN-US>:<o:p></o:p></span></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span style='mso-tab-count:
1'>&nbsp;&nbsp;&nbsp; </span><span class=GramE>if</span> ( signal_pending
(current) )<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'>4</span><span
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>£®<span lang=EN-US> I/O</span>¿Õ¼äÓ³Éä<span lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:20.4pt;
mso-layout-grid-align:none;text-autospace:none'><span style='font-family:ËÎÌå;
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>ÈÎºÎÏµÍ³¶¼»áÓĞÊäÈëÊä³ö<span
lang=EN-US>,</span>Òò´Ë¾Í»áÉæ¼°¶ÔÍâ²¿Éè±¸µÄ·ÃÎÊ¡£ÔÚÔçÆÚµÄ¼ÆËã»úÖĞ£¬ÍâÉèÍ¨³£Ö»ÓĞ¼¸¸ö¼Ä´æÆ÷£¬Í¨¹ıÕâ¼¸¸ö¼Ä´æÆ÷¾Í¿ÉÒÔÍê³É¶ÔÍâÉèµÄËùÓĞ²Ù×÷¡£¶øÏÖÔÚµÄÇé¿öÔò´ó²»Ò»Ñù£¬ÍâÉèÍ¨³£×Ô´ø¼¸<span
lang=EN-US>MB</span>µÄ´æ´¢Æ÷£¬´Ó×Ô<span lang=EN-US>PCI</span>×ÜÏß³öÏÖÒÔºó£¬¸üÊÇÈç´Ë¡£ËùÒÔ£¬±ØĞë½«ÍâÉè¿¨ÉÏµÄ´æ´¢Æ÷Ó³Éäµ½ÄÚ´æ¿Õ¼ä£¬Êµ¼ÊÉÏÊÇĞé´æ¿Õ¼ä£¨<span
lang=EN-US>3GB</span>ÒÔÉÏ£©¡£ÔÚÒÔÇ°µÄ<span lang=EN-US>Linux</span>ÄÚºË°æ±¾ÖĞ£¬ÕâÑùµÄÓ³ÉäÊÇÍ¨¹ı<span
lang=EN-US>vremap</span>£¨£©½¨Á¢µÄ£¬ÏÖÔÚ¸ÄÃûÎª<span lang=EN-US>ioremap(),</span>ÒÔ¸üÈ·ÇĞµØ·´Ó³ÆäÕæÕıµÄÒâÍ¼¡£<span
lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'>5</span><span
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>£®<span lang=EN-US> I/O</span>ÊÂ¼şµÄ¶àÂ·¼¼Êõ<span lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>select() </span><span
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>ºÍ<span lang=EN-US> poll()</span>ÏµÍ³µ÷ÓÃ¿ÉÒÔÈÃÒ»¸ö½ø³ÌÍ¬Ê±´¦Àí¶à¸öÎÄ¼şÃèÊö·û£¬Ò²¾ÍÊÇËµ¿ÉÒÔÊ¹½ø³Ì¼ì²âÍ¬Ê±µÈ´ıµÄ¶à¸ö<span
lang=EN-US>I/O</span>Éè±¸£¬µ±Ã»ÓĞÉè±¸×¼±¸ºÃÊ±£¬<span lang=EN-US>select()</span>×èÈû£¬ÆäÖĞÈÎ<span
class=GramE>Ò»</span>Éè±¸×¼±¸ºÃÊ±£¬<span lang=EN-US>select()</span>¾Í·µ»Ø¡£ÔÚ<span
lang=EN-US>Linux2.0</span>ÖĞ£¬Çı¶¯³ÌĞòÍ¨¹ıÔÚ<span lang=EN-US>file_operations</span>½á¹¹ÖĞÌá¹©<span
lang=EN-US>select()</span>·½·¨À´Ö§³ÖÕâÖÖ¼¼Êõ£¬¶øÔÚ<span lang=EN-US>2.2</span>ÖĞ£¬Çı¶¯³ÌĞò±ØĞëÌá¹©µÄÊÇ<span
lang=EN-US>poll()</span>·½·¨£¬ÕâÖÖ·½·¨¾ßÓĞ¸ü´óµÄÁé»îĞÔ¡£<span lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'>6</span><span
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>£®¶ªÆú³õÊ¼»¯º¯ÊıºÍÊı¾İ<span lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp; </span></span><span style='font-family:
ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>µ±ÄÚºË³õÊ¼»¯È«²¿Íê³ÉÒÔºó£¬¾Í¿ÉÒÔ¶ªÆúÒÔºó²»ÔÙĞèÒªµÄº¯ÊıºÍÊı¾İ£¬ÕâÒâÎ¶×Å´æ·ÅÕâĞ©º¯ÊıºÍÊı¾İµÄÄÚ´æ¿ÉÒÔÖØĞÂµÃµ½Ê¹ÓÃ¡£µ«Õâ½ö½öÓ¦ÓÃÔÚ±àÒë½øÄÚºËµÄÇı¶¯³ÌĞò£¬¶ø<span
class=GramE>²»</span>ÊÊºÏÓÚ¿É°²×°Ä£¿é¡£<span lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:20.4pt;
mso-layout-grid-align:none;text-autospace:none'><span style='font-family:ËÎÌå;
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>¶¨ÒåÒ»¸öÒÔºóÒª¶ªÆúµÄ±äÁ¿µÄĞÎÊ½Îª£º<span
lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:20.4pt;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt;
mso-layout-grid-align:none;text-autospace:none'><span class=GramE><span
lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black;mso-font-kerning:0pt'>static</span></span><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'> int mydata __initdata = 0;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:20.4pt;
mso-layout-grid-align:none;text-autospace:none'><span style='font-family:ËÎÌå;
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>¶¨ÒåÒ»¸öÒÔºóÒª¶ªÆúµÄº¯ÊıµÄĞÎÊ½Îª£º<span
lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:20.4pt;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>__<span class=GramE>initfunc(</span>void
myfunc (void))<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt;
mso-layout-grid-align:none;text-autospace:none'><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>__initdata </span><span style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'>ºÍ<span lang=EN-US>
__initfunc</span>¹Ø¼ü×Ö°Ñ´úÂëºÍÊı¾İ·ÅÔÚÒ»¸öÌØÊâµÄ¡°³õÊ¼»¯¡±Çø¶Î¡£½ÏÀíÏëµÄ×ö·¨Ó¦µ±ÊÇ£¬¾¡¿ÉÄÜµØ°Ñ¸ü¶àµÄ´úÂëºÍÊı¾İ·ÅÔÚ³õÊ¼»¯Çø¶Î£¬µ±È»£¬ÕâÀïµÄ´úÂëºÍÊı¾İÖ¸µÄÊÇ³õÊ¼»¯ÒÔºó£¨µ±<span
lang=EN-US>init</span>½ø³ÌÆô¶¯Ê±£©²»ÔÙÊ¹ÓÃµÄ¡£<span lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'>7</span><span
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>£®¶¨Ê±µÄÉè¶¨<span lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>ĞÂÔö¼ÓÁËÒ»Ğ©¶¨Ê±Éè¶¨º¯Êı¡£<span lang=EN-US>2.0</span>Éè¶¨<span
class=GramE>¶¨Ê±ÊÇ</span>ÕâÑùµÄ£º<span lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span style='mso-tab-count:
1'>&nbsp;&nbsp;&nbsp; </span><span style='mso-spacerun:yes'>&nbsp; </span><span
class=GramE>current</span>-&gt;timeout = jiffies + timeout;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span style='mso-tab-count:
1'>&nbsp;&nbsp;&nbsp; </span><span style='mso-spacerun:yes'>&nbsp; </span><span
class=GramE>schedule</span> ();<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>2.2</span><span
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>ÊÇ£º<span lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span style='mso-tab-count:
1'>&nbsp;&nbsp;&nbsp; </span><span class=GramE>timeout</span> =
schedule_timeout (timeout);<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span></span><span
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>Í¬Àí£¬Èç¹ûÄãĞèÒªÔÚÒ»¸öµÈ´ı¶ÓÁĞÉÏË¯Ãß£¬µ«ĞèÒª¶¨Ê±£¬<span lang=EN-US>2.0</span>²Ù×÷ÊÇ£º<span
lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span style='mso-tab-count:
1'>&nbsp;&nbsp;&nbsp; </span><span style='mso-spacerun:yes'>&nbsp;</span><span
class=GramE>current</span>-&gt;timeout = jiffies + timeout;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span style='mso-tab-count:
1'>&nbsp;&nbsp;&nbsp; </span><span style='mso-spacerun:yes'>&nbsp;</span>interruptible_sleep_on
(&amp;wait);<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp; </span>2.2</span><span style='font-family:
ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>ÊÇ£º<span
lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span style='mso-tab-count:
1'>&nbsp;&nbsp;&nbsp; </span><span class=GramE>timeout</span> =
interruptible_sleep_on_timeout (&amp;wait, timeout);<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:20.4pt;
mso-layout-grid-align:none;text-autospace:none'><span style='font-family:ËÎÌå;
mso-hansi-font-family:"Times New Roman";color:black;mso-font-kerning:0pt'>×¢Òâ£¬ÕâĞ©ĞÂº¯Êı·µ»ØµÄÊÇÊ£ÓàÊ±¼äµÄ¶àÉÙ¡£ÔÚÄ³Ğ©Çé¿öÏÂ£¬ÕâĞ©º¯ÊıÔÚ¶¨Ê±Ê±¼ä»¹Ã»µ½¾Í·µ»Ø¡£<span
lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'>8</span><span
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>£®Ïòºó¼æÈİµÄºê<span lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span></span><span
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black;
mso-font-kerning:0pt'>Äã¿ÉÒÔ°ÑÏÂÃæµÄ´úÂë°üº¬½ø×Ô¼º±àĞ´µÄ´úÂëÖĞ£¬ÕâÑù¾Í²»±Ø·ÑÉñÎ¬»¤ÊÇÎª<span lang=EN-US>Linux2.2.x
</span>»¹ÊÇÎª<span lang=EN-US> 2.0.x</span>Ëù±àÒëµÄÇı¶¯³ÌĞò¡£<span lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>#include
&lt;linux/version.h&gt;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>#ifndef KERNEL_VERSION<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span class=GramE>#<span
style='mso-spacerun:yes'>&nbsp; </span>define</span> KERNEL_VERSION(a,b,c)
(((a) &lt;&lt; 16) + ((b) &lt;&lt; 8) + (c)<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>#endif<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>#if (LINUX_VERSION_CODE &lt;
KERNEL_<span class=GramE>VERSION(</span>2,1,0))<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span class=GramE>#<span
style='mso-spacerun:yes'>&nbsp; </span>include</span> &lt;linux/mm.h&gt;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span class=GramE>static</span>
inline unsigned long copy_to_user (void *to, const void *from,<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span style='mso-tab-count:
5'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='mso-spacerun:yes'>&nbsp; </span><span class=GramE>unsigned</span> long
n)<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=GramE>if</span>
( !verify_area (VERIFY_WRITE, to, n) ) return n;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;</span>memcpy_tofs (to, from,
n);<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;</span><span
style='mso-spacerun:yes'>&nbsp;</span><span class=GramE>return</span> 0;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=GramE>static</span>
inline unsigned long copy_from_user (void *to, const void *from,<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span style='mso-tab-count:
5'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span class=GramE>unsigned</span>
long n)<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span
class=GramE>if</span> ( !verify_area (VERIFY_READ, from, n) ) return n;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>memcpy_fromfs
(to, from, n);<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span
class=GramE>return</span> 0;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp; </span><span
style='mso-spacerun:yes'>&nbsp;</span><span class=GramE>#<span
style='mso-spacerun:yes'>&nbsp; </span>define</span> __initdata<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span class=GramE>#<span
style='mso-spacerun:yes'>&nbsp; </span>define</span> __initfunc(func) func<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>#else<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span class=GramE>#<span
style='mso-spacerun:yes'>&nbsp; </span>include</span> &lt;asm/uaccess.h&gt;<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>#endif<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>#ifndef signal_pending<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span class=GramE>#<span
style='mso-spacerun:yes'>&nbsp; </span>define</span> signal_pending(p) (
(p)-&gt;signal &amp; ~(p)-&gt;blocked )<o:p></o:p></span></p>

<p class=MsoNormal align=left style='text-align:left;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-font-kerning:0pt'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>#endif<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

</div>

</body>


<!-- Mirrored from www.kerneltravel.net/kernel-book/ç¬¬åç« %20æ¨¡å—æœºåˆ¶/10.4.2.htm by HTTrack Website Copier/3.x [XR&CO'2008], Sat, 29 Dec 2012 03:01:28 GMT -->
</html>
