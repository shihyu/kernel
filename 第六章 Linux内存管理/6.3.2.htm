<html xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:st1="urn:schemas-microsoft-com:office:smarttags"
xmlns="http://www.w3.org/TR/REC-html40">


<!-- Mirrored from www.kerneltravel.net/kernel-book/ç¬¬å…­ç« %20Linuxå†…å­˜ç®¡ç†/6.3.2.htm by HTTrack Website Copier/3.x [XR&CO'2008], Sat, 29 Dec 2012 03:00:39 GMT -->
<head>
<meta http-equiv=Content-Type content="text/html; charset=gb2312">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 11">
<meta name=Originator content="Microsoft Word 11">
<link rel=File-List href="6.3.2.files/filelist.html">
<title>ÎïÀíÒ³ÃæµÄ·ÖÅäºÍÊÍ·Å</title>
<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="chsdate" downloadurl=""/>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>CLJ</o:Author>
  <o:Template>Normal</o:Template>
  <o:LastAuthor>CLJ</o:LastAuthor>
  <o:Revision>2</o:Revision>
  <o:TotalTime>1</o:TotalTime>
  <o:Created>2007-08-15T07:53:00Z</o:Created>
  <o:LastSaved>2007-08-15T07:53:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>1663</o:Words>
  <o:Characters>9483</o:Characters>
  <o:Lines>79</o:Lines>
  <o:Paragraphs>22</o:Paragraphs>
  <o:CharactersWithSpaces>11124</o:CharactersWithSpaces>
  <o:Version>11.5606</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:PunctuationKerning/>
  <w:DrawingGridVerticalSpacing>7.8 °õ</w:DrawingGridVerticalSpacing>
  <w:DisplayHorizontalDrawingGridEvery>0</w:DisplayHorizontalDrawingGridEvery>
  <w:DisplayVerticalDrawingGridEvery>2</w:DisplayVerticalDrawingGridEvery>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:Compatibility>
   <w:SpaceForUL/>
   <w:BalanceSingleByteDoubleByteWidth/>
   <w:DoNotLeaveBackslashAlone/>
   <w:ULTrailSpace/>
   <w:DoNotExpandShiftReturn/>
   <w:AdjustLineHeightInTable/>
   <w:BreakWrappedTables/>
   <w:SnapToGridInCell/>
   <w:WrapTextWithPunct/>
   <w:UseAsianBreakRules/>
   <w:DontGrowAutofit/>
   <w:UseFELayout/>
  </w:Compatibility>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" LatentStyleCount="156">
 </w:LatentStyles>
</xml><![endif]--><!--[if !mso]><object
 classid="clsid:38481807-CA0E-42D2-BF39-B33AF135CC4D" id=ieooui></object>
<style>
st1\:*{behavior:url(#ieooui) }
</style>
<![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:ËÎÌå;
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-alt:SimSun;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 135135232 16 0 262145 0;}
@font-face
	{font-family:"\@ËÎÌå";
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 135135232 16 0 262145 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	mso-pagination:none;
	font-size:10.5pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:ËÎÌå;
	mso-font-kerning:1.0pt;}
 /* Page Definitions */
 @page
	{mso-page-border-surround-header:no;
	mso-page-border-surround-footer:no;}
@page Section1
	{size:595.3pt 841.9pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;
	mso-header-margin:42.55pt;
	mso-footer-margin:49.6pt;
	mso-paper-source:0;
	layout-grid:15.6pt;}
div.Section1
	{page:Section1;}
 /* List Definitions */
 @list l0
	{mso-list-id:861896230;
	mso-list-type:simple;
	mso-list-template-ids:1937021516;}
@list l0:level1
	{mso-level-number-format:bullet;
	mso-level-text:¡¤;
	mso-level-tab-stop:21.25pt;
	mso-level-number-position:left;
	margin-left:21.25pt;
	text-indent:-21.25pt;
	font-family:ËÎÌå;
	mso-hansi-font-family:Wingdings;}
@list l1
	{mso-list-id:1187405160;
	mso-list-type:simple;
	mso-list-template-ids:1937021516;}
@list l1:level1
	{mso-level-number-format:bullet;
	mso-level-text:¡¤;
	mso-level-tab-stop:21.25pt;
	mso-level-number-position:left;
	margin-left:21.25pt;
	text-indent:-21.25pt;
	font-family:ËÎÌå;
	mso-hansi-font-family:Wingdings;}
@list l2
	{mso-list-id:1196819321;
	mso-list-type:simple;
	mso-list-template-ids:1937021516;}
@list l2:level1
	{mso-level-number-format:bullet;
	mso-level-text:¡¤;
	mso-level-tab-stop:21.25pt;
	mso-level-number-position:left;
	margin-left:21.25pt;
	text-indent:-21.25pt;
	font-family:ËÎÌå;
	mso-hansi-font-family:Wingdings;}
@list l3
	{mso-list-id:1301349959;
	mso-list-type:simple;
	mso-list-template-ids:1937021516;}
@list l3:level1
	{mso-level-number-format:bullet;
	mso-level-text:¡¤;
	mso-level-tab-stop:21.25pt;
	mso-level-number-position:left;
	margin-left:21.25pt;
	text-indent:-21.25pt;
	font-family:ËÎÌå;
	mso-hansi-font-family:Wingdings;}
@list l4
	{mso-list-id:1889341005;
	mso-list-type:simple;
	mso-list-template-ids:1937021516;}
@list l4:level1
	{mso-level-number-format:bullet;
	mso-level-text:¡¤;
	mso-level-tab-stop:21.25pt;
	mso-level-number-position:left;
	margin-left:21.25pt;
	text-indent:-21.25pt;
	font-family:ËÎÌå;
	mso-hansi-font-family:Wingdings;}
ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:ÆÕÍ¨±í¸ñ;
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
	mso-para-margin:0cm;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-ansi-language:#0400;
	mso-fareast-language:#0400;
	mso-bidi-language:#0400;}
</style>
<![endif]-->
</head>

<body lang=ZH-CN style='tab-interval:21.0pt;text-justify-trim:punctuation'>

<div class=Section1 style='layout-grid:15.6pt'>

<p class=MsoNormal style='mso-outline-level:1'><st1:chsdate Year="1899"
Month="12" Day="30" IsLunarDate="False" IsROCDate="False" w:st="on"><span
 lang=EN-US>6.3.2</span></st1:chsdate><span lang=EN-US> </span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>ÎïÀíÒ³ÃæµÄ·ÖÅäºÍÊÍ·Å</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>µ±Ò»¸ö½ø³ÌÇëÇó·ÖÅäÁ¬ĞøµÄÎïÀíÒ³ÃæÊ±£¬¿ÉÒÔÍ¨¹ıµ÷ÓÃ</span><span lang=EN-US>alloc_pages()</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>À´Íê³É¡£</span><span lang=EN-US>Linux2.4</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>°æ±¾ÖĞÓĞÁ½¸ö</span><span lang=EN-US>alloc_pages()<span
style='mso-tab-count:1'> </span></span><span style='font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>£¬Ò»¸öÔÚ</span><span
lang=EN-US>mm/numa.c</span><span style='font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>ÖĞ£¬ÁíÒ»¸öÔÚ</span><span
lang=EN-US>mm/page_alloc,c</span><span style='font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>ÖĞ</span><span
lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>£¬±àÒëÊ±¸ù¾İËù¶¨ÒåµÄÌõ¼şÑ¡Ïî</span><span lang=EN-US>CONFIG_DISCONTIGMEM</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>À´½øĞĞÈ¡Éá¡£</span></p>

<p class=MsoNormal style='mso-outline-level:1'><span lang=EN-US>1</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>£®·ÇÒ»ÖÂ´æ´¢½á¹¹£¨</span><span lang=EN-US>NUMA</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>£©ÖĞÒ³ÃæµÄ·ÖÅä¡£</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US>CONFIG_DISCONTIGMEM</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>Ìõ¼ş±àÒëµÄº¬ÒåÊÇ¡°²»Á¬ĞøµÄ´æ´¢¿Õ¼ä¡±£¬</span><span lang=EN-US>Linux</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>°Ñ²»Á¬ĞøµÄ´æ´¢¿Õ¼äÒ²¹éÀàÎª·ÇÒ»ÖÂ´æ´¢½á¹¹£¨</span><span lang=EN-US>NUMA</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>£©¡£ÕâÊÇÒòÎª£¬²»Á¬ĞøµÄ´æ´¢¿Õ¼ä±¾ÖÊÉÏÊÇÒ»ÖÖ¹ãÒåµÄ</span><span lang=EN-US>NUMA</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>£¬ÒòÎªÄÇËµÃ÷ÔÚ×îµÍÎïÀíµØÖ·ºÍ×î¸ßÎïÀíµØÖ·Ö®¼ä´æÔÚ×Å¿Õ¶´£¬¶øÓĞ¿Õ¶´µÄ¿Õ¼äµ±È»ÊÇ¡°²»Ò»ÖÂ¡±µÄ¡£ËùÒÔ£¬ÔÚµØÖ·²»Á¬ĞøµÄÎïÀí¿Õ¼äÒ²ÒªÏñ½á¹¹²»Ò»ÑùµÄÎïÀí¿Õ¼äÄÇÑù»®·Ö³öÈô¸ÉÁ¬ĞøÇÒ¾ùÔÈµÄ¡°½Úµã¡±¡£Òò´Ë£¬ÔÚ´æ´¢½á¹¹²»Á¬ĞøµÄÏµÍ³ÖĞ£¬Ã¿¸öÄ£¿é¶¼ÓÉÈô¸É¸ö½Úµã£¬Òò¶ø¶¼ÓĞ¸ö</span><span
lang=EN-US>pg_data_t</span><span style='font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>Êı¾İ½á¹¹¶ÓÁĞ¡£</span><span
lang=EN-US><span style='mso-tab-count:1'>&nbsp; </span></span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>ÎÒÃÇÏÈÀ´¿´</span><span lang=EN-US>mm/numa.c</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>ÖĞµÄ</span><span lang=EN-US>alloc_page()</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>º¯Êı£º</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US>/*</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp; </span>* This can be refined. Currently, tries
to do round robin, instead</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp; </span>* should do concentratic circle search,
starting from current node.</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp; </span>*/</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US>struct page *
_alloc_pages(unsigned int gfp_mask, unsigned int order)</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US>{</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>struct page *ret = 0;</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>pg_data_t *start, *temp;</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US>#ifndef
CONFIG_NUMA</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>unsigned long flags;</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>static pg_data_t *next = 0;</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US>#endif</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>if (order &gt;= MAX_ORDER)</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=PT-BR style='mso-ansi-language:PT-BR'>return NULL;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=PT-BR
style='mso-ansi-language:PT-BR'>#ifdef CONFIG_NUMA<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=PT-BR
style='mso-ansi-language:PT-BR'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>temp = NODE_DATA(numa_node_id());<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US>#else</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>spin_lock_irqsave(&amp;node_lock, flags);</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>if (!next) <span style='mso-spacerun:yes'>&nbsp;</span>next =
pgdat_list;</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>temp = next;</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>next = next-&gt;node_next;</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>spin_unlock_irqrestore(&amp;node_lock, flags);</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US>#endif</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>start = temp;</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>while (temp) {</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>if ((ret = alloc_pages_pgdat(temp, gfp_mask, order)))</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>return(ret);</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>temp = temp-&gt;node_next;</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>}</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>temp = pgdat_list;</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>while (temp != start) {</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>if ((ret = alloc_pages_pgdat(temp, gfp_mask, order)))</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>return(ret);</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>temp = temp-&gt;node_next;</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>}</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;</span>return(0);</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp; </span>}</span></p>

<p class=MsoNormal style='text-indent:22.8pt'><span style='font-family:ËÎÌå;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>¶Ô¸Ãº¯ÊıµÄËµÃ÷ÈçÏÂ£º</span></p>

<p class=MsoNormal style='margin-left:44.05pt;text-indent:-21.25pt;mso-list:
l2 level1 lfo1;tab-stops:list 21.25pt'><![if !supportLists]><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:Wingdings;mso-bidi-font-family:
ËÎÌå'><span style='mso-list:Ignore'>¡¤<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>¸Ãº¯ÊıÓĞÁ½¸ö²ÎÊı¡£</span><span
lang=EN-US>gfp_mask</span><span style='font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>±íÊ¾²ÉÓÃÄÄÖÖ·ÖÅä²ßÂÔ¡£²ÎÊı</span><span
lang=EN-US>order</span><span style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>±íÊ¾ËùĞèÎïÀí¿éµÄ´óĞ¡£¬¿ÉÒÔÊÇ</span><span lang=EN-US>1</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>¡¢</span><span lang=EN-US>2</span><span style='font-family:
ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>¡¢</span><span
lang=EN-US>3</span><span style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>Ö±µ½</span><span lang=EN-US>2<sup>MAX_ORDER-1</sup></span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>¡£</span></p>

<p class=MsoNormal style='margin-left:44.05pt;text-indent:-21.25pt;mso-list:
l2 level1 lfo1;tab-stops:list 21.25pt'><![if !supportLists]><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:Wingdings;mso-bidi-font-family:
ËÎÌå'><span style='mso-list:Ignore'>¡¤<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>Èç¹û¶¨ÒåÁË</span><span
lang=EN-US>CONFIG_NUMA</span><span style='font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>£¬Ò²¾ÍÊÇÔÚ</span><span
lang=EN-US>NUMA</span><span style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>½á¹¹µÄÏµÍ³ÖĞ£¬¿ÉÒÔÍ¨¹ı</span><span lang=EN-US>NUMA_DATA</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>£¨£©ºêÕÒµ½</span><span lang=EN-US>CPU</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>ËùÔÚ½ÚµãµÄ</span><span lang=EN-US>pg_data_t</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>Êı¾İ½á¹¹¶ÓÁĞ£¬²¢´æ·ÅÔÚÁÙÊ±±äÁ¿</span><span lang=EN-US>temp</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>ÖĞ¡£</span></p>

<p class=MsoNormal style='margin-left:44.05pt;text-indent:-21.25pt;mso-list:
l2 level1 lfo1;tab-stops:list 21.25pt'><![if !supportLists]><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:Wingdings;mso-bidi-font-family:
ËÎÌå'><span style='mso-list:Ignore'>¡¤<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>Èç¹ûÔÚ²»Á¬ĞøµÄ</span><span
lang=EN-US>UMA</span><span style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>½á¹¹ÖĞ£¬ÔòÓĞ¸ö</span><span lang=EN-US>pg_data_t</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>Êı¾İ½á¹¹µÄ¶ÓÁĞ</span><span lang=EN-US>pgdat_list</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>£¬</span><span lang=EN-US>pgdat_list</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>¾ÍÊÇ¸Ã¶ÓÁĞµÄÊ×²¿¡£ÒòÎª¶ÓÁĞÒ»°ã¶¼ÊÇÁÙ½ç×ÊÔ´£¬Òò´Ë£¬ÔÚ¶Ô¸Ã¶ÓÁĞ½øĞĞÁ½¸öÒÔÉÏµÄ²Ù×÷Ê±Òª¼ÓËø¡£</span></p>

<p class=MsoNormal style='margin-left:44.05pt;text-indent:-21.25pt;mso-list:
l2 level1 lfo1;tab-stops:list 21.25pt'><![if !supportLists]><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:Wingdings;mso-bidi-font-family:
ËÎÌå'><span style='mso-list:Ignore'>¡¤<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>·ÖÅäÊ±ÂÖÁ÷´Ó¸÷¸ö½Úµã¿ªÊ¼£¬ÒÔÇó¸÷½Úµã¸ººÉµÄÆ½ºâ¡£º¯ÊıÖĞÓĞÁ½¸öÑ­»·£¬ÆäĞÎÊ½»ù±¾ÏàÍ¬£¬Ò²¾ÍÊÇ£¬¶Ô½Úµã¶ÓÁĞ»ù±¾½øĞĞÁ½±éÉ¨Ãè£¬Ö±ÖÁÔÚÄ³¸ö½ÚµãÄÚ·ÖÅä³É¹¦£¬ÔòÌø³öÑ­»·£¬·ñÔò£¬Ôò³¹µ×Ê§°Ü£¬´Ó¶ø·µ»Ø</span><span
lang=EN-US>0</span><span style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>¡£¶ÔÓÚÃ¿¸ö½Úµã£¬µ÷ÓÃ</span><span lang=EN-US>alloc_pages_pgdat</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>£¨£©º¯ÊıÊÔÍ¼·ÖÅäËùĞèµÄÒ³Ãæ¡£</span></p>

<p class=MsoNormal style='mso-outline-level:1'><span lang=EN-US>2. </span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>Ò»ÖÂ´æ´¢½á¹¹</span><span lang=EN-US>(UMA)</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>ÖĞÒ³ÃæµÄ·ÖÅä</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;
</span></span><span style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>Á¬Ğø¿Õ¼ä</span><span lang=EN-US>UMA</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>½á¹¹µÄ</span><span lang=EN-US>alloc_page()</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>ÊÇÔÚ</span><span lang=EN-US>include/linux/mm.h</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>ÖĞ¶¨ÒåµÄ£º</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;
</span>#ifndef CONFIG_DISCONTIGMEM</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;
</span><span style='mso-tab-count:1'>&nbsp; </span>static inline struct page *
alloc_pages(unsigned int gfp_mask, unsigned int order)</span></p>

<p class=MsoNormal style='text-indent:21.25pt'><span lang=EN-US>{</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>/*</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>* Gets optimized away by the compiler.</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>*/</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>if (order &gt;= MAX_ORDER)</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>return NULL;</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>return __alloc_pages(gfp_mask, order,</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>contig_page_data.node_zonelists+(gfp_mask &amp; GFP_ZONEMASK));</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>}</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>#endif</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:22.8pt'><span style='font-family:ËÎÌå;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>´ÓÕâ¸öº¯ÊıµÄ¶¨Òå¿ÉÒÔ¿´³ö£¬</span><span
lang=EN-US>alloc_page()</span><span style='font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>ÊÇ</span><span
lang=EN-US>_alloc_pages</span><span style='font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>£¨£©µÄ·â×°º¯Êı£¬¶ø</span><span
lang=EN-US>_alloc_pages</span><span style='font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>£¨£©²ÅÊÇ»ï°éËã·¨µÄºËĞÄ¡£Õâ¸öº¯Êı¶¨ÒåÓÚ</span><span
lang=EN-US>mm/page_alloc.c</span><span style='font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>ÖĞ£¬ÎÒÃÇÏÈ¶Ô´Ëº¯Êı¸øÓè¸ÅÒªÃèÊö¡£</span></p>

<p class=MsoNormal style='text-indent:22.8pt'><span lang=EN-US>_alloc_pages</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>£¨£©ÔÚ¹ÜÀíÇøÁ´±í</span><span lang=EN-US>zonelist</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>ÖĞÒÀ´Î²éÕÒÃ¿¸öÇø£¬´ÓÖĞÕÒµ½Âú×ãÒªÇóµÄÇø£¬È»ºóÓÃ»ï°éËã·¨´ÓÕâ¸öÇøÖĞ·ÖÅä¸ø¶¨´óĞ¡£¨</span><span
lang=EN-US>2 <sup>order</sup></span><span style='font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>¸ö£©µÄÒ³Ãæ¿é¡£Èç¹ûËùÓĞµÄÇø¶¼Ã»ÓĞ×ã¹»µÄ¿ÕÏĞÒ³Ãæ£¬Ôòµ÷ÓÃ</span><span
lang=EN-US>swapper</span><span style='font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>»ò</span><span
lang=EN-US> bdflush</span><span style='font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>ÄÚºËÏß³Ì£¬°ÑÔàÒ³Ğ´µ½´ÅÅÌÒÔÊÍ·ÅÒ»Ğ©Ò³Ãæ¡£</span></p>

<p class=MsoNormal style='text-indent:22.8pt'><span style='font-family:ËÎÌå;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>ÔÚ</span><span
lang=EN-US>__alloc_pages()</span><span style='font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>ºÍĞéÄâÄÚ´æ£¨¼ò³Æ</span><span
lang=EN-US>VM</span><span style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>£©µÄ´úÂëÖ®¼äÓĞÒ»Ğ©¸´ÔÓµÄ½Ó¿Ú£¨ºóÃæ»áÏêÏ¸ÃèÊö£©¡£Ã¿¸öÇø¶¼Òª¶Ô¸Õ¸Õ±»Ó³Éäµ½Ä³¸ö½ø³Ì</span><span
lang=EN-US>VM</span><span style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>µÄÒ³Ãæ½øĞĞ¸ú×Ù£¬±»Ó³ÉäµÄÒ³ÃæÒ²Ğí½ö½ö×öÁË±ê¼Ç£¬¶ø²¢Ã»ÓĞÕæÕıµØ·ÖÅä³öÈ¥¡£ÒòÎª¸ù¾İĞéÄâ´æ´¢µÄ·ÖÅäÔ­Àí£¬¶ÔÎïÀíÒ³ÃæµÄ·ÖÅäÒª¾¡Á¿ÍÆ³Ùµ½²»ÄÜÔÙÍÆ³ÙÎªÖ¹£¬Ò²¾ÍÊÇËµ£¬µ±½ø³ÌµÄ´úÂë»òÊı¾İ±ØĞë×°Èëµ½ÄÚ´æÊ±£¬²Å¸øËüÕæÕı·ÖÅäÎïÀíÒ³Ãæ¡£</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;
</span></span><span style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>¸ãÇå³şÒ³Ãæ·ÖÅäµÄ»ù±¾Ô­Ôòºó£¬ÎÒÃÇ¶ÔÆä´úÂë¾ßÌå·ÖÎöÈçÏÂ£º</span></p>

<p class=MsoNormal style='text-indent:22.8pt'><span lang=EN-US>/*</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;
</span><span style='mso-tab-count:1'>&nbsp;&nbsp; </span>* This is the 'heart'
of the zoned buddy allocator:</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;
</span><span style='mso-tab-count:1'>&nbsp;&nbsp; </span>*/</span></p>

<p class=MsoNormal style='text-indent:21.25pt'><span lang=EN-US>struct page *
__alloc_pages(unsigned int gfp_mask, unsigned int order, zonelist_t *zonelist)</span></p>

<p class=MsoNormal style='text-indent:21.25pt'><span lang=EN-US>{</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp; </span>unsigned
long min;</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp; </span>zone_t
**zone, * classzone;</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp; </span>struct
page * page;</span></p>

<p class=MsoNormal style='text-indent:21.25pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>int
freed;</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='mso-spacerun:yes'>&nbsp;</span></span><span lang=PT-BR style='mso-ansi-language:
PT-BR'>zone = zonelist-&gt;zones;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=PT-BR style='mso-ansi-language:PT-BR'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp; </span>classzone = *zone;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=PT-BR style='mso-ansi-language:PT-BR'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='mso-spacerun:yes'>&nbsp;</span></span><span lang=EN-US>min = 1UL
&lt;&lt; order;</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp; </span>for (;;) {</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span>zone_t *z =
*(zone++);</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span>if (!z)</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>break;</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>min += z-&gt;pages_low;</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>if (z-&gt;free_pages &gt; min) {</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>page = rmqueue(z, order);</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>if (page)</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>return page;</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>}</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-left:21.25pt'><span style='font-family:ËÎÌå;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>ÕâÊÇ¶ÔÒ»¸ö·ÖÅä²ßÂÔÖĞËù¹æ¶¨µÄËùÓĞÒ³Ãæ¹ÜÀíÇøµÄÑ­»·¡£Ñ­»·ÖĞÒÀ´Î¿¼²ì¸÷¸öÇøÖĞ¿ÕÏĞÒ³ÃæµÄ×ÜÁ¿£¬Èç¹û×ÜÁ¿ÉĞ´óÓÚ¡°×îµÍË®Î»Ïß¡±ÓëËùÇëÇóÒ³ÃæÊıÖ®ºÍ£¬¾Íµ÷ÓÃ</span><span
lang=EN-US>rmqueue</span><span style='font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>£¨£©ÊÔÍ¼´Ó¸ÃÇøÖĞ½øĞĞ·ÖÅä¡£Èç¹û·ÖÅä³É¹¦£¬Ôò·µ»ØÒ»¸ö</span><span
lang=EN-US>page</span><span style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>½á¹¹Ö¸Õë£¬Ö¸ÏòÒ³Ãæ¿éÖĞµÚÒ»¸öÒ³ÃæµÄÆğÊ¼µØÖ·¡£</span></p>

<p class=MsoNormal style='margin-left:21.25pt'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>classzone-&gt;need_balance = 1;</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>mb();</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>if (waitqueue_active(&amp;kswapd_wait))</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>wake_up_interruptible(&amp;kswapd_wait);</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-left:21.25pt'><span style='font-family:ËÎÌå;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>Èç¹û·¢ÏÖ¹ÜÀíÇøÖĞµÄ¿ÕÏĞÒ³Ãæ×ÜÁ¿ÒÑ¾­½µµ½×îµÍµã£¬Ôò°Ñ</span><span
lang=EN-US>zone_t</span><span style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>½á¹¹ÖĞĞèÒªÖØĞÂÆ½ºâµÄ±êÖ¾£¨</span><span lang=EN-US>need_balance</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>£©ÖÃ</span><span lang=EN-US>1</span><span style='font-family:
ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>£¬¶øÇÒÈç¹ûÄÚºËÏß³Ì</span><span
lang=EN-US>kswapd</span><span style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>ÔÚÒ»¸öµÈ´ı¶ÓÁĞÖĞË¯Ãß£¬¾Í»½ĞÑËü£¬ÈÃËüÊÕ»ØÒ»Ğ©Ò³ÃæÒÔ±¸Ê¹ÓÃ£¨¿ÉÒÔ¿´³ö£¬</span><span
lang=EN-US>need_balance</span><span style='font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>ÊÇºÍ</span><span
lang=EN-US>kswapd</span><span style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>ÅäºÏÊ¹ÓÃµÄ£©¡£</span></p>

<p class=MsoNormal style='margin-left:21.25pt'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>zone = zonelist-&gt;zones;</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>min = 1UL &lt;&lt; order;</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>for (;;) {</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>unsigned long local_min;</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>zone_t *z = *(zone++);</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>if (!z)</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>break;</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>local_min = z-&gt;pages_min;</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>if (!(gfp_mask &amp; __GFP_WAIT))</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>local_min &gt;&gt;= 2;</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>min += local_min;</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>if (z-&gt;free_pages &gt; min) {</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>page
= rmqueue(z, order);</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>if (page)</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>return page;</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>}</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>}</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-left:21.25pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;</span></span><span style='font-family:ËÎÌå;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>Èç¹û¸ø¶¨·ÖÅä²ßÂÔÖĞËùÓĞµÄÒ³Ãæ¹ÜÀíÇø¶¼·ÖÅäÊ§°Ü£¬ÄÇÖ»ºÃ°ÑÔ­À´µÄ¡°×îµÍË®Î»¡±ÔÙÏòÏÂµ÷£¨³ı</span>
<span style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>ÒÔ</span><span lang=EN-US>4</span><span style='font-family:
ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>£©£¬È»ºó¿´ÊÇ·ñÂú×ãÒªÇó£¨</span><span
lang=EN-US>z-&gt;free_pages &gt; min</span><span style='font-family:ËÎÌå;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>£©£¬Èç¹ûÄÜÂú×ãÒªÇó£¬Ôòµ÷ÓÃ</span><span
lang=EN-US>rmqueue</span><span style='font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>£¨£©½øĞĞ·ÖÅä¡£</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>/* here we're in the low on memory slow path */</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:21.25pt'><span lang=EN-US>rebalance:</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>if (current-&gt;flags &amp; (PF_MEMALLOC | PF_MEMDIE)) {</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>zone = zonelist-&gt;zones;</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>for (;;) {</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>zone_t *z = *(zone++);</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>if (!z)</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>break;</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>page = rmqueue(z, order);</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>if (page)</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;
</span><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>return
page;</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>}</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>return NULL;</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;</span><span
style='mso-spacerun:yes'>&nbsp;</span>}</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span></span></p>

<p class=MsoNormal style='margin-left:21.25pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;</span></span><span style='font-family:ËÎÌå;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>Èç¹û·ÖÅä»¹²»³É¹¦£¬ÕâÊ±ºò¾ÍÒª¿´ÊÇÄÄÀà½ø³ÌÔÚÇëÇó·ÖÅäÄÚ´æÒ³Ãæ¡£ÆäÖĞ</span><span
lang=EN-US>PF_MEMALLOC</span><span style='font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>ºÍ</span><span
lang=EN-US>PF_MEMDIE</span><span style='font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>ÊÇ½ø³ÌµÄ</span><span
lang=EN-US>task_struct</span><span style='font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>½á¹¹ÖĞ</span><span
lang=EN-US>flags</span><span style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>ÓòµÄÖµ£¬¶ÔÓÚÕıÔÚ·ÖÅäÒ³ÃæµÄ½ø³Ì£¨Èç</span><span
lang=EN-US>kswapd</span><span style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>ÄÚºËÏß³Ì£©£¬ÔòÆä</span><span lang=EN-US>PF_MEMALLOC</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>µÄÖµÎª</span><span lang=EN-US>1</span><span style='font-family:
ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>£¨Ò»°ã½ø³ÌµÄÕâ¸ö±êÖ¾Îª</span><span
lang=EN-US>0</span><span style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>£©£¬¶ø¶ÔÓÚÊ¹ÄÚ´æÒç³ö¶ø±»É±ËÀµÄ½ø³Ì£¬ÔòÆä</span><span
lang=EN-US>PF_MEMDIE</span><span style='font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>Îª</span><span
lang=EN-US>1</span><span style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>¡£²»¹ÜÄÄÖÖÇé¿ö£¬¶¼ËµÃ÷±ØĞë¸ø¸Ã½ø³Ì·ÖÅäÒ³Ãæ£¨ÏëÏëÎªÊ²Ã´£©¡£Òò´Ë£¬¼ÌĞø½øĞĞ·ÖÅä¡£</span></p>

<p class=MsoNormal style='margin-left:21.25pt'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>/* Atomic allocations - we can't balance anything */</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>if (!(gfp_mask &amp; __GFP_WAIT))</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>return NULL;</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-left:17.4pt'><span style='font-family:ËÎÌå;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>Èç¹ûÇëÇó·ÖÅäÒ³ÃæµÄ½ø³Ì²»ÄÜµÈ´ı£¬Ò²²»ÄÜ±»ÖØĞÂµ÷¶È£¬Ö»ºÃÔÚÃ»ÓĞ·ÖÅäµ½Ò³ÃæµÄÇé¿öÏÂ¡°¿ÕÊÖ¡±·µ»Ø¡£</span></p>

<p class=MsoNormal style='margin-left:17.4pt'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>page = balance_classzone(classzone, gfp_mask, order, &amp;freed);</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>if (page)</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>return page;</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-left:21.25pt'><span style='font-family:ËÎÌå;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>Èç¹û¾­¹ı¼¸·¬Å¬Á¦£¬±ØĞëµÃµ½Ò³ÃæµÄ½ø³Ì£¨Èç</span><span
lang=EN-US>kswapd</span><span style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>£©»¹Ã»ÓĞ·ÖÅäµ½Ò³Ãæ£¬¾ÍÒªµ÷ÓÃ</span><span lang=EN-US>balance_classzone</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>£¨£©º¯Êı°Ñµ±Ç°½ø³ÌËùÕ¼ÓĞµÄ¾Ö²¿Ò³ÃæÊÍ·Å³öÀ´¡£Èç¹ûÊÍ·Å³É¹¦£¬Ôò·µ»ØÒ»¸ö</span><span lang=EN-US>page</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>½á¹¹Ö¸Õë£¬Ö¸ÏòÒ³Ãæ¿éÖĞµÚÒ»¸öÒ³ÃæµÄÆğÊ¼µØÖ·¡£</span></p>

<p class=MsoNormal style='margin-left:21.25pt'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>zone = zonelist-&gt;zones;</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>min = 1UL &lt;&lt; order;</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>for
(;;) {</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>zone_t *z = *(zone++);</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>if (!z)</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>break;</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>min += z-&gt;pages_min;</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>if (z-&gt;free_pages &gt; min) {</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>page = rmqueue(z, order);</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>if (page)</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>return page;</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>}</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>}</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-outline-level:1'><span lang=EN-US><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>¼ÌĞø½øĞĞ·ÖÅä¡£</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>/* Don't let big-order allocations loop *</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>if (order &gt; 3)</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>return NULL;</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>/*
Yield for kswapd, and try again */</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>current-&gt;policy |= SCHED_YIELD;</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>__set_current_state(TASK_RUNNING);</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>schedule();</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>goto rebalance;</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;
</span></span><span style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>ÔÚÕâ¸öº¯ÊıÖĞ£¬Æµ·±µ÷ÓÃÁË</span><span lang=EN-US>rmqueue</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>£¨£©º¯Êı£¬ÏÂÃæÎÒÃÇ¾ßÌåÀ´¿´Ò»ÏÂÕâ¸öº¯ÊıÄÚÈİ£º</span></p>

<p class=MsoNormal style='mso-outline-level:1'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;</span></span><span style='font-family:ËÎÌå;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>£¨</span><span
lang=EN-US>1</span><span style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>£©</span><span lang=EN-US>rmqueue</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>£¨£©º¯Êı</span></p>

<p class=MsoNormal style='text-indent:22.8pt'><span style='font-family:ËÎÌå;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>¸Ãº¯ÊıÊÔÍ¼´ÓÒ»¸öÒ³Ãæ¹ÜÀíÇø·ÖÅäÈô¸ÉÁ¬ĞøµÄÄÚ´æÒ³Ãæ¡£ÕâÊÇ×î»ù±¾µÄ·ÖÅä²Ù×÷£¬Æä¾ßÌå´úÂëÈçÏÂ£º</span></p>

<p class=MsoNormal style='text-indent:22.8pt'><span lang=EN-US>static struct
page * rmqueue(zone_t *zone, unsigned int order)</span></p>

<p class=MsoNormal style='text-indent:22.8pt'><span lang=EN-US>{</span></p>

<p class=MsoNormal style='text-indent:22.8pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>free_area_t * area = zone-&gt;free_area + order;</span></p>

<p class=MsoNormal style='text-indent:22.8pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>unsigned int curr_order = order;</span></p>

<p class=MsoNormal style='text-indent:22.8pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>struct list_head *head, *curr;</span></p>

<p class=MsoNormal style='text-indent:22.8pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>unsigned long flags;</span></p>

<p class=MsoNormal style='text-indent:22.8pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>struct page *page;</span></p>

<p class=MsoNormal style='text-indent:22.8pt'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:22.8pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>spin_lock_irqsave(&amp;zone-&gt;lock, flags);</span></p>

<p class=MsoNormal style='text-indent:22.8pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>do {</span></p>

<p class=MsoNormal style='text-indent:22.8pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>head = &amp;area-&gt;free_list;</span></p>

<p class=MsoNormal style='text-indent:22.8pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>curr = memlist_next(head);</span></p>

<p class=MsoNormal style='text-indent:22.8pt'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:22.8pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>if (curr != head) {</span></p>

<p class=MsoNormal style='text-indent:22.8pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>unsigned int index;</span></p>

<p class=MsoNormal style='text-indent:22.8pt'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:22.8pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>page = memlist_entry(curr, struct page, list);</span></p>

<p class=MsoNormal style='text-indent:22.8pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>if (BAD_RANGE(zone,page))</span></p>

<p class=MsoNormal style='text-indent:22.8pt;mso-outline-level:1'><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>BUG();</span></p>

<p class=MsoNormal style='text-indent:22.8pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>memlist_del(curr);</span></p>

<p class=MsoNormal style='text-indent:22.8pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>index = page - zone-&gt;zone_mem_map;</span></p>

<p class=MsoNormal style='text-indent:22.8pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>if (curr_order != MAX_ORDER-1)</span></p>

<p class=MsoNormal style='text-indent:22.8pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>MARK_USED(index, curr_order, area);</span></p>

<p class=MsoNormal style='text-indent:22.8pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>zone-&gt;free_pages -= 1UL &lt;&lt; order;</span></p>

<p class=MsoNormal style='text-indent:22.8pt'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:22.8pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>page = expand(zone, page, index, order, curr_order, area);</span></p>

<p class=MsoNormal style='text-indent:22.8pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>spin_unlock_irqrestore(&amp;zone-&gt;lock, flags);</span></p>

<p class=MsoNormal style='text-indent:22.8pt'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:22.8pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>set_page_count(page, 1);</span></p>

<p class=MsoNormal style='text-indent:22.8pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>if (BAD_RANGE(zone,page))</span></p>

<p class=MsoNormal style='text-indent:22.8pt;mso-outline-level:1'><span
lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>BUG();</span></p>

<p class=MsoNormal style='text-indent:22.8pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>if (PageLRU(page))</span></p>

<p class=MsoNormal style='text-indent:22.8pt;mso-outline-level:1'><span
lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>BUG();</span></p>

<p class=MsoNormal style='text-indent:22.8pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>if (PageActive(page))</span></p>

<p class=MsoNormal style='text-indent:22.8pt;mso-outline-level:1'><span
lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>BUG();</span></p>

<p class=MsoNormal style='text-indent:22.8pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>return page;<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span></span></p>

<p class=MsoNormal style='text-indent:22.8pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>}</span></p>

<p class=MsoNormal style='text-indent:22.8pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>curr_order++;</span></p>

<p class=MsoNormal style='text-indent:22.8pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>area++;</span></p>

<p class=MsoNormal style='text-indent:22.8pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>} while (curr_order &lt; MAX_ORDER);</span></p>

<p class=MsoNormal style='text-indent:22.8pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>spin_unlock_irqrestore(&amp;zone-&gt;lock, flags);</span></p>

<p class=MsoNormal style='text-indent:22.8pt'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:22.8pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>return NULL;</span></p>

<p class=MsoNormal style='text-indent:22.8pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;</span>}</span></p>

<p class=MsoNormal style='text-indent:22.8pt'><span style='font-family:ËÎÌå;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>¶Ô¸Ãº¯ÊıµÄ½âÊÍÈçÏÂ£º</span></p>

<p class=MsoNormal style='margin-left:44.05pt;text-indent:-21.25pt;mso-list:
l4 level1 lfo2;tab-stops:list 21.25pt'><![if !supportLists]><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:Wingdings;mso-bidi-font-family:
ËÎÌå'><span style='mso-list:Ignore'>¡¤<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>²ÎÊı</span><span
lang=EN-US>zone</span><span style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>Ö¸ÏòÒª·ÖÅäÒ³ÃæµÄ¹ÜÀíÇø£¬</span><span lang=EN-US>order</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>±íÊ¾ÒªÇó·ÖÅäµÄÒ³ÃæÊıÎª</span><span lang=EN-US>2<sup> order</sup></span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>¡£</span></p>

<p class=MsoNormal style='margin-left:44.05pt;text-indent:-21.25pt;mso-list:
l4 level1 lfo2;tab-stops:list 21.25pt'><![if !supportLists]><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:Wingdings;mso-bidi-font-family:
ËÎÌå'><span style='mso-list:Ignore'>¡¤<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span lang=EN-US>do</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>Ñ­»·´Ó</span><span lang=EN-US>free_area</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>Êı×éµÄµÚ</span><span lang=EN-US>order</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>¸öÔªËØ¿ªÊ¼£¬É¨ÃèÃ¿¸öÔªËØÖĞÓÉ</span><span lang=EN-US>page</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>½á¹¹×é³ÉµÄË«ÏòÑ­»·¿ÕÏĞ¶ÓÁĞ¡£Èç¹ûÕÒµ½ºÏÊÊµÄÒ³¿é£¬¾Í°ÑËü´Ó¶ÓÁĞÖĞÉ¾³ı£¬É¾³ıµÄ¹ı³ÌÊÇ²»ÔÊĞíÆäËû½ø³Ì¡¢ÆäËû´¦ÀíÆ÷À´´òÈÅµÄ¡£ËùÒÔÒªÓÃ</span><span
lang=EN-US>spin_lock_irqsave</span><span style='font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>£¨£©½«Õâ¸öÑ­»·¼ÓÉÏËø¡£</span></p>

<p class=MsoNormal style='margin-left:44.05pt;text-indent:-21.25pt;mso-list:
l4 level1 lfo2;tab-stops:list 21.25pt'><![if !supportLists]><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:Wingdings;mso-bidi-font-family:
ËÎÌå'><span style='mso-list:Ignore'>¡¤<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>Ê×ÏÈÔÚÇ¡ºÃÂú×ã´óĞ¡ÒªÇóµÄ¶ÓÁĞÀï½øĞĞ·ÖÅä¡£ÆäÖĞ</span><span
lang=EN-US>memlist_entry(curr, struct page, list)</span><span style='font-family:
ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>»ñµÃ¿ÕÏĞ¿éµÄµÚÒ»¸öÒ³ÃæµÄµØÖ·£¬Èç¹ûÕâ¸öµØÖ·ÊÇ¸öÎŞĞ§µÄµØÖ·£¬¾ÍÏİÈë</span><span
lang=EN-US>BUG()</span><span style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>¡£Èç¹ûÓĞĞ§£¬</span><span lang=EN-US>memlist_del(curr)</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>´Ó¶ÓÁĞÖĞÕª³ı·ÖÅä³öÈ¥µÄÒ³Ãæ¿é¡£Èç¹ûÄ³¸öÒ³Ãæ¿é±»·ÖÅä³öÈ¥£¬¾ÍÒªÔÚ</span><span lang=EN-US>frea_area</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>µÄÎ»Í¼ÖĞ½øĞĞ±ê¼Ç£¬ÕâÊÇÍ¨¹ıµ÷ÓÃ</span><span lang=EN-US>MARK_USED</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>£¨£©ºêÀ´Íê³ÉµÄ¡£</span></p>

<p class=MsoNormal style='margin-left:44.05pt;text-indent:-21.25pt;mso-list:
l4 level1 lfo2;tab-stops:list 21.25pt'><![if !supportLists]><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:Wingdings;mso-bidi-font-family:
ËÎÌå'><span style='mso-list:Ignore'>¡¤<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>Èç¹û·ÖÅä³öÈ¥ºó»¹ÓĞÊ£Óà¿é£¬¾ÍÍ¨¹ı</span><span
lang=EN-US>expand</span><span style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>£¨£©»ñµÃËù·ÖÅäµÄÒ³¿é</span><span lang=EN-US>,</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>¶ø°ÑÊ£Óà¿éÁ´ÈëÊÊµ±µÄ¿ÕÏĞ¶ÓÁĞÖĞ¡£</span></p>

<p class=MsoNormal style='margin-left:44.05pt;text-indent:-21.25pt;mso-list:
l4 level1 lfo2;tab-stops:list 21.25pt'><![if !supportLists]><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:Wingdings;mso-bidi-font-family:
ËÎÌå'><span style='mso-list:Ignore'>¡¤<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>Èç¹ûµ±Ç°¿ÕÏĞ¶ÓÁĞÃ»ÓĞ¿ÕÏĞ¿é£¬¾Í´Ó¸ü´óµÄ¿ÕÏĞ¿é¶ÓÁĞÖĞÕÒ¡£</span></p>

<p class=MsoNormal style='mso-outline-level:1'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;</span></span><span style='font-family:ËÎÌå;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>£¨</span><span
lang=EN-US>2</span><span style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>£©</span><span lang=EN-US>expand</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>£¨£©º¯Êı</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>¸Ãº¯ÊıÔ´´úÂëÈçÏÂ£º</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>static inline struct
page * expand (zone_t *zone, struct page *page,</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>unsigned long index, int low, int high, free_area_t * area)</span></p>

<p class=MsoNormal style='margin-left:21.25pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp; </span>{</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>unsigned long size = 1 &lt;&lt; high;</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>while (high &gt; low) {</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>if (BAD_RANGE(zone,page))</span></p>

<p class=MsoNormal style='mso-outline-level:1'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>BUG();</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>area--;</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>high--;</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>size &gt;&gt;= 1;</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>memlist_add_head(&amp;(page)-&gt;list, &amp;(area)-&gt;free_list);</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>MARK_USED(index, high, area);</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>index += size;</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>page
+= size;</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>}</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>if (BAD_RANGE(zone,page))</span></p>

<p class=MsoNormal style='mso-outline-level:1'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>BUG();</span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>return page;</span></p>

<p class=MsoNormal style='text-indent:21.25pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp; </span>}</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;
</span></span><span style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>¶Ô¸Ãº¯Êı½âÊÍÈçÏÂ£º</span></p>

<p class=MsoNormal style='margin-left:38.65pt;text-indent:-21.25pt;mso-list:
l1 level1 lfo3;tab-stops:list 21.25pt'><![if !supportLists]><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:Wingdings;mso-bidi-font-family:
ËÎÌå'><span style='mso-list:Ignore'>¡¤<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>²ÎÊı</span><span
lang=EN-US>zone</span><span style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>Ö¸ÏòÒÑ·ÖÅäÒ³¿éËùÔÚµÄ¹ÜÀíÇø£»</span><span lang=EN-US>page</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>Ö¸ÏòÒÑ·ÖÅäµÄÒ³¿é£»</span><span lang=EN-US>index</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>ÊÇÒÑ·ÖÅäµÄÒ³ÃæÔÚ</span><span lang=EN-US>mem_map</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>ÖĞµÄÏÂ±ê£»</span><span lang=EN-US> low</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>±íÊ¾ËùĞèÒ³Ãæ¿é´óĞ¡Îª</span><span lang=EN-US>2 <sup>low</sup></span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>£¬¶ø</span><span lang=EN-US>high</span><span style='font-family:
ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>±íÊ¾´Ó¿ÕÏĞ¶ÓÁĞÖĞÊµ¼Ê½øĞĞ·ÖÅäµÄÒ³Ãæ¿é´óĞ¡Îª</span><span
lang=EN-US>2 <sup>high</sup></span><span style='font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>£»</span><span
lang=EN-US>area</span><span style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>ÊÇ</span><span lang=EN-US>free_area_struct</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>½á¹¹£¬Ö¸ÏòÊµ¼ÊÒª·ÖÅäµÄÒ³¿é¡£</span></p>

<p class=MsoNormal style='margin-left:38.65pt;text-indent:-21.25pt;mso-list:
l1 level1 lfo3;tab-stops:list 21.25pt 38.65pt'><![if !supportLists]><span
lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:Wingdings;mso-bidi-font-family:
ËÎÌå'><span style='mso-list:Ignore'>¡¤<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>Í¨¹ıÉÏÃæ½éÉÜ¿ÉÒÔÖªµÀ£¬·µ»Ø¸øÇëÇóÕßµÄ¿é´óĞ¡Îª</span><span
lang=EN-US>2<sup>low</sup></span><span style='font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>¸öÒ³Ãæ£¬²¢°ÑÊ£ÓàµÄÒ³Ãæ·ÅÈëºÏÊÊµÄ¿ÕÏĞ¶ÓÁĞ£¬ÇÒ¶Ô»ï°éÏµÍ³µÄÎ»Í¼½øĞĞÏàÓ¦µÄĞŞ¸Ä¡£ÀıÈç£¬¼Ù¶¨ÎÒÃÇĞèÒªÒ»¸ö</span><span
lang=EN-US>2</span><span style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>Ò³ÃæµÄ¿é£¬µ«ÊÇ£¬ÎÒÃÇ²»µÃ²»´Ó</span><span lang=EN-US>order</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>Îª</span><span lang=EN-US>3</span><span style='font-family:
ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>£¨</span><span
lang=EN-US>8</span><span style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>¸öÒ³Ãæ£©µÄ¿ÕÏĞ¶ÓÁĞÖĞ½øĞĞ·ÖÅä£¬ÓÖ¼Ù¶¨ÎÒÃÇÅöÇÉÑ¡ÔñÎïÀíÒ³Ãæ</span><span
lang=EN-US>800</span><span style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>×÷Îª¸ÃÒ³Ãæ¿éµÄµ×²¿¡£ÔÚÎÒÃÇÕâ¸öÀı×ÓÖĞ£¬Õâ¼¸¸ö²ÎÊıÖµÎª£º</span></p>

<p class=MsoNormal style='margin-left:38.65pt'><span lang=EN-US>page ==
mem_map+800 </span></p>

<p class=MsoNormal style='margin-left:17.4pt;text-indent:23.4pt'><span
lang=EN-US>index == 800</span></p>

<p class=MsoNormal style='margin-left:17.4pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp; </span>low == 1 </span></p>

<p class=MsoNormal style='margin-left:17.4pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp; </span>high == 3 </span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>area == zone-&gt;free_area+high
( </span><span style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>Ò²¾ÍÊÇ</span><span lang=EN-US>frea_area</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>Êı×éÖĞÏÂ±êÎª</span><span lang=EN-US>3</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>µÄÔªËØ</span><span lang=EN-US>) </span></p>

<p class=MsoNormal style='margin-left:38.65pt;text-indent:-21.25pt;mso-list:
l0 level1 lfo4;tab-stops:list 21.25pt'><![if !supportLists]><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:Wingdings;mso-bidi-font-family:
ËÎÌå'><span style='mso-list:Ignore'>¡¤<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>Ê×ÏÈ°Ñ</span><span
lang=EN-US>size</span><span style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>³õÊ¼»¯Îª·ÖÅä¿éµÄÒ³ÃæÊı</span><span lang=EN-US>(</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>ÀıÈç£¬</span><span lang=EN-US>size = 1&lt;&lt;3 == 8)</span></p>

<p class=MsoNormal style='margin-left:38.65pt;text-indent:-21.25pt;mso-list:
l3 level1 lfo5;tab-stops:list 21.25pt'><![if !supportLists]><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:Wingdings;mso-bidi-font-family:
ËÎÌå'><span style='mso-list:Ignore'>¡¤<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span lang=EN-US>while</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>Ñ­»·½øĞĞÑ­»·²éÕÒ¡£Ã¿´ÎÑ­»·¶¼°Ñ</span><span lang=EN-US>size</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>¼õ°ë¡£Èç¹ûÎÒÃÇ´Ó¿ÕÏĞ¶ÓÁĞÖĞ·ÖÅäµÄÒ»¸ö¿éÓëËùÒªÇóµÄ´óĞ¡Æ¥Åä£¬ÄÇÃ´</span><span lang=EN-US>low =
high</span><span style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>£¬¾Í³¹µ×´ÓÑ­»·ÖĞÌø³ö£¬·µ»ØËù·ÖÅäµÄÒ³¿é¡£</span></p>

<p class=MsoNormal style='margin-left:38.65pt;text-indent:-21.25pt;mso-list:
l3 level1 lfo5;tab-stops:list 21.25pt'><![if !supportLists]><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:Wingdings;mso-bidi-font-family:
ËÎÌå'><span style='mso-list:Ignore'>¡¤<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>Èç¹û·ÖÅäµ½µÄÎïÀí¿éËùÔÚµÄ¿ÕÏĞ¿é´óÓÚËùĞè¿éµÄ´óĞ¡£¨¼´</span><span
lang=EN-US>2 <sup>high</sup>&gt;2<sup>low</sup></span><span style='font-family:
ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>£©£¬ÄÇ¾Í½«¸Ã¿ÕÏĞ¿é·ÖÎªÁ½°ë£¨¼´</span><span
lang=EN-US>area--;high--; size &gt;&gt;= 1</span><span style='font-family:ËÎÌå;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>£©</span><span
lang=EN-US>,</span><span style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>È»ºóµ÷ÓÃ</span><span lang=EN-US>memlist_add_head</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>£¨£©°Ñ¸Õ·ÖÅä³öÈ¥µÄÒ³Ãæ¿éÓÖ¼ÓÈëµ½µÍÒ»µµ£¨ÎïÀí¿é¼õ°ë£©µÄ¿ÕÏĞ¶ÓÁĞÖĞ£¬×¼±¸´ÓÊ£ÏÂµÄÒ»°ë¿ÕÏĞ¿éÖĞÖØĞÂ½øĞĞ·ÖÅä£¬²¢µ÷ÓÃ</span><span
lang=EN-US>MARK_USED</span><span style='font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>£¨£©ÉèÖÃÎ»Í¼¡£</span></p>

<p class=MsoNormal style='margin-left:38.65pt;text-indent:-21.25pt;mso-list:
l3 level1 lfo5;tab-stops:list 21.25pt'><![if !supportLists]><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:Wingdings;mso-bidi-font-family:
ËÎÌå'><span style='mso-list:Ignore'>¡¤<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>ÔÚÉÏÃæµÄÀı×ÓÖĞ£¬µÚ</span><span
lang=EN-US>1</span><span style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>´ÎÑ­»·£¬ÎÒÃÇ´ÓÒ³Ãæ</span><span lang=EN-US>800</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>¿ªÊ¼£¬°ÑÒ³Ãæ´óĞ¡Îª</span><span lang=EN-US>4</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>£¨¼´</span><span lang=EN-US>2<sup>high--</sup></span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>£©µÄ¿éÆäÊ×µØÖ·²åÈëµ½</span><span lang=EN-US>frea_area[2]</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>ÖĞµÄ¿ÕÏĞ¶ÓÁĞ£»ÒòÎª</span><span lang=EN-US>low&lt;high</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>£¬ÓÖ¿ªÊ¼µÚ</span><span lang=EN-US>2</span><span style='font-family:
ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>´ÎÑ­»·£¬Õâ´Î´ÓÒ³Ãæ</span><span
lang=EN-US>804</span><span style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>¿ªÊ¼£¬°ÑÒ³Ãæ´óĞ¡Îª</span><span lang=EN-US>2</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>µÄ¿é²åÈëµ½</span><span lang=EN-US>frea_area[1]</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>ÖĞµÄ¿ÕÏĞ¶ÓÁĞ£¬´ËÊ±£¬</span><span lang=EN-US>page</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>£½</span><span lang=EN-US>806</span><span style='font-family:
ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>£¬</span><span
lang=EN-US>high=low</span><span style='font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>£½</span><span
lang=EN-US>1</span><span style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>£¬ÍË³öÑ­»·£¬ÎÒÃÇ¸øµ÷ÓÃÕß·µ»Ø´Ó</span><span
lang=EN-US>806</span><span style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>Ò³Ãæ¿ªÊ¼µÄÒ»¸ö</span><span lang=EN-US>2</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>Ò³Ãæ¿é¡£</span></p>

<p class=MsoNormal style='margin-left:38.65pt;text-indent:-21.25pt;mso-list:
l3 level1 lfo5;tab-stops:list 21.25pt'><![if !supportLists]><span lang=EN-US
style='font-family:ËÎÌå;mso-hansi-font-family:Wingdings;mso-bidi-font-family:
ËÎÌå'><span style='mso-list:Ignore'>¡¤<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>´ÓÕâ¸öÀı×Ó¿ÉÒÔ¿´³ö£¬ÕâÊÇÒ»ÖÖÇÉÃîµÄ·ÖÅäËã·¨¡£</span></p>

<p class=MsoNormal style='margin-left:17.4pt'><span lang=EN-US>3</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>£®</span> <span style='font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>ÊÍ·ÅÒ³Ãæ</span></p>

<p class=MsoNormal style='margin-left:17.4pt'><span lang=EN-US><span
style='mso-spacerun:yes'>&nbsp;&nbsp; </span></span><span style='font-family:
ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>´ÓÉÏÃæµÄ½éÉÜ¿ÉÒÔ¿´³ö</span><span
lang=EN-US>,</span><span style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>Ò³Ãæ¿éµÄ·ÖÅä±ØÈ»µ¼ÖÂÄÚ´æµÄËéÆ¬»¯£¬¶øÒ³Ãæ¿éµÄÊÍ·ÅÔò¿ÉÒÔ½«Ò³Ãæ¿éÖØĞÂ×éºÏ³É´óµÄÒ³Ãæ¿é¡£Ò³ÃæµÄÊÍ·Åº¯ÊıÎª</span><span
lang=EN-US>__free_pages(page struct *page, unsigned long order) </span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>£¬¸Ãº¯Êı´Ó¸ø¶¨µÄÒ³Ãæ¿ªÊ¼£¬ÊÍ·ÅµÄÒ³Ãæ¿é´óĞ¡Îª</span><span lang=EN-US>2<sup>order</sup></span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>¡£Ô­º¯ÊıÎª</span><span lang=EN-US>:</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-left:38.65pt;text-indent:3.85pt'><span
lang=EN-US>void __free_pages(page struct *page, unsigned long order)</span></p>

<p class=MsoNormal style='margin-left:34.8pt;text-indent:3.85pt'><span
lang=EN-US>{</span></p>

<p class=MsoNormal style='margin-left:17.4pt'><span lang=EN-US><span
style='mso-tab-count:1'> </span><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='mso-spacerun:yes'>&nbsp;&nbsp; </span>if (!PageReserved(page) &amp;&amp;
put_page_testzero(page))</span></p>

<p class=MsoNormal style='margin-left:17.4pt'><span lang=EN-US><span
style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='mso-spacerun:yes'>&nbsp;&nbsp; </span>__free_pages_ok(page, order);</span></p>

<p class=MsoNormal style='margin-left:38.65pt;text-indent:3.85pt'><span
lang=EN-US>}</span></p>

<p class=MsoNormal style='margin-left:17.4pt'><span lang=EN-US><span
style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></p>

<p class=MsoNormal style='margin-left:17.4pt;text-indent:22.8pt'><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>ÆäÖĞ±È½ÏÇÉÃîµÄ²¿·Ö¾ÍÊÇµ÷ÓÃ</span><span lang=EN-US>put_page_testzero()</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>ºê</span><span lang=EN-US>,</span><span style='font-family:
ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>¸Ãº¯Êı°ÑÒ³ÃæµÄÒıÓÃ¼ÆÊı¼õ</span><span
lang=EN-US>1,</span><span style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>Èç¹û¼õ</span><span lang=EN-US>1</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>ºóÒıÓÃ¼ÆÊıÎª</span><span lang=EN-US>0</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>£¬Ôò¸Ãº¯Êı·µ»Ø</span><span lang=EN-US>1</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>¡£Òò´Ë£¬Èç¹ûµ÷ÓÃÕß²»ÊÇ¸ÃÒ³ÃæµÄ×îºóÒ»¸öÓÃ»§£¬ÄÇÃ´£¬Õâ¸öÒ³ÃæÊµ¼ÊÉÏ¾Í²»»á±»ÊÍ·Å¡£ÁíÍâÒªËµÃ÷µÄÊÇ²»¿ÉÊÍ·Å±£ÁôÒ³</span><span
lang=EN-US>PageReserved</span><span style='font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>£¬ÕâÊÇÍ¨¹ı</span><span
lang=EN-US>PageReserved</span><span style='font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>£¨£©ºê½øĞĞ¼ì²éµÄ¡£</span></p>

<p class=MsoNormal style='margin-left:17.4pt;text-indent:22.8pt'><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>Èç¹ûµ÷ÓÃÕßÊÇ¸ÃÒ³ÃæµÄ×îºóÒ»¸öÓÃ»§£¬Ôò</span><span lang=EN-US>__free_pages() </span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>ÔÙµ÷ÓÃ</span><span lang=EN-US> __free_pages_ok()</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>¡£</span><span lang=EN-US>__free_pages_ok</span><span
style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>£¨£©²ÅÊÇ¶ÔÒ³Ãæ¿é½øĞĞÊÍ·ÅµÄÊµ¼Êº¯Êı£¬¸Ãº¯Êı°ÑÊÍ·ÅµÄÒ³Ãæ¿éÁ´Èë¿ÕÏĞÁ´±í£¬²¢¶Ô»ï°éÏµÍ³µÄÎ»Í¼½øĞĞ¹ÜÀí£¬±ØÒªÊ±ºÏ²¢»ï°é¿é¡£ÕâÊµ¼ÊÉÏÊÇ</span><span
lang=EN-US>expand()</span><span style='font-family:ËÎÌå;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>º¯ÊıµÄ·´²Ù×÷£¬ÎÒÃÇ¶Ô´Ë²»ÔÙ½øĞĞÏêÏ¸µÄÌÖÂÛ¡£</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

</div>

</body>


<!-- Mirrored from www.kerneltravel.net/kernel-book/ç¬¬å…­ç« %20Linuxå†…å­˜ç®¡ç†/6.3.2.htm by HTTrack Website Copier/3.x [XR&CO'2008], Sat, 29 Dec 2012 03:00:39 GMT -->
</html>
