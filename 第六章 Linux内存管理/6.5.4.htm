<html xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:st1="urn:schemas-microsoft-com:office:smarttags"
xmlns="http://www.w3.org/TR/REC-html40">


<!-- Mirrored from www.kerneltravel.net/kernel-book/ç¬¬å…­ç« %20Linuxå†…å­˜ç®¡ç†/6.5.4.htm by HTTrack Website Copier/3.x [XR&CO'2008], Sat, 29 Dec 2012 03:00:47 GMT -->
<head>
<meta http-equiv=Content-Type content="text/html; charset=gb2312">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 11">
<meta name=Originator content="Microsoft Word 11">
<link rel=File-List href="6.5.4.files/filelist.html">
<title> ÇëÇóµ÷Ò³</title>
<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="chsdate" downloadurl=""/>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>CLJ</o:Author>
  <o:Template>Normal</o:Template>
  <o:LastAuthor>CLJ</o:LastAuthor>
  <o:Revision>2</o:Revision>
  <o:TotalTime>0</o:TotalTime>
  <o:Created>2007-08-15T08:10:00Z</o:Created>
  <o:LastSaved>2007-08-15T08:10:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>375</o:Words>
  <o:Characters>2138</o:Characters>
  <o:Lines>17</o:Lines>
  <o:Paragraphs>5</o:Paragraphs>
  <o:CharactersWithSpaces>2508</o:CharactersWithSpaces>
  <o:Version>11.5606</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:GrammarState>Clean</w:GrammarState>
  <w:PunctuationKerning/>
  <w:DrawingGridVerticalSpacing>7.8 °õ</w:DrawingGridVerticalSpacing>
  <w:DisplayHorizontalDrawingGridEvery>0</w:DisplayHorizontalDrawingGridEvery>
  <w:DisplayVerticalDrawingGridEvery>2</w:DisplayVerticalDrawingGridEvery>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:Compatibility>
   <w:SpaceForUL/>
   <w:BalanceSingleByteDoubleByteWidth/>
   <w:DoNotLeaveBackslashAlone/>
   <w:ULTrailSpace/>
   <w:DoNotExpandShiftReturn/>
   <w:AdjustLineHeightInTable/>
   <w:BreakWrappedTables/>
   <w:SnapToGridInCell/>
   <w:WrapTextWithPunct/>
   <w:UseAsianBreakRules/>
   <w:DontGrowAutofit/>
   <w:UseFELayout/>
  </w:Compatibility>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" LatentStyleCount="156">
 </w:LatentStyles>
</xml><![endif]--><!--[if !mso]><object
 classid="clsid:38481807-CA0E-42D2-BF39-B33AF135CC4D" id=ieooui></object>
<style>
st1\:*{behavior:url(#ieooui) }
</style>
<![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:ËÎÌå;
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-alt:SimSun;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 135135232 16 0 262145 0;}
@font-face
	{font-family:"\@ËÎÌå";
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 135135232 16 0 262145 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	mso-pagination:none;
	font-size:10.5pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:ËÎÌå;
	mso-font-kerning:1.0pt;}
span.GramE
	{mso-style-name:"";
	mso-gram-e:yes;}
 /* Page Definitions */
 @page
	{mso-page-border-surround-header:no;
	mso-page-border-surround-footer:no;}
@page Section1
	{size:595.3pt 841.9pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;
	mso-header-margin:42.55pt;
	mso-footer-margin:49.6pt;
	mso-paper-source:0;
	layout-grid:15.6pt;}
div.Section1
	{page:Section1;}
 /* List Definitions */
 @list l0
	{mso-list-id:335617285;
	mso-list-type:simple;
	mso-list-template-ids:1937021516;}
@list l0:level1
	{mso-level-number-format:bullet;
	mso-level-text:¡¤;
	mso-level-tab-stop:21.25pt;
	mso-level-number-position:left;
	margin-left:21.25pt;
	text-indent:-21.25pt;
	font-family:ËÎÌå;
	mso-hansi-font-family:Wingdings;}
@list l1
	{mso-list-id:995501013;
	mso-list-type:simple;
	mso-list-template-ids:1937021516;}
@list l1:level1
	{mso-level-number-format:bullet;
	mso-level-text:¡¤;
	mso-level-tab-stop:21.25pt;
	mso-level-number-position:left;
	margin-left:21.25pt;
	text-indent:-21.25pt;
	font-family:ËÎÌå;
	mso-hansi-font-family:Wingdings;}
@list l2
	{mso-list-id:1339651800;
	mso-list-type:simple;
	mso-list-template-ids:1937021516;}
@list l2:level1
	{mso-level-number-format:bullet;
	mso-level-text:¡¤;
	mso-level-tab-stop:21.25pt;
	mso-level-number-position:left;
	margin-left:21.25pt;
	text-indent:-21.25pt;
	font-family:ËÎÌå;
	mso-hansi-font-family:Wingdings;}
ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:ÆÕÍ¨±í¸ñ;
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
	mso-para-margin:0cm;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-ansi-language:#0400;
	mso-fareast-language:#0400;
	mso-bidi-language:#0400;}
</style>
<![endif]-->
</head>

<body lang=ZH-CN style='tab-interval:21.0pt;text-justify-trim:punctuation'>

<div class=Section1 style='layout-grid:15.6pt'>

<p class=MsoNormal style='mso-outline-level:1;mso-layout-grid-align:none;
text-autospace:none'><st1:chsdate Year="1899" Month="12" Day="30"
IsLunarDate="False" IsROCDate="False" w:st="on"><b style='mso-bidi-font-weight:
 normal'><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
 font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black'>6.5.4</span></b></st1:chsdate><b
style='mso-bidi-font-weight:normal'><span lang=EN-US style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black'> </span></b><b style='mso-bidi-font-weight:normal'><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black'>ÇëÇóµ÷Ò³</span></b><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
color:black'><o:p></o:p></span></b></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black'>ÊõÓïÇëÇóµ÷Ò³Ö¸µÄÊÇÒ»ÖÖ¶¯Ì¬ÄÚ´æ·ÖÅä¼¼Êõ£¬Ëü°ÑÒ³ÃæµÄ·ÖÅäÍÆ³Ùµ½²»ÄÜÔÙÍÆ³ÙÎªÖ¹£¬Ò²¾ÍÊÇËµ£¬Ò»Ö±ÍÆ³Ù<span class=GramE>µ½½ø³Ì</span>Òª·ÃÎÊµÄÒ³²»ÔÚÎïÀíÄÚ´æÊ±ÎªÖ¹£¬ÓÉ´ËÒıÆğÒ»¸öÈ±Ò³´íÎó¡£</span><span
lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-layout-grid-align:none;
text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black'><span style='mso-spacerun:yes'>&nbsp; </span></span><span
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black'>ÇëÇóµ÷Ò³¼¼ÊõµÄÒıÈëÖ÷ÒªÊÇÒòÎª½ø³Ì¿ªÊ¼ÔËĞĞµÄÊ±ºò²¢²»·ÃÎÊÆäµØÖ·¿Õ¼äÖĞµÄÈ«²¿µØÖ·£»ÊÂÊµÉÏ£¬ÓĞÒ»²¿·ÖµØÖ·Ò²Ğí½ø³ÌÓÀÔ¶²»Ê¹ÓÃ¡£´ËÍâ£¬³ÌĞòµÄ¾Ö²¿ĞÔÔ­Àí±£Ö¤ÁËÔÚ³ÌĞòÖ´ĞĞµÄÃ¿¸ö½×¶Î£¬ÕæÕıÊ¹ÓÃµÄ½ø³ÌÒ³Ö»ÓĞ<span
class=GramE>Ò»</span>Ğ¡²¿·Ö£¬Òò´ËÁÙÊ±ÓÃ²»×ÅµÄ<span class=GramE>Ò³ËùÔÚ</span>µÄÎïÀíÒ³Ãæ¿ÉÒÔÓÉÆäËü½ø³ÌÀ´Ê¹ÓÃ¡£Òò´Ë£¬¶ÔÓÚÈ«¾Ö·ÖÅä£¨Ò»¿ªÊ¼¾Í¸ø½ø³Ì·ÖÅäËùĞèÒªµÄÈ«²¿Ò³Ãæ£¬Ö±µ½³ÌĞò½áÊø²ÅÊÍ·ÅÕâĞ©Ò³Ãæ£©À´Ëµ£¬ÇëÇóµ÷Ò³ÊÇÊ×Ñ¡µÄ£¬ÒòÎªËüÔö¼ÓÁËÏµÍ³ÖĞµÄ¿ÕÏĞÒ³ÃæµÄÆ½¾ùÊı£¬´Ó¶ø¸üºÃµØÀûÓÃ¿ÕÏĞÄÚ´æ¡£´ÓÁíÒ»¸ö¹ÛµãÀ´¿´£¬ÔÚÄÚ´æ×ÜÊı±£³Ö²»±äµÄÇé¿öÏÂ£¬ÇëÇóµ÷Ò³´Ó×ÜÌåÉÏÄÜÊ¹ÏµÍ³ÓĞ¸ü´óµÄÍÌÍÂÁ¿¡£</span><span
lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black'>ÎªÕâÒ»ÇĞÓÅµã¸¶³öµÄ´ú¼ÛÊÇÏµÍ³¶îÍâµÄ¿ªÏú£ºÓÉÇëÇóµ÷Ò³ËùÒı·¢µÄÃ¿¸ö¡°È±Ò³¡±´íÎó±ØĞëÓÉÄÚºË´¦Àí£¬Õâ½«ÀË·Ñ<span lang=EN-US>CPU</span>µÄÖÜÆÚ¡£ĞÒÔËµÄÊÇ£¬¾Ö²¿ĞÔÔ­Àí±£Ö¤ÁËÒ»µ©½ø³Ì¿ªÊ¼ÔÚÒ»×éÒ³ÉÏÔËĞĞ£¬ÔÚ½ÓÏÂÀ´Ïàµ±³¤µÄÒ»¶ÎÊ±¼äÄÚËü»áÒ»Ö±Í£ÁôÔÚÕâĞ©Ò³ÉÏ¶ø²»È¥·ÃÎÊÆäËüµÄÒ³£ºÕâÑùÎÒÃÇ¾Í¿ÉÒÔÈÏÎª¡°È±Ò³¡±´íÎóÊÇÒ»ÖÖÏ¡ÓĞÊÂ¼ş¡£</span><span
lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black'>»ùÓÚÒÔÏÂÔ­Òò£¬±»Ñ°Ö·µÄ<span class=GramE>Ò³¿ÉÒÔ</span>²»ÔÚÖ÷´æÖĞ£º</span><span
lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:-21.25pt;mso-list:
l1 level1 lfo2;tab-stops:list 21.25pt;mso-layout-grid-align:none;text-autospace:
none'><![if !supportLists]><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
Wingdings;mso-bidi-font-family:ËÎÌå;color:black'><span style='mso-list:Ignore'>¡¤<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><![endif]><span
style='font-family:ËÎÌå;mso-hansi-font-family:Wingdings;color:black'>½ø³ÌÓÀÔ¶Ò²Ã»ÓĞ·ÃÎÊµ½Õâ¸öÒ³¡£ÄÚºËÄÜ¹»Ê¶±ğÕâÖÖÇé¿ö£¬ÕâÊÇÒòÎªÒ³±íÏàÓ¦µÄ±íÏî±»Ìî³äÎª<span
lang=EN-US>0</span>£¬Ò²¾ÍÊÇËµ£¬<span lang=EN-US>pte_none</span>ºê·µ»Ø<span lang=EN-US>1</span>¡£</span><span
lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:-21.25pt;mso-list:
l2 level1 lfo3;tab-stops:list 21.25pt;mso-layout-grid-align:none;text-autospace:
none'><![if !supportLists]><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
Wingdings;mso-bidi-font-family:ËÎÌå;color:black'><span style='mso-list:Ignore'>¡¤<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><![endif]><span
style='font-family:ËÎÌå;mso-hansi-font-family:Wingdings;color:black'>½ø³ÌÒÑ¾­·ÃÎÊ¹ıÕâ¸öÒ³£¬µ«ÊÇÕâ¸öÒ³µÄÄÚÈİ±»ÁÙÊ±±£´æÔÚ´ÅÅÌÉÏ¡£ÄÚºËÄÜ¹»Ê¶±ğÕâÖÖÇé¿ö£¬ÕâÊÇÒòÎªÒ³±íÏàÓ¦±íÏîÃ»±»Ìî³äÎª<span
lang=EN-US>0</span>£¨È»¶ø£¬ÓÉÓÚÒ³Ãæ²»´æÔÚÎïÀíÄÚ´æÖĞ£¬<span lang=EN-US>Present</span>Îª<span
lang=EN-US>0</span>£©¡£</span><span lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='tab-stops:21.0pt;mso-layout-grid-align:none;
text-autospace:none'><span lang=EN-US style='color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-layout-grid-align:none;
text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black'>handle_pte_fault(<span
style='mso-spacerun:yes'>&nbsp; </span>)</span><span style='font-family:ËÎÌå;
mso-hansi-font-family:"Times New Roman";color:black'>º¯ÊıÍ¨¹ı¼ì²éÓë<span lang=EN-US>address</span>Ïà¹ØµÄÒ³±í<span
class=GramE>±í</span>ÏîÀ´Çø·ÖÕâÁ½ÖÖÇé¿ö£º</span><span lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
class=GramE><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black'>entry</span></span><span lang=EN-US style='font-family:ËÎÌå;
mso-hansi-font-family:"Times New Roman";color:black'> = *pte; <o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
class=GramE><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black'>if</span></span><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black'> (!pte_present(entry)) { <o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black'><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span
class=GramE>if</span> (pte_none(entry)) <o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>return</span> do_no_page(tsk, vma, address, write_access, <o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class=GramE>pte</span>); <o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black'><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span
class=GramE>return</span> do_swap_page(tsk, vma, address, pte, entry, <o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>write_access);
<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black'>} <o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-layout-grid-align:none;
text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black'>ÎÒÃÇ½«ÔÚ½»»»»úÖÆÒ»½Ú¼ì²éÒ³±»±£´æµ½´ÅÅÌÉÏµÄÕâÖÖÇé¿ö<span lang=EN-US>(do_swap_page(<span
style='mso-spacerun:yes'>&nbsp; </span>) </span>º¯Êı<span lang=EN-US>)</span>¡£</span><span
lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-layout-grid-align:none;
text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black'><span style='mso-spacerun:yes'>&nbsp;</span></span><span
style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";color:black'>ÔÚÆäËüÇé¿öÏÂ£¬<span
class=GramE>µ±Ò³´ÓÎ´</span>±»·ÃÎÊÊ±Ôòµ÷ÓÃ<span lang=EN-US>do_no_page(<span
style='mso-spacerun:yes'>&nbsp; </span>)</span>º¯Êı¡£ÓĞÁ½ÖÖ·½·¨×°ÈëËùÈ±µÄÒ³£¬ÕâÈ¡¾öÓÚÕâ¸ö<span
class=GramE>Ò³ÊÇ·ñ</span>±»Ó³Éäµ½´ÅÅÌÎÄ¼ş¡£¸Ãº¯ÊıÍ¨¹ı¼ì²é<span lang=EN-US>vma</span>ĞéÄâÇøÃèÊö·ûµÄ<span
lang=EN-US>nopage</span><span class=GramE>ÓòÀ´È·¶¨</span>ÕâÒ»µã£¬Èç¹ûÒ³ÓëÎÄ¼ş½¨Á¢ÆğÁËÓ³Éä¹ØÏµ£¬Ôò<span
lang=EN-US>nopage</span>Óò¾ÍÖ¸ÏòÒ»¸ö°ÑËùÈ±<span class=GramE>µÄÒ³´Ó´ÅÅÌ</span>×°Èëµ½<span
lang=EN-US>RAM</span>µÄº¯Êı¡£Òò´Ë£¬¿ÉÄÜµÄÇé¿öÊÇ£º</span><span lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:-21.25pt;mso-list:
l0 level1 lfo1;tab-stops:list 21.25pt;mso-layout-grid-align:none;text-autospace:
none'><![if !supportLists]><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
Wingdings;mso-bidi-font-family:ËÎÌå;color:black'><span style='mso-list:Ignore'>¡¤<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><![endif]><span
lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:Wingdings;color:black'>vma-&gt;vm_ops-&gt;nopage</span><span
class=GramE><span style='font-family:ËÎÌå;mso-hansi-font-family:Wingdings;
color:black'>Óò²»Îª</span></span><span lang=EN-US style='font-family:ËÎÌå;
mso-hansi-font-family:Wingdings;color:black'>NULL</span><span style='font-family:
ËÎÌå;mso-hansi-font-family:Wingdings;color:black'>¡£ÔÚÕâÖÖÇé¿öÏÂ£¬Ä³¸öĞéÄâÇøÓ³ÉäÒ»¸ö´ÅÅÌÎÄ¼ş£¬</span><span
lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black'>nopage</span><span style='font-family:ËÎÌå;mso-hansi-font-family:
Wingdings;color:black'>ÓòÖ¸Ïò´Ó´ÅÅÌ¶ÁÈëµÄº¯Êı¡£ÕâÖÖÇé¿öÉæ¼°µ½´ÅÅÌÎÄ¼şµÄµÍ²ã²Ù×÷¡£</span><span lang=EN-US
style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.25pt;text-indent:-21.25pt;mso-list:
l0 level1 lfo1;tab-stops:list 21.25pt;mso-layout-grid-align:none;text-autospace:
none'><![if !supportLists]><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
Wingdings;mso-bidi-font-family:ËÎÌå;color:black'><span style='mso-list:Ignore'>¡¤<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><![endif]><span
style='font-family:ËÎÌå;mso-hansi-font-family:Wingdings;color:black'>»òÕß<span
lang=EN-US>vm_ops</span>ÓòÎª<span lang=EN-US>NULL</span>£¬»òÕß<span lang=EN-US>vma-&gt;vm_ops-&gt;nopage</span>ÓòÎª<span
lang=EN-US>NULL</span>¡£ÔÚÕâÖÖÇé¿öÏÂ£¬ĞéÄâÇøÃ»ÓĞÓ³Éä´ÅÅÌÎÄ¼ş£¬Ò²¾ÍÊÇËµ£¬ËüÊÇÒ»¸öÄäÃûÓ³Éä¡£Òò´Ë£¬<span lang=EN-US>do_no_page(<span
style='mso-spacerun:yes'>&nbsp; </span>)</span>µ÷ÓÃ<span lang=EN-US>do_anonymous_page(<span
style='mso-spacerun:yes'>&nbsp; </span>)</span>º¯Êı»ñµÃÒ»¸öĞÂµÄÒ³Ãæ£º</span><span
lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black'><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span
class=GramE>if</span> (!vma-&gt;vm_ops || !vma-&gt;vm_ops-&gt;nopage) <o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black'><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span
class=GramE>return</span> do_anonymous_page(tsk, vma, page_table, <o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:152.25pt;mso-layout-grid-align:none;
text-autospace:none'><span lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black'>write_access); <o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black'><span style='mso-spacerun:yes'>&nbsp; </span>do_anonymous_page(<span
style='mso-spacerun:yes'>&nbsp; </span>)</span><span style='font-family:ËÎÌå;
mso-hansi-font-family:"Times New Roman";color:black'>º¯Êı·Ö±ğ´¦ÀíĞ´ÇëÇóºÍ¶ÁÇëÇó£º<span
lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black'><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span
class=GramE>if</span> (write_access) { <o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black'><span style='mso-spacerun:yes'>&nbsp; </span><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;</span><span
style='mso-spacerun:yes'>&nbsp;&nbsp;</span><span class=GramE>page</span> =
__get_free_page(GFP_USER); <o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black'><span style='mso-spacerun:yes'>&nbsp;&nbsp; </span><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;</span><span
style='mso-spacerun:yes'>&nbsp;</span><span class=GramE>memset(</span>(void
*)(page), 0, PAGE_SIZE) <o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black'><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;</span><span class=GramE>entry</span>
= pte_mkwrite(pte_mkdirty(mk_pte(page, <o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=PT-BR style='font-family:ËÎÌå;mso-hansi-font-family:
"Times New Roman";color:black;mso-ansi-language:PT-BR'>vma-&gt;vm_page_prot)));
<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
lang=PT-BR style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black;mso-ansi-language:PT-BR'><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;</span>vma-&gt;vm_mm-&gt;rss++;
<o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
lang=PT-BR style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black;mso-ansi-language:PT-BR'><span
style='mso-spacerun:yes'>&nbsp;&nbsp; </span><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;</span><span
style='mso-spacerun:yes'>&nbsp;</span></span><span class=GramE><span
lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black'>tsk</span></span><span lang=EN-US style='font-family:ËÎÌå;
mso-hansi-font-family:"Times New Roman";color:black'>-&gt;min_flt++; <o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black'><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;</span>set_<span class=GramE>pte(</span>pte,
entry); <o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black'><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span
class=GramE>return</span> 1; <o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black'>}<span style='mso-spacerun:yes'>&nbsp; </span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black'>µ±´¦Àí<span class=GramE>Ğ´·ÃÎÊ</span>Ê±£¬¸Ãº¯Êıµ÷ÓÃ<span lang=EN-US>__get_free_page(<span
style='mso-spacerun:yes'>&nbsp; </span>)</span>·ÖÅäÒ»¸öĞÂµÄÒ³Ãæ£¬²¢ÀûÓÃ<span lang=EN-US>memset</span>ºê°ÑĞÂÒ³ÃæÌîÎª<span
lang=EN-US>0</span>¡£È»ºó¸Ãº¯ÊıÔö¼Ó<span lang=EN-US>tsk</span>µÄ<span lang=EN-US>min_flt</span>ÓòÒÔ¸ú×Ù<span
class=GramE>ÓÉ½ø³Ì</span>ÒıÆğµÄ´Î¼¶È±Ò³<span lang=EN-US>(</span>ÕâĞ©È±Ò³Ö»ĞèÒªÒ»¸öĞÂÒ³Ãæ<span
lang=EN-US>)</span>µÄÊıÄ¿£¬ÔÙÔö¼Ó½ø³ÌµÄÄÚ´æÇø½á¹¹<span lang=EN-US>vma-&gt;vm_mm</span>µÄ<span
lang=EN-US>rss</span>ÓòÒÔ<span class=GramE>¸ú×Ù·Ö</span>Åä¸ø½ø³ÌµÄÒ³ÃæÊıÄ¿¡£È»ºóÒ³±íÏàÓ¦µÄ±íÏî±»ÉèÎªÒ³ÃæµÄÎïÀíµØÖ·£¬²¢°ÑÕâ¸öÒ³Ãæ±ê¼ÇÎª¿ÉĞ´ºÍ<span
class=GramE>ÔàÁ½¸ö</span>±êÖ¾¡£<span lang=EN-US><o:p></o:p></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-layout-grid-align:none;
text-autospace:none'><span lang=EN-US style='color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black'>Ïà·´£¬µ±´¦Àí<span class=GramE>¶Á·ÃÎÊ</span>Ê±£¬Ò³µÄÄÚÈİÊÇÎŞ¹Ø½ôÒªµÄ£¬ÒòÎª½ø³ÌÕıÔÚ¶ÔËü½øĞĞµÚÒ»´ÎÑ°Ö·¡£¸ø½ø³ÌÒ»¸öÌî³äÎª<span
lang=EN-US>0</span>µÄÒ³Òª±È¸øËüÒ»¸öÓÉÆäËü½ø³ÌÌî³äÁËĞÅÏ¢µÄ<span class=GramE>¾ÉÒ³¸üÎª</span>°²È«¡£<span
lang=EN-US>Linux</span>ÔÚÇëÇóµ÷Ò³·½Ãæ×öµÃ¸üÉîÈëÒ»Ğ©¡£Ã»ÓĞ±ØÒªÁ¢¼´¸ø½ø³Ì·ÖÅäÒ»¸öÌî³äÎªÁãµÄĞÂÒ³Ãæ£¬ÓÉÓÚÎÒÃÇÒ²¿ÉÒÔ¸øËüÒ»¸öÏÖÓĞµÄ³ÆÎªÁãÒ³µÄÒ³£¬ÕâÑù¿ÉÒÔ½øÒ»²½ÍÆ³ÙÒ³ÃæµÄ·ÖÅä¡£ÁãÒ³ÔÚÄÚºË³õÊ¼»¯ÆÚ¼ä±»¾²Ì¬·ÖÅä£¬²¢´æ·ÅÔÚ<span
lang=EN-US>empty_zero_page</span>±äÁ¿ÖĞ£¨Ò»¸öÓĞ<span lang=EN-US>1024</span>¸ö³¤ÕûÊıµÄÊı×é£¬²¢ÓÃ<span
lang=EN-US>0</span>Ìî³ä£©£»Ëü´æ·ÅÔÚµÚÁù¸öÒ³ÃæÖĞ£¨´ÓÎïÀíµØÖ·<span lang=EN-US>0x00005000</span>¿ªÊ¼£©£¬²¢ÇÒ¿ÉÒÔÍ¨¹ı<span
lang=EN-US>ZERO_PAGE</span>ºêÀ´ÒıÓÃ¡£</span><span lang=EN-US style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black'>Òò´ËÒ³±í<span class=GramE>±í</span>Ïî±»ÉèÎªÁãÒ³µÄÎïÀíµØÖ·£º</span><span lang=EN-US
style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black'><span style='mso-spacerun:yes'>&nbsp;&nbsp; </span><span
class=GramE>entry</span> = pte_wrprotect(mk_pte(ZERO_PAGE,
vma-&gt;vm_page_prot)); <o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black'><span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>set_<span
class=GramE>pte(</span>pte, entry); <o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black'><span style='mso-spacerun:yes'>&nbsp;&nbsp; </span><span
class=GramE>return</span> 1; <o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
lang=EN-US style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-layout-grid-align:none;
text-autospace:none'><span style='font-family:ËÎÌå;mso-hansi-font-family:"Times New Roman";
color:black'>ÓÉÓÚÕâ¸öÒ³±»±ê¼ÇÎª²»¿ÉĞ´£¬Èç¹û½ø³ÌÊÔÍ¼Ğ´Õâ¸öÒ³£¬ÔòĞ´Ê±¸´ÖÆ»úÖÆ±»¼¤»î¡£µ±ÇÒ½öµ±ÔÚÕâ¸öÊ±ºò£¬½ø³Ì²Å»ñµÃÒ»¸öÊôÓÚ×Ô¼º<span
class=GramE>µÄÒ³²¢¶Ô</span>Ëü½øĞĞĞ´¡£ÕâÖÖ»úÖÆÔÚÏÂÒ»²¿·Ö½øĞĞÃèÊö¡£</span><span lang=EN-US
style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

</div>

</body>


<!-- Mirrored from www.kerneltravel.net/kernel-book/ç¬¬å…­ç« %20Linuxå†…å­˜ç®¡ç†/6.5.4.htm by HTTrack Website Copier/3.x [XR&CO'2008], Sat, 29 Dec 2012 03:00:48 GMT -->
</html>
